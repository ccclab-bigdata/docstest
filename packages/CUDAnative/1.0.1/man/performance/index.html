<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Performance Â· CUDAnative.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>CUDAnative.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../usage/">Usage</a></li><li><a class="toctext" href="../troubleshooting/">Troubleshooting</a></li><li class="current"><a class="toctext" href>Performance</a><ul class="internal"><li><a class="toctext" href="#Profiling-1">Profiling</a></li><li><a class="toctext" href="#Optimizing-1">Optimizing</a></li></ul></li><li><a class="toctext" href="../hacking/">Hacking</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../../lib/compilation/">Compilation &amp; Execution</a></li><li><a class="toctext" href="../../lib/reflection/">Reflection</a></li><li><span class="toctext">Device Code</span><ul><li><a class="toctext" href="../../lib/device/intrinsics/">Intrinsics</a></li><li><a class="toctext" href="../../lib/device/array/">Arrays</a></li><li><a class="toctext" href="../../lib/device/libdevice/">libdevice</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Performance</a></li></ul></nav><hr/><div id="topbar"><span>Performance</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Performance-1" href="#Performance-1">Performance</a></h1><p>GPU code written in CUDAnative.jl can be as fast or even outperform CUDA C compiled with <code>nvcc</code> (on the condition that the same hardware features are used). This section will describe how to do so, and what to be careful about.</p><h2><a class="nav-anchor" id="Profiling-1" href="#Profiling-1">Profiling</a></h2><p>When optimizing code, it is important to know what to optimize. Luckily, the CUDA toolkit ships an excellent profiler, <code>nvprof</code>, with <code>nvvp</code> as the Eclipse-based UI. The CUDAnative compiler is fully compatible with these tools, and generates the required line number information to debug performance issues. To generate line number information, invoke Julia with the command-line option <code>-g1</code> (the default option). Using <code>-g2</code> puts the PTX JIT in debug mode, which significantly lowers performance of GPU code and currently does not improve debugging.</p><p>Traces collected with these tools might be very large and sparse, because they capture the entire application including e.g. kernel compilation or initial data uploads. To avoid this, run the above profilers with the option &quot;Start profiling at application start&quot; disabled (<code>--profile-from-start off</code> with <code>nvprof</code>), make your application perform a warm-up iteration, and wrap subsequent iterations with <code>CUDAdrv.@profile</code>. This macro instructs any active profiler to start collecting information, resulting in much more focused traces.</p><p>For true source-level profiling akin to <code>Base.@profile</code>, look at <code>nvvp</code>&#39;s PC Sampling View (requires compute capability &gt;= 5.2, CUDA &gt;= 7.5). In the future, we might have a <code>CUDAnative.@profile</code> offering similar functionality, using the NVIDIA CUPTI library.</p><h2><a class="nav-anchor" id="Optimizing-1" href="#Optimizing-1">Optimizing</a></h2><p>This section is a WIP. Some things to consider:</p><ul><li><code>Float64</code> is expensive, but literal floats are <code>Float64</code>. Use <code>...f0</code> or cast.</li><li>Same for integers; although the performance hit is small, it increases register pressure.</li></ul><footer><hr/><a class="previous" href="../troubleshooting/"><span class="direction">Previous</span><span class="title">Troubleshooting</span></a><a class="next" href="../hacking/"><span class="direction">Next</span><span class="title">Hacking</span></a></footer></article></body></html>
