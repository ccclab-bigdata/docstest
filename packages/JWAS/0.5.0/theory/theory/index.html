<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Some Theory Â· JWAS.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../index.html"><img class="logo" src="../../assets/logo.png" alt="JWAS.jl logo"/></a><h1>JWAS.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li class="current"><a class="toctext" href>Some Theory</a><ul class="internal"><li><a class="toctext" href="#A-Table-for-Bayesian-Linear-Mixed-Models-(BLMM)-1">A Table for Bayesian Linear Mixed Models (BLMM)</a></li><li><a class="toctext" href="#Models-1">Models</a></li></ul></li><li><a class="toctext" href="../../citing/citing/">Citing</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../../manual/getstarted/">Get Started</a></li><li><a class="toctext" href="../../manual/workflow/">Workflow</a></li><li><a class="toctext" href="../../manual/public/">Public</a></li><li><a class="toctext" href="../../manual/internals/">Internals</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../examples/examples/">Examples</a></li></ul></li><li><a class="toctext" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions/">Frequently Asked Questions</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Some Theory</a></li></ul></nav><hr/><div id="topbar"><span>Some Theory</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Some-Theory-in-JWAS-1" href="#Some-Theory-in-JWAS-1">Some Theory in JWAS</a></h1><h2><a class="nav-anchor" id="A-Table-for-Bayesian-Linear-Mixed-Models-(BLMM)-1" href="#A-Table-for-Bayesian-Linear-Mixed-Models-(BLMM)-1">A Table for Bayesian Linear Mixed Models (BLMM)</a></h2><p><img src="../../assets/BLMM.png" alt="BLMM"/></p><h2><a class="nav-anchor" id="Models-1" href="#Models-1">Models</a></h2><h3><a class="nav-anchor" id="Complete-Genomic-Data-1" href="#Complete-Genomic-Data-1">Complete Genomic Data</a></h3><p>The general form of the multivariate (univariate) mixed effects model for individual <span>$i$</span> from <span>$n$</span> individuals with complete genomic data in JWAS is</p><div>\[
\mathbf{y}_{i}
 =\sum_{j=1}^{p_{\beta}}X_{ij}\boldsymbol{\beta}_{j}+\sum_{k=1}^{p_{u}}Z_{ik}\mathbf{u}_{k}
 +\sum_{l=1}^{p}M_{il}\boldsymbol{\alpha}_{l}+\mathbf{e}_{i}(1),\]</div><p>where <span>$\mathbf{y}_{i}$</span> is a vector of phenotypes of <span>$t$</span> traits for individual <span>$i$</span>; <span>$X_{ij}$</span> is the incidence matrix covariate corresponding to the <span>$j$</span>th fixed effect for individual <span>$i$</span>; <span>$\boldsymbol{\beta}_{j}$</span> is a vector of <span>$j$</span>th fixed effects for the <span>$t$</span> traits; <span>$Z_{ik}$</span> is the incidence matrix covariate corresponding to the <span>$k$</span>th random effect for individual <span>$i$</span>; <span>$\boldsymbol{u}_{k}$</span> is a vector of the <span>$k$</span>th random effects of <span>$t$</span> traits; <span>$M_{il}$</span> is the genotype covariate at locus <span>$l$</span> for individual <span>$i$</span>, <span>$p$</span> is the number of genotyped loci (each coded as 0,1,2), <span>$\boldsymbol{\alpha}_{l}$</span> is a vector of allele substitution effects or marker effects of <span>$t$</span> traits for locus <span>$j$</span>, and <span>$\mathbf{e}_{i}$</span> is the vector of random residual effects of <span>$t$</span> traits for individual <span>$i$</span>. The JWAS implementation of this model involves missing phenotypes being imputed at each iteration of MCMC \cite{sorensenGianolaBook} so that all individuals have observations for all traits. Note that when the number of traits <span>$t=1$</span>, the general form above simplifies to the single-trait  mixed effects model, and all vectors of effects in equation (1) become scalars.</p><h3><a class="nav-anchor" id="Incomplete-Genomic-Data-1" href="#Incomplete-Genomic-Data-1">Incomplete Genomic Data</a></h3><p>The general form of the multivariate (univariate) mixed effects model with incomplete genomic data (&quot;single-step&quot; methods) for non-genotyped individuals is</p><div>\[\mathbf{y}_{i}
=\sum_{j=1}^{p_{\beta}}X_{ij}\boldsymbol{\beta}_{j}+\sum_{k=1}^{p_{u}}Z_{ik}\mathbf{u}_{k}+
\sum_{l=1}^{p}\hat{M_{il}}\boldsymbol{\alpha}_{l}+\sum_{m=1}^{p_{\epsilon}}Z_{n[i,m]}\boldsymbol{\epsilon}_{m}+\boldsymbol{e}_{i} (2),\]</div><p>where <span>$\mathbf{y}_{i}$</span> is a vector of phenotypes of <span>$t$</span> traits for non-genotyped individual <span>$i$</span>;  <span>$\hat{{M}_{il}}$</span> is the imputed genotype covariate at locus <span>$l$</span> for non-genotyped individual <span>$i$</span>, <span>$Z_{n[i,m]}$</span> is the incidence matrix covariate corresponding to the <span>$m$</span>th imputation residual for individual <span>$i$</span> and <span>$\boldsymbol{\epsilon}_i$</span> is a vector of imputation residuals. <span>$W_{im}$</span> is the incidence matrix covariate corresponding to the <span>$m$</span>th random effect for individual <span>$i$</span>. That vector of imputation residuals, <span>$\boldsymbol{\epsilon}=\begin{bmatrix}\boldsymbol{\epsilon}_{1}^{T} &amp; \boldsymbol{\epsilon}_{2}^{T} &amp; \ldots &amp; \end{bmatrix}^{T}$</span>, are a priori assumed to be <span>$N\left(0,(\mathbf{A}_{nn}-\mathbf{A}_{ng}\mathbf{A}_{gg}^{-1}\mathbf{A}_{gn})\otimes\mathbf{G}_{g}\right)$</span>, where <span>$\mathbf{A}_{nn}$</span> is the partition of the numerator relationship matrix  <span>$\mathbf{A}$</span> that corresponds to non-genotyped individuals, <span>$\mathbf{A}_{ng}$</span> or its transpose <span>$\mathbf{A}_{gn}$</span> are partitions of <span>$\mathbf{A}$</span> corresponding to relationships between non-genotyped and genotyped individuals or vice versa,  <span>$\mathbf{A}_{gg}$</span> is the  partition of <span>$\mathbf{A}$</span> that corresponds to genotyped animals, and <span>$\mathbf{G}_{g}$</span> is the additive genetic covariance matrix. All the other variables are the same as in equation (1).</p><h3><a class="nav-anchor" id="Priors-1" href="#Priors-1">Priors</a></h3><h4><a class="nav-anchor" id="Priors-for-effects-other-than-markers-1" href="#Priors-for-effects-other-than-markers-1">Priors for effects other than markers</a></h4><p>The fixed effects are assigned flat priors. The vector of random effects, <span>$\mathbf{u}=\begin{bmatrix}\mathbf{u}_{1}^{T} &amp; \mathbf{u}_{2}^{T} &amp; \ldots &amp; \mathbf{u}_{p_{2}}^{T}\end{bmatrix}^{T}$</span>, are a priori assumed to be <span>$N\left(0,\mathbf{A}\otimes\mathbf{G}\right)$</span> with various options for <span>$\mathbf{A}$</span>. For example, <span>$\mathbf{A}$</span> could be an identity matrix if <span>$\boldsymbol{u}_{k}$</span> is assumed to be independently and identically distributed. <span>$\mathbf{A}$</span> can be  the numerator relationship matrix, when <span>$\boldsymbol{u}$</span> is a vector of polygenic effects and <span>$\mathbf{G}$</span> represents the additive-genetic variance not explained by molecular markers. Note that <span>$\boldsymbol{u}$</span> can also be a concatenation of vectors of different types of random effects, such as litter, pen, polygenic and maternal effects. The vector <span>$\boldsymbol{e}_{i}$</span> of residuals are a priori assumed to be independently and identically following multivariate normal distributions with null mean and covariance matrix <span>$\mathbf{R}$</span>, which in turn is a priori assumed to have an inverse Wishart prior distribution, <span>$W_{t}^{-1}\left(\mathbf{S}_{e},\nu_{e}\right)$</span>. Note that when number of traits <span>$t=1$</span>, the priors for <span>$\mathbf{G}$</span> and <span>$\mathbf{R}$</span> in single-trait analyses follow scaled inverted chi-square distributions.</p><h4><a class="nav-anchor" id="Priors-for-marker-effects-1" href="#Priors-for-marker-effects-1">Priors for marker effects</a></h4><h5><a class="nav-anchor" id="single-trait-BayesA-1" href="#single-trait-BayesA-1">single-trait BayesA</a></h5><p>The prior assumption is that marker effects have identical and independent univariate-t distributions each with a null mean, scale parameter <span>$S^2_{\alpha}$</span> and <span>$\nu$</span> degrees of freedom. This is equivalent to assuming that the marker effect at locus <span>$i$</span> has a univariate normal with null mean and unknown, locus-specific variance <span>$\sigma^2_i$</span>, which in turn is assigned a scaled inverse chi-square prior with scale parameter <span>$S^2_{\alpha}$</span> and <span>$\nu_{\alpha}$</span> degrees of freedom.</p><h5><a class="nav-anchor" id="single-trait-BayesB-1" href="#single-trait-BayesB-1">single-trait BayesB</a></h5><p>In BayesB, the prior assumption is that marker effects have identical and independent mixture distributions, where each has a point mass at zero with probability <span>$\pi$</span> and a univariate-t distribution with probability <span>$1-\pi$</span> having a null mean, scale parameter <span>$S^2_{\alpha}$</span> and <span>$\nu$</span> degrees of freedom. Thus, BayesA is a special case of BayesB with <span>$\pi=0$</span>. Further, as in BayesA, the t-distribution in BayesB is equivalent to a univariate normal with null mean and unknown, locus-specific variance, which in turn is assigned a scaled inverse chi-square prior with scale parameter <span>$S^2_{\alpha}$</span> and <span>$\nu_{\alpha}$</span> degrees of freedom. <em>(A fast and efficient Gibbs sampler was implemented for BayesB in JWAS.)</em></p><h5><a class="nav-anchor" id="single-trait-BayesC-and-BayesC\\pi-1" href="#single-trait-BayesC-and-BayesC\\pi-1">single-trait BayesC and BayesC<span>$\pi$</span></a></h5><p>In BayesC, the prior assumption is that marker effects have identical and independent mixture distributions, where each has a point mass at zero with probability <span>$\pi$</span> and a univariate-normal distribution with probability <span>$1-\pi$</span> having a null mean and variance <span>$\sigma^2_{\alpha}$</span>, which in turn has a scaled inverse chi-square prior with scale parameter <span>$S^2_{\alpha}$</span> and <span>$\nu_{\alpha}$</span> degrees of freedom. In addition to the above assumptions, in BayesC <span>$\pi$</span>, <span>$\pi$</span> is treated as unknown with a uniform prior.</p><h5><a class="nav-anchor" id="multiple-trait-Bayesian-Alphabet-1" href="#multiple-trait-Bayesian-Alphabet-1">multiple-trait Bayesian Alphabet</a></h5><p>In multi-trait BayesC<span>$\Pi$</span>, the prior for <span>$\alpha_{lk}$</span>, the marker effect of trait <span>$k$</span> for locus <span>$l$</span>, is a mixture with a point mass at zero and a univariate normal distribution conditional on <span>$\sigma_{k}^{2}$</span>:</p><div>\[\begin{align*}
\alpha_{lk}\mid\pi_{k},\sigma_{k}^{2} &amp; \begin{cases}
\sim N\left(0,\,\sigma_{k}^{2}\right) &amp; probability\;(1-\pi_{k})\\
0 &amp; probability\;\pi_{k}
\end{cases}
\end{align*}\]</div><p>and the covariance between effects for traits <span>$k$</span> and <span>$k&#39;$</span> at the same locus, i.e., <span>$\alpha_{lk}$</span> and <span>$\alpha_{lk^{&#39;}}$</span> is</p><div>\[\begin{align*}
cov\left(\alpha_{lk},\alpha_{lk^{&#39;}}\mid\sigma_{kk^{&#39;}}\right)=\begin{cases}
\sigma_{kk^{&#39;}} &amp; \:if\:both\,\alpha_{lk}\neq0\:and\:\alpha_{lk^{&#39;}}\neq0\\
0 &amp; \:otherwise
\end{cases}.
\end{align*}\]</div><p>The vector of marker effects at a particular locus <span>$\boldsymbol{\alpha}_{l}$</span> is written as <span>$\boldsymbol{\alpha}_{l}=\boldsymbol{D}_{l}\boldsymbol{\beta}_{l}$</span>, where <span>$\boldsymbol{D}_{l}$</span> is a diagonal matrix with elements <span>$diag\left(\boldsymbol{D}_{l}\right)=\boldsymbol{\delta}_{l}=\left(\delta_{l1},\delta_{l2},\delta_{l3}\ldots\delta_{lt}\right)$</span>, where <span>$\delta_{lk}$</span> is an indicator variable indicating whether the marker effect of locus <span>$l$</span> for trait <span>$k$</span> is zero or non-zero, and the vector <span>$\boldsymbol{\beta}_{l}$</span> follows a multivariate normal distribution with null mean and covariance matrix <span>$\boldsymbol{G}$</span>. The covariance matrix <span>$\boldsymbol{G}$</span> is <span>$a$</span> <span>$priori$</span> assumed to follow an inverse Wishart distribution, <span>$W_{t}^{-1}\left(\mathbf{S}_{\beta},\nu_{\beta}\right)$</span>.</p><p>In the most general case, any marker effect might be zero for any possible combination of <span>$t$</span> traits resulting in <span>$2^{t}$</span> possible combinations of <span>$\boldsymbol{\delta}_{l}$</span>. For example, in a <span>$t$</span>=2 trait model, there are <span>$2^{t}=4$</span> combinations for  <span>$\boldsymbol{\delta}_{l}$</span>: <span>$(0,\,0)$</span>, <span>$(0,\,1)$</span>, <span>$(1,\,0)$</span>, <span>$(1,\,1)$</span>. Suppose in general we use numerical labels &quot;1&quot;, &quot;2&quot;,<span>$\ldots$</span>, &quot;<span>$l$</span>&quot; for the <span>$2^{t}$</span> possible outcomes for  <span>$\boldsymbol{\delta}_{l}$</span>, then the prior for  <span>$\boldsymbol{\delta}_{l}$</span> is a categorical distribution</p><div>\[\begin{align*}
 &amp; p\left(\boldsymbol{\delta}_{l}=``i&quot;\right)\\
= &amp; \Pi_{1}I\left(\boldsymbol{\delta}_{l}=``1&quot;\right)+\Pi_{2}I\left(\boldsymbol{\delta}_{l}=``2&quot;\right)+...+\Pi_{l}I\left(\boldsymbol{\delta}_{l}=``l&quot;\right),
\end{align*}\]</div><p>where <span>$\sum_{i=1}^{l}\Pi_{i}=1$</span> with <span>$\Pi_{i}$</span> being the prior probability that the vector <span>$\boldsymbol{\delta}_{l}$</span> corresponds to the vector labelled <span>$&quot;i&quot;$</span>. A Dirichlet distribution with all parameters equal to one, i.e., a uniform distribution, can be used for the prior for <span>$\boldsymbol{\Pi}=\left(\Pi_{1},\Pi_{2},...,\Pi_{l}\right)$</span>.   </p><p>The differences in multi-trait BayesB method is that the prior for <span>$\boldsymbol{\beta}_{l}$</span> is a multivariate t distribution, rather than a multivariate normal distribution. This is equivalent to assuming <span>$\boldsymbol{\beta}_{l}$</span> has a multivariate normal distribution with null mean and locus-specific covariance matrix <span>$\boldsymbol{G}_{l}$</span>, which is assigned an inverse Wishart prior, <span>$W_{t}^{-1}\left(\mathbf{S}_{\beta},\nu_{\beta}\right)$</span>. Multi-trait BayesA method is a special case of multi-trait BayesB method where <span>$\boldsymbol{\delta}_{l}$</span> is always a vector of ones.</p><blockquote><h4>references</h4><ul><li>Meuwissen T, Hayes B, Goddard M. Prediction of total genetic value using genome-wide dense marker maps. Genetics, 157:1819â1829, 2001.</li><li>Fernando R, Garrick D. Bayesian methods applied to GWAS. Methods Mol Biol. 2013;1019:237â274.</li><li>Cheng H, Garrick D, Fernando R. A fast and efficient Gibbs sampler for BayesB in whole- genome analyses. Genet Sel Evol, 2015, 47:80.</li><li>Fernando R, Dekkers J,Garrick D. A class of Bayesian methods to combine large numbers of genotyped and non-genotyped animals for whole-genome analyses. Genetics Selection Evolution, 2015 46(1), 50.</li><li>Cheng H, Kizilkaya K, Zeng J, Garrick D, Fernando R. Genomic Prediction from Multiple-trait Bayesian Regression Methods using Mixture Priors. Genetics. 2018</li></ul></blockquote><footer><hr/><a class="previous" href="../../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../../citing/citing/"><span class="direction">Next</span><span class="title">Citing</span></a></footer></article></body></html>
