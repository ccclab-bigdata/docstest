<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Readme Â· ChunkedArrays.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ChunkedArrays.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Readme</a><ul class="internal"><li class="toplevel"><a class="toctext" href="#Installation-1">Installation</a></li><li class="toplevel"><a class="toctext" href="#Using-the-Package-1">Using the Package</a></li><li class="toplevel"><a class="toctext" href="#Examples-1">Examples</a></li><li class="toplevel"><a class="toctext" href="#Benchmarks-1">Benchmarks</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Readme</a></li></ul></nav><hr/><div id="topbar"><span>Readme</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ChunkedArrays.jl-1" href="#ChunkedArrays.jl-1">ChunkedArrays.jl</a></h1><p><a href="https://travis-ci.org/ChrisRackauckas/ChunkedArrays.jl"><img src="https://travis-ci.org/ChrisRackauckas/ChunkedArrays.jl.svg?branch=master" alt="Build Status"/></a> <a href="https://ci.appveyor.com/project/ChrisRackauckas/chunkedarrays-jl"><img src="https://ci.appveyor.com/api/projects/status/2fm6c86aelajy7gc?svg=true" alt="Build status"/></a></p><p>ChunkedArrays.jl is a package for increasing the performance of arrays generated inside of loops. Some basic benchmarks show chunked arrays being almost 50% faster than naive approaches. One use case for this is using random numbers in a loop. It&#39;s well known that for many reasons (including SIMD) that generating 1000 random number generators at once using <code>rand(1000)</code> is faster than generating 1000 random numbers in separate calls of <code>rand()</code>. ChunkedArrays allows you to generate your arrays in larger amounts, but provides a convenient wrapper to hide the details. Also included is the ability to generate the next buffer in parallel, which allows you to utilize your array chunk and have it replaced with a new chunk generated by a different process, maximizing efficiency.</p><h1><a class="nav-anchor" id="Installation-1" href="#Installation-1">Installation</a></h1><p>To install the package, simply use</p><pre><code class="language-julia">Pkg.add(&quot;ChunkedArrays&quot;)
using ChunkedArrays</code></pre><p>Note that version v0.0.2 is the last version which targets Julia v0.4. The current master has some changes which only work on v0.5. For an up-to-date version with v0.4 compatibility, check out the v0.4-compat branch.</p><h1><a class="nav-anchor" id="Using-the-Package-1" href="#Using-the-Package-1">Using the Package</a></h1><p>You can define a ChunkedArray in one of the three forms:</p><pre><code class="language-julia">ChunkedArray(chunkfunc::Function,bufferSize::Int=BUFFER_SIZE_DEFAULT,T::Type=Float64;parallel=PARALLEL_DEFAULT)
ChunkedArray(chunkfunc::Function,outputSize::NTuple,bufferSize::Int=BUFFER_SIZE_DEFAULT,T::Type=Float64;parallel=PARALLEL_DEFAULT)
ChunkedArray(chunkfunc,randPrototype::AbstractArray,bufferSize=BUFFER_SIZE_DEFAULT;parallel=PARALLEL_DEFAULT)</code></pre><p>Then, to generate the next value in the array, you use the <code>next</code> function like:</p><pre><code class="language-julia">next(chunked)</code></pre><h1><a class="nav-anchor" id="Examples-1" href="#Examples-1">Examples</a></h1><p>Let&#39;s say for example we wished to generate a bunch of standard normal random numbers in a loop. The naive way to do this is via</p><pre><code class="language-julia">j=0.0
for i = 1:loopSize
  j += randn()
end</code></pre><p>To use a ChunkedArray which outputs standard normal random numbers, we would use the definition the following:</p><pre><code class="language-julia">chunkRand = ChunkedArray(randn)
j=0.0
for i = 1:loopSize
  j += next(chunkRand)
end</code></pre><p>This uses the constructor <code>ChunkedArray(chunkfunc::Function,bufferSize::Int=BUFFER_SIZE_DEFAULT,T::Type=Float64,parallel=PARALLEL_DEFAULT)</code> which has a buffer size of 1000 and does not use parallel generation. Note that you do not need to be running multiple processes for parallel generation to work. If we instead wished to generate <code>randn(4,2)</code> each time in the loop, we can specify the dimensions:</p><pre><code class="language-julia">chunkRand = ChunkedArray(randn,(4,2))
j=[0 0
   0 0
   0 0
   0 0]
for i = 1:loopSize
  j += next(chunkRand)
end</code></pre><p>or simply give it a prototype:</p><pre><code class="language-julia">j=[0 0
   0 0
   0 0
   0 0]
chunkRand = ChunkedArray(randn,j)
for i = 1:loopSize
  j += next(chunkRand)
end</code></pre><p>and it will generate standard normals of <code>similar(j)</code>.</p><h1><a class="nav-anchor" id="Benchmarks-1" href="#Benchmarks-1">Benchmarks</a></h1><p>These benchmarks can be found in the test folder. For small runs (which are required for CI) there is little difference, but as the loop size increases the difference grows.</p><pre><code class="language-julia">const loopSize = 1000000
const buffSize = 10000
const numRuns = 400
Test Results For Average Time:
One-by-one:                             0.148530531075
Thousand-by-Thousand:                   0.189417186075
Altogether:                             0.2057703961
Hundred-by-hundred:                     0.191497048
Take at Beginning:                      0.20445405967500002
Pre-made Rands:                         0.16260088565
Chunked Rands Premade:                  0.1032136674
Chunked Rands 10000 buffer:             0.10846818174999999
Chunked Rands Direct:                   0.134752111825
Chunked Rands Max buffer:               0.120411857925
Parallel Chunked Rands 10000 buffer:    0.1276476319</code></pre><footer><hr/></footer></article></body></html>
