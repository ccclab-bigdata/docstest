<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tricksy Gotchas Â· BinaryBuilder.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>BinaryBuilder.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../build_tips/">Building Packages</a></li><li><a class="toctext" href="../FAQ/">FAQ</a></li><li><span class="toctext">Internals</span><ul><li><a class="toctext" href="../rootfs/">RootFS</a></li><li><a class="toctext" href="../environment_variables/">Environment Variables</a></li><li class="current"><a class="toctext" href>Tricksy Gotchas</a><ul class="internal"></ul></li><li><a class="toctext" href="../reference/">Reference</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Internals</li><li><a href>Tricksy Gotchas</a></li></ul></nav><hr/><div id="topbar"><span>Tricksy Gotchas</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Tricksy-Gotchas-1" href="#Tricksy-Gotchas-1">Tricksy Gotchas</a></h1><p>There are a plethora of gotchas when it comes to binary compilation and distribution that must be appropriately addressed, or the binaries will only work on certain machines and not others.  Here is an incomplete list of things that <code>BinaryBuilder.jl</code> takes care of for you:</p><ul><li>Uniform compiler interface</li></ul><p>No need to worry about invoking compilers through weird names; just run <code>gcc</code> within the proper environment and you&#39;ll get the appropriate cross-compiler.  Triplet-prefixed names (such as <code>x86_64-linux-gnu-gcc</code>) are, of course, also available, and the same version of <code>gcc</code>, <code>g++</code> and <code>gfortran</code> is used across all platforms.</p><ul><li><code>glibc</code> versioning</li></ul><p>On Linux platforms that use <code>glibc</code> as the C runtime library (at the time of writing, this is the great majority of most desktop and server distros), it is necessary to compile code against a version of <code>glibc</code> that is <em>older</em> than any glibc version it will be run on.  E.g. if your code is compiled against <code>glibc v2.5</code>, it will run on <code>glibc v2.6</code>, but it will not run on <code>glibc v2.4</code>.  Therefore, to maximize compability, all code should be compiled against as old a version of <code>glibc</code> as possible.</p><ul><li><code>gfortran</code> versioning</li></ul><p>When compiling FORTRAN code, the <code>gfortran</code> compiler has broken ABI compatibility in the 6.X -&gt; 7.X transition, and the 7.X -&gt; 8.X transition.  This means that code built with <code>gfortran</code> 6.X cannot be linked against code built with <code>gfortran</code> 7.X.  We therefore compile all <code>gfortran</code> code against multiple different <code>gfortran</code> versions, then at runtime decide which to download based upon the currently running process&#39; existing linkage.</p><ul><li>Library Dependencies</li></ul><p>A large source of problems in binary distribution is improper library linkage.  When building a binary object that depends upon another binary object, some operating systems (such as macOS) bake the absolute path to the dependee library into the dependent, whereas others rely on the library being present within a default search path.  BinaryBuilder.jl takes care of this by automatically discovering these errors and fixing them by using the <code>RPATH</code>/<code>RUNPATH</code> semantics of whichever platform it is targeting.  Note that this is technically a build system error, and although we will fix it automatically, it will raise a nice yellow warning during build prefix audit time.</p><ul><li>Instruction Set Differences</li></ul><p>When compiling for architectures that have evolved over time (such as <code>x86_64</code>), it is important to target the correct instruction set, otherwise a binary may contain instructions that will run on the computer it was compiled on, but will fail rather ungracefully when run on a machine that does not have as new a processor.  <code>BinaryBuilder.jl</code> will automatically disassemble every built binary object and inspect the instructions used, warning the user if a binary is found that does not conform to the agreed-upon minimum instruction set architecture.  It will also notice if the binary contains a <code>cpuid</code> instruction, which is a good sign that the binary is aware of this issue and will internally switch itself to use only available instructions.</p><footer><hr/><a class="previous" href="../environment_variables/"><span class="direction">Previous</span><span class="title">Environment Variables</span></a><a class="next" href="../reference/"><span class="direction">Next</span><span class="title">Reference</span></a></footer></article></body></html>
