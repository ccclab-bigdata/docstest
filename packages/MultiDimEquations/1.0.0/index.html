<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Readme · MultiDimEquations.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MultiDimEquations.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Readme</a><ul class="internal"><li><a class="toctext" href="#Installation-1">Installation</a></li><li><a class="toctext" href="#Making-available-the-package-1">Making available the package</a></li><li><a class="toctext" href="#Definition-of-the-variables:-1">Definition of the variables:</a></li><li class="toplevel"><a class="toctext" href="#Defining-the-&quot;set&quot;-(dimensions)-of-your-data-1">Defining the &quot;set&quot; (dimensions) of your data</a></li><li><a class="toctext" href="#Write-your-model-using-the-@meq-macro-1">Write your model using the @meq macro</a></li><li><a class="toctext" href="#Known-limitation-1">Known limitation</a></li><li><a class="toctext" href="#Acknowledgements-1">Acknowledgements</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Readme</a></li></ul></nav><hr/><div id="topbar"><span>Readme</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="MultiDimEquations-1" href="#MultiDimEquations-1">MultiDimEquations</a></h1><p>Allows to write multi-dimensional equations in Julia using an easy and compact syntax:</p><pre><code class="language-none">@meq nTrees!(r in reg, sp in species, dc in diameterClass[2-end], y in years) = nTrees_(r, sp, dc, y)*(1-mortRate_(r, sp, dc, y-1) - promotionRate_(r, sp, dc, y-1))) +  promotionRate_(r, sp, dc-1, y-1)</code></pre><p>It is somehow similar to Algebraic modeling language (AML) like GAMS or Julia/JuMP, but outside the domain of optimisation.</p><p><a href="https://travis-ci.org/sylvaticus/MultiDimEquations.jl"><img src="https://travis-ci.org/sylvaticus/MultiDimEquations.jl.svg?branch=master" alt="Build Status"/></a> <a href="http://codecov.io/github/sylvaticus/MultiDimEquations.jl?branch=master"><img src="http://codecov.io/github/sylvaticus/MultiDimEquations.jl/coverage.svg?branch=master" alt="codecov.io"/></a></p><p><a href="http://pkg.julialang.org/?pkg=MultiDimEquations&amp;ver=0.6"><img src="http://pkg.julialang.org/badges/MultiDimEquations_0.6.svg" alt="MultiDimEquations"/></a> <a href="http://pkg.julialang.org/?pkg=MultiDimEquations&amp;ver=0.6"><img src="http://pkg.julialang.org/badges/MultiDimEquations_0.6.svg" alt="MultiDimEquations"/></a></p><h2><a class="nav-anchor" id="Installation-1" href="#Installation-1">Installation</a></h2><ul><li><code>Pkg.add(&quot;MultiDimEquations&quot;)</code></li></ul><h2><a class="nav-anchor" id="Making-available-the-package-1" href="#Making-available-the-package-1">Making available the package</a></h2><p>Due to the fact that the functions to access the data are dynamically created at run time, and would not be available to you with a normal <code>import &lt;package&gt;</code>, you have instead to include the file in your program:</p><pre><code class="language-none">include(&quot;$(Pkg.dir())/MultiDimEquations/src/MultiDimEquations.jl&quot;)</code></pre><h2><a class="nav-anchor" id="Definition-of-the-variables:-1" href="#Definition-of-the-variables:-1">Definition of the variables:</a></h2><p>Define each group of variables with their associated data source. At the moment MultiDimEquations support only DataFrame in long format, i.e. in the format parameter|dim1|dim2|...|value</p><pre><code class="language-none">df = wsv&quot;&quot;&quot;
reg	prod	var	value
us	banana	production	10
us	banana	transfCoef	0.6
us	banana	trValues	2
us	apples	production	7
us	apples	transfCoef	0.7
us	apples	trValues	5
us	juice	production	NA
us	juice	transfCoef	NA
us	juice	trValues	NA
eu	banana	production	5
eu	banana	transfCoef	0.7
eu	banana	trValues	1
eu	apples	production	8
eu	apples	transfCoef	0.8
eu	apples	trValues	4
eu	juice	production	NA
eu	juice	transfCoef	NA
eu	juice	trValues    NA
&quot;&quot;&quot;

variables =  vcat(unique(dropna(df[:var])),[&quot;consumption&quot;])
defVars(variables,df;dfName=&quot;df&quot;,varNameCol=&quot;var&quot;, valueCol=&quot;value&quot;)</code></pre><p>Each time you run <code>defVars()</code>, access functions are automatically created for each variable in the form of <code>variable_(dim1,dim2,...)</code> to access the data and <code>variable!(value,dim1,dim2,..)</code> to store the value. For more info type <code>?defVars</code> once you installed and loaded the package.</p><h1><a class="nav-anchor" id="Defining-the-&quot;set&quot;-(dimensions)-of-your-data-1" href="#Defining-the-&quot;set&quot;-(dimensions)-of-your-data-1">Defining the &quot;set&quot; (dimensions) of your data</a></h1><p>These are simple Julia Arrays..</p><pre><code class="language-none">products = [&quot;banana&quot;,&quot;apples&quot;,&quot;juice&quot;]
primPr   = products[1:2]
secPr    = [products[3]]
reg      = [&quot;us&quot;,&quot;eu&quot;]</code></pre><h2><a class="nav-anchor" id="Write-your-model-using-the-@meq-macro-1" href="#Write-your-model-using-the-@meq-macro-1">Write your model using the @meq macro</a></h2><p>The @meq macro adds a bit of convenience transforming at parse time (so, without adding run-time overheads) your equation from <code>par1!(d1 in DIM1, d2 in DIM2, dfix3) = par2_(d1,d2)+par3_(d1,d2)</code> to <code>[par1!(par2_(d1,d2)+par3_(d1,d2), d1,d2,dfix3) for d1 in dim1, d2 in dim2]</code>.</p><pre><code class="language-none"># equivalent to [production!(sum(trValues_(r,pp) * transfCoef_(r,pp)  for pp in primPr), r, sp) for r in reg, sp in secPr]
@meq production!(r in reg, sp in secPr)   = sum(trValues_(r,pp) * transfCoef_(r,pp)  for pp in primPr)
@meq consumption!(r in reg, pp in primPr) = production_(r,pp) - trValues_(r,pp)
@meq consumption!(r in reg, sp in secPr)  = production_(r, sp)</code></pre><p>Using <code>defVars()</code> with the <code>@meq</code> macro your data is kept in a single <code>IndexedTable</code> where one column is used to keep the variable names. An alternative (and faster) approach is to define your variables as each one being a separate <code>IndexedTable</code> (the package <a href="https://github.com/sylvaticus/LAJuliaUtils.jl">LAJuliaUtils</a> has some useful functions for such approach). You can still use @meq to provide some convenience:</p><p>@meq <code>par1[d1 in DIM1, d2 in DIM2, dfix3] = par2[d1,d2]+par3[d1,d2]</code> ==&gt; <code>[par1[d1,d2,dfix3] = par2[d1,d2]+par3[d1,d2] for d1 in dim1, d2 in dim2]</code>.</p><p>For more info on the @meq macro type <code>?@meq</code></p><h2><a class="nav-anchor" id="Known-limitation-1" href="#Known-limitation-1">Known limitation</a></h2><ul><li>This is a young package still under active development.</li><li>While convenient, named access is definitely slower than positional access to data (i.e. it is a functional rather than performance oriented approach). Neverthless, using <code>IndexedTables</code> as backend, this package provides a reasonable fast implementation.</li><li>Also, at this time, only <code>var = ...</code> assignments are supported.</li></ul><h2><a class="nav-anchor" id="Acknowledgements-1" href="#Acknowledgements-1">Acknowledgements</a></h2><p>The development of this package was supported by the French National Research Agency through the <a href="http://mycor.nancy.inra.fr/ARBRE/">Laboratory of Excellence ARBRE</a>, a part of the “Investissements d&#39;Avenir” Program (ANR 11 – LABX-0002-01).</p><footer><hr/></footer></article></body></html>
