<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rounding · IntervalArithmetic</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>IntervalArithmetic</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Package</a></li><li><a class="toctext" href="../intro/">Interval Arithmetic</a></li><li><a class="toctext" href="../construction/">Constructing intervals</a></li><li><a class="toctext" href="../usage/">Basic usage</a></li><li><a class="toctext" href="../decorations/">Decorations</a></li><li><a class="toctext" href="../multidim/">Multi-dimensional boxes</a></li><li class="current"><a class="toctext" href>Rounding</a><ul class="internal"><li><a class="toctext" href="#More-detail:-the-internal-representation-1">More detail: the internal representation</a></li></ul></li><li><a class="toctext" href="../api/">API</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Rounding</a></li></ul></nav><hr/><div id="topbar"><span>Rounding</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Why-is-rounding-necessary?-1" href="#Why-is-rounding-necessary?-1">Why is rounding necessary?</a></h1><p>What happens when we write the following Julia code?</p><pre><code class="language-julia-repl">julia&gt; x = 0.1
0.1</code></pre><p>This appears to store the value <code>0.1</code> in a variable <code>x</code> of type <code>Float64</code>. In fact, however, it stores a <em>slightly different</em> number, since <code>0.1</code> <em>cannot be represented exactly in binary floating point arithmetic, at any precision</em>.</p><p>The true value that is actually stored in the variable can be conveniently determined in Julia using arbitrary-precision arithmetic with <code>BigFloat</code>s:</p><pre><code class="language-julia-repl">julia&gt; big(0.1)
1.000000000000000055511151231257827021181583404541015625000000000000000000000000e-01</code></pre><p>So, in fact, the Julia float <code>0.1</code> refers to a real number that is slightly greater than 0.1. By default, such calculations are done in round-to-nearest mode (<code>RoundNearest</code>); i.e., the nearest representable floating-point number to 0.1 is used.</p><p>[Recall that to get a <code>BigFloat</code> that is as close as possible to the true 0.1, you can use a special string macro:</p><pre><code class="language-julia-repl">julia&gt; big&quot;0.1&quot;
1.000000000000000000000000000000000000000000000000000000000000000000000000000002e-01</code></pre><p>]</p><p>Suppose that we create a thin interval, containing just the floating-point number <code>0.1</code>:</p><pre><code class="language-julia-repl">julia&gt; using IntervalArithmetic

julia&gt; II = Interval(0.1)
[0.1, 0.100001]

julia&gt; showfull(II)
Interval(0.1, 0.1)</code></pre><p>It looks like <code>II</code> contains (the true) 0.1, but from the above discussion we see that <em>it does not</em>. In order to contain 0.1, the end-points of the interval must be rounded outwards (&quot;directed rounding&quot;): the lower bound is rounded down, and the upper bound is rounded up.</p><p>This rounding is handled by the <code>@interval</code>  macro, which generates correctly-rounded intervals:</p><pre><code class="language-julia-repl">julia&gt; a = @interval(0.1)
[0.0999999, 0.100001]
</code></pre><p>The true 0.1 is now correctly contained in the intervals, so that any calculations on these intervals will contain the true result of calculating with 0.1. For example, if we define</p><pre><code class="language-julia-repl">julia&gt; f(x) = 2x + 0.2
f (generic function with 1 method)
</code></pre><p>then we can apply the function <code>f</code> to the interval <code>a</code> to obtain</p><pre><code class="language-julia-repl">julia&gt; f(a)
[0.399999, 0.400001]

julia&gt; showfull(f(a))
Interval(0.39999999999999997, 0.4)</code></pre><p>The result correctly contains the true 0.4.</p><h2><a class="nav-anchor" id="More-detail:-the-internal-representation-1" href="#More-detail:-the-internal-representation-1">More detail: the internal representation</a></h2><p>Let&#39;s look at the internal representation of the <code>Float64</code> number 0.1:</p><pre><code class="language-julia-repl">julia&gt; bits(0.1)
&quot;0011111110111001100110011001100110011001100110011001100110011010&quot;</code></pre><p>The last 53 bits of these 64 bits correspond to the binary expansion of 0.1, which is</p><pre><code class="language-none">0.000110011001100110011001100110011001100...</code></pre><p>We see that the expansion is periodic; in fact, the binary expansion of 0.1 has an infinite repetition of the sequence of digits <code>1100</code>. It is thus <em>impossible</em> to represent the decimal 0.1 in binary, with <em>any</em> precision.</p><p>The true value must be approximated by a floating-point number with fixed precision – this procedure is called <strong>rounding</strong>. For positive numbers, rounding down may be accomplished simply by truncating the expansion; rounding up is accomplished by incrementing the final binary digit and propagating any resulting changes.</p><footer><hr/><a class="previous" href="../multidim/"><span class="direction">Previous</span><span class="title">Multi-dimensional boxes</span></a><a class="next" href="../api/"><span class="direction">Next</span><span class="title">API</span></a></footer></article></body></html>
