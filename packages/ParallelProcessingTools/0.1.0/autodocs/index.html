<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Docstrings · ParallelProcessingTools.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ParallelProcessingTools.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Readme</a></li><li class="current"><a class="toctext" href>Docstrings</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Docstrings</a></li></ul></nav><hr/><div id="topbar"><span>Docstrings</span><a class="fa fa-bars" href="#"></a></div></header><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.@critical" href="#ParallelProcessingTools.@critical"><code>ParallelProcessingTools.@critical</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><pre><code class="language-none">@critical expr</code></pre><p>Mark code in <code>expr</code> as a critical section. Code in critical sections will never be executed in parallel (via multithreading) to any other critical section.</p><p><code>@critical</code> is very useful to mark non-threadsafe code.</p><p>Example:</p><pre><code class="language-julia">@onthreads allthreads() begin
    @critical @info Base.Threads.threadid()
end

Without `@critical`, the above will typically crash Julia.</code></pre></div></div></section><pre><code class="language-none">ParallelProcessingTools.@onallthreads</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.@onprocs" href="#ParallelProcessingTools.@onprocs"><code>ParallelProcessingTools.@onprocs</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><pre><code class="language-none">@onprocs procsel expr</code></pre><p>Executes <code>expr</code> in parallel on all processes in <code>procsel</code>. Waits until all processes are done. Returns all results as a vector (or as a single scalar value, if <code>procsel</code> itself is a scalar).</p><p>Example:</p><pre><code class="language-julia">using Distributed
addprocs(2)
workers() == @onprocs workers() myid()</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.@onthreads" href="#ParallelProcessingTools.@onthreads"><code>ParallelProcessingTools.@onthreads</code></a> — <span class="docstring-category">Macro</span>.</div><div><div><pre><code class="language-none">@onthreads threadsel expr</code></pre><p>Execute code in <code>expr</code> in parallel on the threads in <code>threadsel</code>.</p><p><code>threadsel</code> should be a single thread-ID or a range (or array) of thread-ids. If <code>threadsel == Base.Threads.threadid()</code>, <code>expr</code> is run on the current tread with only minimal overhead.</p><p>Note: Currently, multiple <code>@onthreads</code> sections will not run in parallel to each other, even if they use disjunct sets of threads, due to limitations of the Julia multithreading implementation. This restriction is likely to disappear in future Julia versions.</p><p>In contrast to <code>Base.Threads.@threads</code>, <code>@onthreads</code> does forward exceptions to the caller.</p><p>Example 1:</p><pre><code class="language-julia">tlsum = ThreadLocal(0.0)
data = rand(100)
@onthreads allthreads() begin
    tlsum[] = sum(workpart(data, allthreads(), Base.Threads.threadid()))
end
sum(getallvalues(tlsum)) ≈ sum(data)</code></pre><p>Example 2:</p><pre><code class="language-julia"># Assuming 4 threads:
tl = ThreadLocal(42)
threadsel = 2:3
@onthreads threadsel begin
    tl[] = Base.Threads.threadid()
end
getallvalues(tl)[threadsel] == [2, 3]
getallvalues(tl)[[1,4]] == [42, 42]</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.AbstractThreadLocal" href="#ParallelProcessingTools.AbstractThreadLocal"><code>ParallelProcessingTools.AbstractThreadLocal</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">abstract type AbstractThreadLocal{T} end</code></pre><p>Abstract type for thread-local values of type <code>T</code>.</p><p>The value for the current thread is accessed via <code>getindex(::AbstractThreadLocal)</code> and `setindex(::AbstractThreadLocal, x).</p><p>To access both regular and thread-local values in a unified manner, use the function <a href="#ParallelProcessingTools.getlocalvalue"><code>getlocalvalue</code></a>.</p><p>To get the all values across all threads, use the function <a href="#ParallelProcessingTools.getallvalues"><code>getallvalues</code></a>.</p><p>Default implementation is <a href="#ParallelProcessingTools.ThreadLocal"><code>ThreadLocal</code></a>.</p></div></div></section><pre><code class="language-none">ParallelProcessingTools.LockableIO</code></pre><pre><code class="language-none">ParallelProcessingTools.LockableValue</code></pre><pre><code class="language-none">ParallelProcessingTools.ParallelProcessingTools</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.ThreadLocal" href="#ParallelProcessingTools.ThreadLocal"><code>ParallelProcessingTools.ThreadLocal</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">ThreadLocal{T} &lt;: AbstractThreadLocal{T}</code></pre><p>Represents a thread-local value. See <a href="#ParallelProcessingTools.AbstractThreadLocal"><code>AbstractThreadLocal</code></a> for the API.</p><p>Constructors:</p><pre><code class="language-julia">ThreadLocal{T}() where {T}
ThreadLocal(value::T) where {T}
ThreadLocal{T}(f::Base.Callable) where {T}</code></pre><p>Examples:</p><pre><code class="language-julia">tlvalue = ThreadLocal(0)
@onthreads allthreads() tlvalue[] = Base.Threads.threadid()
getallvalues(tlvalue) == allthreads()</code></pre><pre><code class="language-julia">rand_value_on_each_thread = ThreadLocal{Float64}(rand)
all(x -&gt; 0 &lt; x &lt; 1, getallvalues(rand_value_on_each_thread))</code></pre></div></div></section><pre><code class="language-none">ParallelProcessingTools.ThreadSafe</code></pre><pre><code class="language-none">ParallelProcessingTools.ThreadSafeIO</code></pre><pre><code class="language-none">ParallelProcessingTools.ThreadSafeReentrantLock</code></pre><pre><code class="language-none">ParallelProcessingTools._check_thread_local_errors</code></pre><pre><code class="language-none">ParallelProcessingTools._check_threadsel</code></pre><pre><code class="language-none">ParallelProcessingTools._clear_thread_local_errors</code></pre><pre><code class="language-none">ParallelProcessingTools._critical_section_lock</code></pre><pre><code class="language-none">ParallelProcessingTools._current_thread_selected</code></pre><pre><code class="language-none">ParallelProcessingTools._is_sorted_and_unique</code></pre><pre><code class="language-none">ParallelProcessingTools._protect_from_resize</code></pre><pre><code class="language-none">ParallelProcessingTools._run_on_procs</code></pre><pre><code class="language-none">ParallelProcessingTools._run_on_threads</code></pre><pre><code class="language-none">ParallelProcessingTools._set_thread_local_error</code></pre><pre><code class="language-none">ParallelProcessingTools._thread_exec_func</code></pre><pre><code class="language-none">ParallelProcessingTools._thread_local_error_err</code></pre><pre><code class="language-none">ParallelProcessingTools._thread_local_error_set</code></pre><pre><code class="language-none">ParallelProcessingTools._workpart_hi</code></pre><pre><code class="language-none">ParallelProcessingTools._workpart_scheme</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.allthreads" href="#ParallelProcessingTools.allthreads"><code>ParallelProcessingTools.allthreads</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">allthreads()</code></pre><p>Convencience function, returns <code>1:Base.Threads.nthreads()</code>.</p></div></div></section><pre><code class="language-none">ParallelProcessingTools.eval</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.getallvalues" href="#ParallelProcessingTools.getallvalues"><code>ParallelProcessingTools.getallvalues</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">getallvalues(v::AbstractThreadLocal{T})::AbstractVector{T}</code></pre><p>Access the all values (one for each thread) of a thread-local value as a vector. Can only be called in single-threaded code sections.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.getlocalvalue" href="#ParallelProcessingTools.getlocalvalue"><code>ParallelProcessingTools.getlocalvalue</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">getlocalvalue(x::Any) = x
getlocalvalue(x::ThreadLocal) = x[]</code></pre><p>Access plain values and thread-local values in a unified fashion.</p></div></div></section><pre><code class="language-none">ParallelProcessingTools.include</code></pre><pre><code class="language-none">ParallelProcessingTools.isdefined_local</code></pre><pre><code class="language-none">ParallelProcessingTools.mtjulia_exe</code></pre><pre><code class="language-none">ParallelProcessingTools.threadpartition</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParallelProcessingTools.workpart" href="#ParallelProcessingTools.workpart"><code>ParallelProcessingTools.workpart</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">workpart(data::AbstractArray, workersel::AbstractVector{W}, current_worker::W) where {W}</code></pre><p>Get the part of <code>data</code> that the execution unit <code>current_worker</code> is responsible for. Implies a partition of <code>data</code> across the workers listed in <code>workersel</code>.</p><p>For generic <code>data</code> arrays, <code>workpart</code> will return a view. If <code>data</code> is a <code>Range</code> (e.g. indices to be processed), a sub-range will be returned.</p><p>Type <code>W</code> will typically be <code>Int</code> and <code>workersel</code> will usually be a range/array of thread/process IDs.</p><p>Note: <code>workersel</code> is required to be sorted in ascending order and to contain no duplicate entries.</p><p>Examples:</p><pre><code class="language-julia">using Distributed, Base.Threads
A = rand(100)
# ...
sub_A = workpart(A, workers(), myid())
# ...
idxs = workpart(eachindex(sub_A), allthreads(), threadid())
for i in idxs
    # ...
end</code></pre></div></div></section><pre><code class="language-none">ParallelProcessingTools.workpartition</code></pre><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Readme</span></a></footer></article></body></html>
