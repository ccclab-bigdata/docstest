<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Readme · DiffEqBayes.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>DiffEqBayes.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Readme</a><ul class="internal"><li><a class="toctext" href="#Example-1">Example</a></li></ul></li><li><a class="toctext" href="autodocs/">Docstrings</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Readme</a></li></ul></nav><hr/><div id="topbar"><span>Readme</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="DiffEqBayes.jl-1" href="#DiffEqBayes.jl-1">DiffEqBayes.jl</a></h1><p><a href="https://travis-ci.org/JuliaDiffEq/DiffEqBayes.jl"><img src="https://travis-ci.org/JuliaDiffEq/DiffEqBayes.jl.svg?branch=master" alt="Build Status"/></a> <a href="https://coveralls.io/github/JuliaDiffEq/DiffEqBayes.jl?branch=master"><img src="https://coveralls.io/repos/JuliaDiffEq/DiffEqBayes.jl/badge.svg?branch=master&amp;service=github" alt="Coverage Status"/></a> <a href="http://codecov.io/github/JuliaDiffEq/DiffEqBayes.jl?branch=master"><img src="http://codecov.io/github/JuliaDiffEq/DiffEqBayes.jl/coverage.svg?branch=master" alt="codecov.io"/></a></p><p>This repository is a set of extension functionality for estimating the parameters of differential equations using Bayesian methods. It allows the choice of using <a href="https://github.com/goedman/Stan.jl">Stan.jl</a>, <a href="https://github.com/yebai/Turing.jl">Turing.jl</a>, <a href="https://github.com/tpapp/DynamicHMC.jl">DynamicHMC.jl</a> and <a href="https://github.com/marcjwilliams1/ApproxBayes.jl">ApproxBayes.jl</a> to perform a Bayesian estimation of a differential equation problem specified via the <a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl">DifferentialEquations.jl</a> interface.</p><p>To begin you first need to add this repository using the following command.</p><pre><code class="language-julia">Pkg.add(&quot;DiffEqBayes&quot;)
using DiffEqBayes</code></pre><h3><a class="nav-anchor" id="stan_inference-1" href="#stan_inference-1">stan_inference</a></h3><pre><code class="language-julia">stan_inference(prob::ODEProblem,t,data,priors = nothing;alg=:rk45,
               num_samples=1000, num_warmup=1000, reltol=1e-3,
               abstol=1e-6, maxiter=Int(1e5),likelihood=Normal,
               vars=(StanODEData(),InverseGamma(2,3)))</code></pre><p><code>stan_inference</code> uses <a href="http://goedman.github.io/Stan.jl/latest/INTRO.html">Stan.jl</a> to perform the Bayesian inference. The <a href="http://goedman.github.io/Stan.jl/latest/INSTALLATION.html">Stan installation process</a> is required to use this function. The input requires that the function is defined by a <code>ParameterizedFunction</code> with the <code>@ode_def</code> macro. <code>t</code> is the array of time and <code>data</code> is the array where the first dimension (columns) corresponds to the array of system values. <code>priors</code> is an array of prior distributions for each parameter, specified via a <a href="https://juliastats.github.io/Distributions.jl/latest/">Distributions.jl</a> type. <code>alg</code> is a choice between <code>:rk45</code> and <code>:bdf</code>, the two internal integrators of Stan. <code>num_samples</code> is the number of samples to take per chain, and <code>num_warmup</code> is the number of MCMC warmup steps. <code>abstol</code> and <code>reltol</code> are the keyword arguments for the internal integrator. <code>liklihood</code> is the likelihood distribution to use with the arguments from <code>vars</code>, and <code>vars</code> is a tuple of priors for the distributions of the likelihood hyperparameters. The special value <code>StanODEData()</code> in this tuple denotes the position that the ODE solution takes in the likelihood&#39;s parameter list.</p><h3><a class="nav-anchor" id="turing_inference-1" href="#turing_inference-1">turing_inference</a></h3><pre><code class="language-julia">turing_inference(prob::DEProblem,alg,t,data,priors = nothing;
                 num_samples=1000, epsilon = 0.02, tau = 4, kwargs...)</code></pre><p><code>turing_inference</code> uses <a href="https://github.com/yebai/Turing.jl">Turing.jl</a> to perform its parameter inference. <code>prob</code> can be any <code>DEProblem</code> with a corresponding <code>alg</code> choice. <code>t</code> is the array of time points and <code>data[:,i]</code> is the set of observations for the differential equation system at time point <code>t[i]</code> (or higher dimensional). <code>priors</code> is an array of prior distributions for each parameter, specified via a <a href="https://juliastats.github.io/Distributions.jl/latest/">Distributions.jl</a> type. <code>num_samples</code> is the number of samples per MCMC chain. <code>epsilon</code> and <code>tau</code> are the HMC parameters. The extra <code>kwargs</code> are given to the internal differential equation solver.</p><h3><a class="nav-anchor" id="dynamichmc_inference-1" href="#dynamichmc_inference-1">dynamichmc_inference</a></h3><pre><code class="language-julia">dynamichmc_inference(prob::DEProblem,data,priors,t,transformations;
                      σ = 0.01,ϵ=0.001,initial=Float64[])</code></pre><p><code>dynamichmc_inference</code> uses <a href="https://github.com/tpapp/DynamicHMC.jl">DynamicHMC.jl</a> to  perform the bayesian parameter estimation. <code>prob</code> can be any <code>DEProblem</code>, <code>data</code> is the set  of observations for our model which is to be used in the Bayesian Inference process. <code>priors</code> represent the  choice of prior distributions for the parameters to be determined, passed as an array of <a href="https://juliastats.github.io/Distributions.jl/latest/">Distributions.jl</a> distributions. <code>t</code> is the array of time points. <code>transformations</code>  is an array of <a href="https://github.com/tpapp/ContinuousTransformations.jl">Tranformations</a> imposed for constraining the  parameter values to specific domains. <code>initial</code> values for the parameters can be passed, if not passed the means of the  <code>priors</code> are used. <code>ϵ</code> can be used as a kwarg to pass the initial step size for the NUTS algorithm.</p><h3><a class="nav-anchor" id="abc_inference-1" href="#abc_inference-1">abc_inference</a></h3><pre><code class="language-julia">abc_inference(prob::DEProblem, alg, t, data, priors; ϵ=0.001,
     distancefunction = euclidean, ABCalgorithm = ABCSMC, progress = false,
     num_samples = 500, maxiterations = 10^5, kwargs...)</code></pre><p><code>abc_inference</code> uses <a href="https://github.com/marcjwilliams1/ApproxBayes.jl">ApproxBayes.jl</a> which uses Approximate Bayesian Computation (ABC) to perform its parameter inference. <code>prob</code> can be any <code>DEProblem</code> with a corresponding <code>alg</code> choice. <code>t</code> is the array of time points and <code>data[:,i]</code> is the set of observations for the differential equation system at time point <code>t[i]</code> (or higher dimensional). <code>priors</code> is an array of prior distributions for each parameter, specified via a <a href="https://juliastats.github.io/Distributions.jl/latest/">Distributions.jl</a> type. <code>num_samples</code> is the number of posterior samples. <code>ϵ</code> is the target distance between the data and simulated data. <code>distancefunction</code> is a distance metric specified from the <a href="https://github.com/JuliaStats/Distances.jl">Distances.jl</a> package, the default is <code>euclidean</code>. <code>ABCalgorithm</code> is the ABC algorithm to use, options are <code>ABCSMC</code> or <code>ABCRejection</code> from <a href="https://github.com/marcjwilliams1/ApproxBayes.jl">ApproxBayes.jl</a>, the default is the former which is more efficient. <code>maxiterations</code> is the maximum number of iterations before the algorithm terminates. The extra <code>kwargs</code> are given to the internal differential equation solver.</p><h2><a class="nav-anchor" id="Example-1" href="#Example-1">Example</a></h2><p>```julia  f1 = @ode<em>def</em>nohes LotkaVolterraTest1 begin   dx = a<em>x - x</em>y   dy = -3<em>y + x</em>y  end a</p><p>p = [1.5]  u0 = [1.0,1.0]  tspan = (0.0,10.0)  prob1 = ODEProblem(f1,u0,tspan,p)</p><p>σ = 0.01                         # noise, fixed for now  t = collect(linspace(1,10,10))   # observation times  sol = solve(prob1,Tsit5())</p><p>randomized = VectorOfArray([(sol(t[i]) + σ * randn(2)) for i in 1:length(t)])  data = convert(Array,randomized)</p><p>bayesian<em>result</em>stan = stan<em>inference(prob1,t,data,priors;num</em>samples=300,                                  num_warmup=500,likelihood=Normal,                                  vars =(StanODEData(),InverseGamma(3,2)))</p><p>bayesian<em>result</em>turing = turing<em>inference(prob1,Tsit5(),t,data,priors;num</em>samples=500)</p><p>bayesian<em>result</em>hmc = dynamichmc_inference(prob1, data, [Normal(1.5, 1)], t, [bridge(ℝ, ℝ⁺, )])</p><p>bayesian<em>result</em>abc = abc<em>inference(prob1, Tsit5(), t, data, [Normal(1.5, 1)];                                  num</em>samples=500)  ```</p><footer><hr/><a class="next" href="autodocs/"><span class="direction">Next</span><span class="title">Docstrings</span></a></footer></article></body></html>
