<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Docstrings · KernelDensityEstimate.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>KernelDensityEstimate.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Readme</a></li><li class="current"><a class="toctext" href>Docstrings</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Docstrings</a></li></ul></nav><hr/><div id="topbar"><span>Docstrings</span><a class="fa fa-bars" href="#"></a></div></header><pre><code class="language-none">KernelDensityEstimate.*</code></pre><pre><code class="language-none">KernelDensityEstimate.BallTree</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.BallTreeDensity" href="#KernelDensityEstimate.BallTreeDensity"><code>KernelDensityEstimate.BallTreeDensity</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Evaluate the KDE object at given points.</p><blockquote><p><strong>Note</strong>, must use Array{Float64,2} when passing in evaluation points.</p></blockquote></div></div></section><pre><code class="language-none">KernelDensityEstimate.DirectSize</code></pre><pre><code class="language-none">KernelDensityEstimate.FORCE_EVAL_DIRECT</code></pre><pre><code class="language-none">KernelDensityEstimate.GaussianKer</code></pre><pre><code class="language-none">KernelDensityEstimate.GbGlb</code></pre><pre><code class="language-none">KernelDensityEstimate.KernelDensityEstimate</code></pre><pre><code class="language-none">KernelDensityEstimate.MSCompOpt</code></pre><pre><code class="language-none">KernelDensityEstimate.MixtureDensity</code></pre><pre><code class="language-none">KernelDensityEstimate.NO_CHILD</code></pre><pre><code class="language-none">KernelDensityEstimate.Ndim</code></pre><pre><code class="language-none">KernelDensityEstimate.Npts</code></pre><pre><code class="language-none">KernelDensityEstimate.VectorRange</code></pre><pre><code class="language-none">KernelDensityEstimate.buildBall!</code></pre><pre><code class="language-none">KernelDensityEstimate.buildTree!</code></pre><pre><code class="language-none">KernelDensityEstimate.bw</code></pre><pre><code class="language-none">KernelDensityEstimate.bwMax</code></pre><pre><code class="language-none">KernelDensityEstimate.bwMin</code></pre><pre><code class="language-none">KernelDensityEstimate.bwUniform</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.calcIndices!" href="#KernelDensityEstimate.calcIndices!"><code>KernelDensityEstimate.calcIndices!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">calcIndices!(glb)
</code></pre><p>Recompute particles, variance.</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.calcStats!</code></pre><pre><code class="language-none">KernelDensityEstimate.calcStatsBall!</code></pre><pre><code class="language-none">KernelDensityEstimate.calcStatsDensity!</code></pre><pre><code class="language-none">KernelDensityEstimate.center</code></pre><pre><code class="language-none">KernelDensityEstimate.changeWeights!</code></pre><pre><code class="language-none">KernelDensityEstimate.closer!</code></pre><pre><code class="language-none">KernelDensityEstimate.convert</code></pre><pre><code class="language-none">KernelDensityEstimate.dontRecurseSubtrees</code></pre><pre><code class="language-none">KernelDensityEstimate.entropy</code></pre><pre><code class="language-none">KernelDensityEstimate.eval</code></pre><pre><code class="language-none">KernelDensityEstimate.evalAvgLogL</code></pre><pre><code class="language-none">KernelDensityEstimate.evalDirect</code></pre><pre><code class="language-none">KernelDensityEstimate.evaluate</code></pre><pre><code class="language-none">KernelDensityEstimate.evaluateDualTree</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.gaussianProductMeanCov!" href="#KernelDensityEstimate.gaussianProductMeanCov!"><code>KernelDensityEstimate.gaussianProductMeanCov!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">gaussianProductMeanCov!(glb, j, destMu, destCov, idx, skip)
gaussianProductMeanCov!(glb, j, destMu, destCov, idx, skip, addop)
gaussianProductMeanCov!(glb, j, destMu, destCov, idx, skip, addop, getMu)
gaussianProductMeanCov!(glb, j, destMu, destCov, idx, skip, addop, getMu, getLambda)
</code></pre><p>Multiplication of Gaussians using leave in densities (if skip <code>skip</code> &gt; 0).  For on-manifold operations, set <code>getMu</code> and <code>getLambda</code> operations accordingly.</p><p><strong>Notes</strong></p><ul><li>Used twice in samplePoint! (won&#39;t skip) and sampleIndex (will skip LOO).</li><li>Assumes manifold <code>diffop</code> baked into <code>getMu</code>.</li><li>use <code>j</code>th dimension</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.getBW" href="#KernelDensityEstimate.getBW"><code>KernelDensityEstimate.getBW</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">getBW(bd)
getBW(bd, ind)
</code></pre><p>Return the bandwidths used for each kernel in the density estimate.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.getEuclidLambda" href="#KernelDensityEstimate.getEuclidLambda"><code>KernelDensityEstimate.getEuclidLambda</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">getEuclidLambda(lambdas)
</code></pre><p>Returns <code>Λ=Σ^{-1}</code> as sum of individual information matrices (inverse covariances – i.e. bandwidths).</p><div>\[Λ = Σ_i Λ_i\]</div></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.getEuclidMu" href="#KernelDensityEstimate.getEuclidMu"><code>KernelDensityEstimate.getEuclidMu</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">getEuclidMu(mus, lambdas)
getEuclidMu(mus, lambdas, scale)
</code></pre><p>Returns <code>Λμ</code>.</p><div>\[Λμ = Σ_i (Λ_i*μ_i)\]</div></div></div></section><pre><code class="language-none">KernelDensityEstimate.getIndexOf</code></pre><pre><code class="language-none">KernelDensityEstimate.getKDEMax</code></pre><pre><code class="language-none">KernelDensityEstimate.getKDEMean</code></pre><pre><code class="language-none">KernelDensityEstimate.getKDERange</code></pre><pre><code class="language-none">KernelDensityEstimate.getKDERangeLinspace</code></pre><pre><code class="language-none">KernelDensityEstimate.getKDEfit</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.getMiniMaxi" href="#KernelDensityEstimate.getMiniMaxi"><code>KernelDensityEstimate.getMiniMaxi</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">getMiniMaxi(bt, leftI, rightI, d, addop, diffop)
</code></pre><p>Return &quot;smaller&quot; and &quot;larger&quot; of two child nodes.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.getPoints" href="#KernelDensityEstimate.getPoints"><code>KernelDensityEstimate.getPoints</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">getPoints(bd)
</code></pre><p>Return the points (centers) used to construct the KDE.</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.getType</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.getWeights" href="#KernelDensityEstimate.getWeights"><code>KernelDensityEstimate.getWeights</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">getWeights(bd)
getWeights(bd, ind)
</code></pre><p>Return the weights used for each kernel in the density estimate.</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.gibbs1</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.golden" href="#KernelDensityEstimate.golden"><code>KernelDensityEstimate.golden</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">golden(bd, ax, bx, cx, tol, addop, diffop)
</code></pre><p>GOLDEN   Minimize the nLOO_LL function for KDE bandwidth selection of one variable using golden section search.</p><p>xmin, fmin = golden(npd, f, ax, bx, cx, tol) computes a local minimum of f = KDE.nLOO_LL. xmin is the computed local minimizer of f and fmin is f(xmin). xmin is computed to an relative accuracy of TOL.</p><p>The parameters ax, bx and cx must satisfy the following conditions: ax &lt; bx &lt; cx, f(bx) &lt; f(ax) and f(bx) &lt; f(cx).</p><p>xmin satisfies ax &lt; xmin &lt; cx. golden is guaranteed to succeed if f is continuous between ax and cx</p><p>Roman Geus, ETH Zuerich, 9.12.97</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.include</code></pre><pre><code class="language-none">KernelDensityEstimate.initIndices!</code></pre><pre><code class="language-none">KernelDensityEstimate.intersIntgAppxIS</code></pre><pre><code class="language-none">KernelDensityEstimate.isLeaf</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.kde!" href="#KernelDensityEstimate.kde!"><code>KernelDensityEstimate.kde!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">kde!(points)
kde!(points, ks)
kde!(points, ks, addop)
kde!(points, ks, addop, diffop)
</code></pre><p>Construct a BallTreeDensity object using <code>points</code> for centers and bandwidth <code>ks</code>.</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.kld</code></pre><pre><code class="language-none">KernelDensityEstimate.ksize</code></pre><pre><code class="language-none">KernelDensityEstimate.leafFirst</code></pre><pre><code class="language-none">KernelDensityEstimate.leafLast</code></pre><pre><code class="language-none">KernelDensityEstimate.left</code></pre><pre><code class="language-none">KernelDensityEstimate.levelDown!</code></pre><pre><code class="language-none">KernelDensityEstimate.levelInit!</code></pre><pre><code class="language-none">KernelDensityEstimate.makeBallTree</code></pre><pre><code class="language-none">KernelDensityEstimate.makeBallTreeDensity</code></pre><pre><code class="language-none">KernelDensityEstimate.makeDualTree</code></pre><pre><code class="language-none">KernelDensityEstimate.makeEmptyGbGlb</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.makeFasterSampleIndex!" href="#KernelDensityEstimate.makeFasterSampleIndex!"><code>KernelDensityEstimate.makeFasterSampleIndex!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">makeFasterSampleIndex!(j, cmo, glb)
makeFasterSampleIndex!(j, cmo, glb, diffop)
</code></pre><p>Calculate the likelihoods of left out kernel means (label_i&#39;s) against Normal distribution with mean <code>glb.Malmost</code> and variance <code>glb.Calmost</code> – we think ...</p><p><strong>Assumes</strong></p><p>Temporary product gaussian on manifold has already been computed and stored in <code>glb.Calmost</code> and <code>glb.Malmost</code>.</p><p><strong>Notes</strong></p><ul><li>Incoming temporary product mean is <code>glb.Malmost</code> and covariance <code>glb.Calmost</code>.</li><li><code>j</code> is the left out density – i.e. the density for which we want to select a new label (kernel)</li><li><code>cmo.tmpM</code> is the manifold difference from all dimensions prior to evaluating Gaussian pdf, and relates to levels of the k-d tree...</li><li><code>z</code> is index of leave one out density kernels – i.e. evaluate likelihood of each kernel mean <code>glb.p[z] = p(μ_z)</code></li><li>New kernel will be selected randomly from likelihood weights in <code>glb.p[z:z]</code>.</li></ul><p><strong>Potential Concerns</strong></p><ul><li>Make sure tmpC can happen on Euclidean vs user manifold</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.marginal" href="#KernelDensityEstimate.marginal"><code>KernelDensityEstimate.marginal</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">marginal(bd, ind)
</code></pre><p>Extract the marginal distribution from the given higher dimensional kernel density estimate object.</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.maxDistGauss!</code></pre><pre><code class="language-none">KernelDensityEstimate.maxDistKer!</code></pre><pre><code class="language-none">KernelDensityEstimate.mean</code></pre><pre><code class="language-none">KernelDensityEstimate.minDistGauss!</code></pre><pre><code class="language-none">KernelDensityEstimate.minDistKer!</code></pre><pre><code class="language-none">KernelDensityEstimate.most_spread_coord</code></pre><pre><code class="language-none">KernelDensityEstimate.movePoints!</code></pre><pre><code class="language-none">KernelDensityEstimate.nLOO_LL</code></pre><pre><code class="language-none">KernelDensityEstimate.neighborMinMax</code></pre><pre><code class="language-none">KernelDensityEstimate.pArrHdls</code></pre><pre><code class="language-none">KernelDensityEstimate.parsestringvector</code></pre><pre><code class="language-none">KernelDensityEstimate.printBallTree</code></pre><pre><code class="language-none">KernelDensityEstimate.printGlbs</code></pre><pre><code class="language-none">KernelDensityEstimate.prodAppxMSGibbsS</code></pre><pre><code class="language-none">KernelDensityEstimate.pushDownAll</code></pre><pre><code class="language-none">KernelDensityEstimate.pushDownLocal</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.rand" href="#Base.rand"><code>Base.rand</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">rand(p)
rand(p, N)
</code></pre><p>Randomly sample points from the KernelDensityEstimate object.</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.randKernel</code></pre><pre><code class="language-none">KernelDensityEstimate.rangeB</code></pre><pre><code class="language-none">KernelDensityEstimate.recurseMinMax</code></pre><pre><code class="language-none">KernelDensityEstimate.recurseOnSubtrees</code></pre><pre><code class="language-none">KernelDensityEstimate.resample</code></pre><pre><code class="language-none">KernelDensityEstimate.right</code></pre><pre><code class="language-none">KernelDensityEstimate.root</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="StatsBase.sample" href="#StatsBase.sample"><code>StatsBase.sample</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">sample(npd, Npts)
</code></pre><p>Randomly sample points from the KernelDensityEstimate object.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.sampleIndex" href="#KernelDensityEstimate.sampleIndex"><code>KernelDensityEstimate.sampleIndex</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">sampleIndex(j, cmo, glb)
sampleIndex(j, cmo, glb, addop)
sampleIndex(j, cmo, glb, addop, diffop)
sampleIndex(j, cmo, glb, addop, diffop, getMu)
sampleIndex(j, cmo, glb, addop, diffop, getMu, getLambda)
</code></pre><p>Sample new kernel in leave out density according to multiscale Gibbs sampling.</p><ul><li>calculate temporary product of leave in density components (labels previously selected)</li><li>evaluate the likelihoods of the kernel means from the left out kernel on temporary product</li><li>randomly select a new label (kernel_i) for left out density according to temporarily evaluated likelihoods</li></ul><p><strong>Notes</strong></p><ul><li><code>j</code> is the left out density.</li><li>Needs on-manifold getMu for product of two leave in density kernels.</li><li>Needs diffop (on manifold difference for kernel evaluation).</li></ul><p>Sudderth PhD, p.139, Fig. 3.3, top-left operation</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.sampleIndices!" href="#KernelDensityEstimate.sampleIndices!"><code>KernelDensityEstimate.sampleIndices!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">sampleIndices!(X, cmoi, glb, frm)
sampleIndices!(X, cmoi, glb, frm, diffop)
</code></pre><p>??</p><p><strong>Notes</strong></p><ul><li>This function does kernel evaluation internally.</li><li>Does not have a loo skip step.</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KernelDensityEstimate.samplePoint!" href="#KernelDensityEstimate.samplePoint!"><code>KernelDensityEstimate.samplePoint!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">samplePoint!(X, glb, frm)
samplePoint!(X, glb, frm, addop)
samplePoint!(X, glb, frm, addop, getMu)
samplePoint!(X, glb, frm, addop, getMu, getLambda)
</code></pre><p>Sampling a point from the product of kernels (density components) listed in <code>glb.variance</code> and <code>glb.particles</code> without skipping a kernel (not a leave-one-out case).</p><p>Manifold defined by <code>addop</code>, <code>getMu</code>, and <code>getLambda</code>.</p></div></div></section><pre><code class="language-none">KernelDensityEstimate.select!</code></pre><pre><code class="language-none">KernelDensityEstimate.setForceEvalDirect!</code></pre><pre><code class="language-none">KernelDensityEstimate.string</code></pre><pre><code class="language-none">KernelDensityEstimate.swap!</code></pre><pre><code class="language-none">KernelDensityEstimate.swapBall!</code></pre><pre><code class="language-none">KernelDensityEstimate.swapDensity!</code></pre><pre><code class="language-none">KernelDensityEstimate.updateBandwidth!</code></pre><pre><code class="language-none">KernelDensityEstimate.validIndex</code></pre><pre><code class="language-none">KernelDensityEstimate.variance</code></pre><pre><code class="language-none">KernelDensityEstimate.weight</code></pre><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Readme</span></a></footer></article></body></html>
