module GensysTests

include(joinpath(dirname(@__FILE__), "..", "src", "AndersonMoore.jl"))
using .AndersonMoore

function example0()::Bool

    #inputs
    g0 = [1.0                 0.0   0.0   0.0  0.0   0.0  0.0  0.0
          0.0                 1.0   0.0   0.0  0.0   0.0  0.0  0.0
          0.0                 0.0   1.0   0.0  0.0   0.0  0.0  0.0
          0.0                 0.0   0.0   1.0  0.0   0.0  0.0  0.0
          0.0                 0.0  -1.0   0.0  0.0   0.0  0.0  0.0
          -13.846153846153843  -1.0   0.0   0.0  0.0   0.0  0.0  0.0
          0.0                 0.0   0.0  -1.0  0.0   0.0  0.0  0.0
          0.0                 1.0   0.0   0.0  0.0  -1.0  1.0  0.0]

    g1 = [0.0                   0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0                   0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0                   0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0                   0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.022178217821782198  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -13.984615384615383     0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -0.36                  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0  0.0  0.0  0.0  0.0  0.0  0.0]

    cc = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]
    

    psi = hcat([0.0                 
           0.0                 
           0.0                 
           0.0                 
           -0.034653465346534684
           -1.346153846153846   
           -1.0                 
           0.0])
    
    pi = [1.0  0.0  0.0  0.0
          0.0  1.0  0.0  0.0
          0.0  0.0  1.0  0.0
          0.0  0.0  0.0  1.0
          0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0]

    div = 1.0

    
    #outputs
    G1Expected = [0.9653606725488151     0.0   0.0   0.0   0.0   0.0   0.0   0.0
             0.6180829954779459    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.022178217821782198  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             0.36                  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             0.9319212281039009    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             0.5966730162055764     0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.021409979272369376   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             0.3475298421175736     0.0   0.0   0.0   0.0   0.0   0.0   0.0]

    CCExpected = [0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0]

    impactExpected = [0.0929252572585493  
                 0.05949643795854815 
                 0.034653465346534684
                 1.0                 
                 0.08970638884388482 
                 0.05743552136192289 
                 -0.002060916596625254
                 0.03345309261307775]

    fmatExpected = [0.0  -0.06903019110635096   0.06903019110635095  0.0
               0.0   0.9558026460879361   -0.955802646087936    0.0
               0.0   0.0                   0.0                  0.0
               0.0   0.0                   0.0                  0.0]

    fwtExpected = [0.09292525725854936 
              0.05949643795854769 
              0.034653465346534684
              1.0]

    ywtExpected = [0.0  -0.06903019110635096    0.06903019110635095  0.0
              0.0   0.9558026460879361    -0.955802646087936    0.0
              0.0   0.0                    0.0                  0.0
              0.0   0.0                    0.0                  0.0
              1.0  -0.06663903171260024    0.06663903171260022  0.0
              0.0   0.957333612702572      0.04266638729742811  0.0
              0.0   0.001530966614635904   0.9984690333853641   0.0
              0.0  -0.024850868798286345   0.02485086879828634  1.0]

    euExpected = [1.0
             1.0]

G1, CC, impact, fmat, fwt, ywt, gev, eu =
        gensysToAMA(g0, g1, cc, psi, pi, div, "ama")
    
    isapprox(G1, G1Expected)&&
    isapprox(CC, CCExpected)&&
    isapprox(impact, impactExpected)&&
    isapprox(fmat, fmatExpected)&&
    isapprox(fwt, fwtExpected)&&
    isapprox(ywt, ywtExpected)&&
    gev == nothing 
    isapprox(eu, euExpected)

end # example1

function example1()::Bool

    #inputs

    g0 = [1.0                 0.0                  0.0                   0.0    0.0    0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0    0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  1.0                   0.0    0.0    0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   1.0    0.0    0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    1.0    0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    0.0    1.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -0.9186835303110215   1.236689367726376     0.0    0.0   -0.31800583741535454  0.0   0.0  0.0  0.0  0.0  0.0
          -12.720233496614181   0.0                  0.0                   0.0    0.0    0.31800583741535454  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                 -1.0                   0.64   0.0    0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -1.0                  1.0                  -1.0    0.0    0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.03499999999999992   0.0   -1.01   0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0    0.0                  0.0  -1.0  0.0  0.0  1.0  0.0]

    g1 = [0.0                  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -12.402227659198827    0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -0.36                 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.03499999999999992  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]

    cc = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    psi = hcat([0.0
           0.0
           0.0
           0.0
           0.0
           0.0
           0.0
           0.0
           -1.0
           0.0
           0.0
           0.0])

    pi = [1.0  0.0  0.0  0.0  0.0  0.0
          0.0  1.0  0.0  0.0  0.0  0.0
          0.0  0.0  1.0  0.0  0.0  0.0
          0.0  0.0  0.0  1.0  0.0  0.0
          0.0  0.0  0.0  0.0  1.0  0.0
          0.0  0.0  0.0  0.0  0.0  1.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0]

    div = 1.0
    

    #outputs
    G1Expected = [0.9419689119170994     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -2.3250500477021648e-17   0.0  -5.551115123125783e-18 
          0.5315122486002497    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.4945309946877118e-16  -0.0   3.557510805994681e-17 
          0.05508933582177797   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.2812570244399327e-16  -0.0  -3.0669960993333426e-17
          -0.47642291277847176   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -2.220446049250313e-16   -0.0  -4.5443637657830695e-17
          -0.03274442895667099    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -4.439999589643322e-18    0.0  -1.0628204304620472e-18
          -1.3212435233160251    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -9.300200190808659e-16   -0.0  -2.220446049250313e-16 
          0.887305431018286     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -2.4137583884318616e-17  -0.0  -6.464726791730622e-18 
          0.5006680144845884     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   3.8120831875083806e-17   0.0   8.918149264412452e-18 
          0.05189244172227664    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.202915566943913e-16    0.0   2.754826203194723e-17 
          -0.4487755727623123     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.4138916486074082e-16   0.0   3.284340508432851e-17 
          -0.030844234115661236  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.1133226759368738e-16  -0.0  -2.665695879553436e-17 
          -1.2445703240355097     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   4.352028836783191e-16    0.0   1.00539862295694e-16]

    CCExpected = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    impactExpected = [0.23725469140111116 
              0.13387254390478348 
              2.539782144169273   
              2.40590960026449    
              0.0880122525207172  
              9.490187656044446   
              0.22348654350633185 
              0.12610377451756288 
              0.013070203369888149
              -0.11303357114767475 
              -0.007768769387220582
              -0.3134712243900602]

    fmatExpected = [0.0  -0.21529168568283683   0.0  -3.418132239061542e-17    0.21529168568283683   -8.032496523911658e-18 
               0.0   0.8785202287309737    0.0   1.3948045912543356e-16  -0.8785202287309737     3.27774417348537e-17  
               0.0  -1.561813739966175     0.0  -2.479652606674374e-16    1.561813739966175     -5.827100752862878e-17 
               0.0  -2.4403339686971486    0.0  -3.874457197928709e-16    2.4403339686971486    -9.104844926348248e-17 
               0.0  -0.054122258315659415  0.0  -8.592855567683456e-18    0.054122258315659415  -2.0192923401009933e-18
               0.0  -8.611667427313472     0.0  -1.3672528956246167e-15   8.611667427313472     -3.212998609564663e-16]

    fwtExpected = [0.23725469140111116
           0.13387254390478348
           2.539782144169273  
           2.40590960026449   
           0.0880122525207172 
           9.490187656044446]

    ywtExpected = [0.0  -0.21529168568283683   0.0  -3.418132239061542e-17    0.21529168568283683   -8.032496523911658e-18 
           0.0   0.8785202287309737    0.0   1.3948045912543356e-16  -0.8785202287309737     3.27774417348537e-17  
           0.0  -1.561813739966175     0.0  -2.479652606674374e-16    1.561813739966175     -5.827100752862878e-17 
           0.0  -2.4403339686971486    0.0  -3.874457197928709e-16    2.4403339686971486    -9.104844926348248e-17 
           0.0  -0.054122258315659415  0.0  -8.592855567683456e-18    0.054122258315659415  -2.0192923401009933e-18
           0.0  -8.611667427313472     0.0  -1.3672528956246167e-15   8.611667427313472     -3.212998609564663e-16 
           1.0  -0.20279807490745994   0.0  -5.544824353719722e-17    0.20279807490745994   -1.4505255914514172e-17
           0.0   0.8855698320377773    0.0   1.3128530794480508e-16   0.11443016796222275    3.130573777064882e-17 
           0.0  -0.0118602759722185    1.0  -1.1290532881052468e-16   0.0118602759722185    -2.9526432999504664e-17
           0.0   0.10256989199000427   0.0   0.9999999999999998      -0.10256989199000427   -4.1616772267025734e-17
           0.0   0.007049603306803598  0.0  -8.195151180628497e-18    0.9929503966931964    -1.471703964204878e-18 
           0.0   0.2844527453322374    0.0  -8.848581682538879e-16   -0.2844527453322374     0.9999999999999998]

    euExpected = [1.0
          1.0]

G1, CC, impact, fmat, fwt, ywt, gev, eu =
        gensysToAMA(g0, g1, cc, psi, pi, div, "ama")


    isapprox(G1, G1Expected)&&
    isapprox(CC, CCExpected)&&
    isapprox(impact, impactExpected)&&
    isapprox(fmat, fmatExpected)&&
    isapprox(fwt, fwtExpected)&&
    isapprox(ywt, ywtExpected)&&
    gev == nothing &&
    isapprox(eu, euExpected)

end # example1

function example2()::Bool


    # inputs
    g0 = [1.0                 0.0                  0.0                   0.0    0.0      0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0      0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  1.0                   0.0    0.0      0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   1.0    0.0      0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    1.0      0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    0.0      1.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -0.8289277290101181   1.010255669731082     0.0    0.0     -0.18132794072096392  0.0   0.0  0.0  0.0  0.0  0.0
          -7.253117628838557   0.0                  0.0                   0.0    0.0      0.18132794072096392  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                 -1.0                   0.64   0.0      0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -1.0                  1.0                  -1.0    0.0      0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.03509999999999991   0.0   -1.0101   0.0                  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0      0.0                  0.0  -1.0  0.0  0.0  1.0  0.0]

    g1 = [0.0                  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -7.071789688117593    0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -0.36                 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.03509999999999991  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]
    

    cc = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    psi = hcat([0.0
           0.0
           0.0
           0.0
           0.0
           0.0
           0.0
           0.0
           -1.0
           0.0
           0.0
           0.0])

    pi = [1.0  0.0  0.0  0.0  0.0  0.0
          0.0  1.0  0.0  0.0  0.0  0.0
          0.0  0.0  1.0  0.0  0.0  0.0
          0.0  0.0  0.0  1.0  0.0  0.0
          0.0  0.0  0.0  0.0  1.0  0.0
          0.0  0.0  0.0  0.0  0.0  1.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0]

    div = 1.0
    

    #outputs
    G1Expected = [0.9418181818181816     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                      0.0   0.0
             0.4765550239234458    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.3530843112619103e-16  -0.0  -0.0
             0.15279106858054084   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.1102230246251565e-16  -0.0  -0.0
             -0.32376395534290486   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.1102230246251565e-16  -0.0  -0.0
             -0.029439692597587306   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   3.857917846187793e-18    0.0   0.0
             -1.327272727272734     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0                     -0.0  -0.0
             0.887021487603306     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -2.2823297945278037e-18  -0.0  -0.0
             0.4488281861678999     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   4.390701741152563e-17    0.0   0.0
             0.1439014064085822     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   5.899062967749744e-17    0.0   0.0
             -0.3049267797593177    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.1891636787844084e-16  -0.0  -0.0
             -0.027726837755545932  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -9.14014137146654e-17    -0.0  -0.0
             -1.2500495867768653    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   3.4175487942329622e-16  -0.0  -0.0]

    CCExpected = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    impactExpected = [0.3270202020202012  
                 0.16547049441786268 
                 2.4836080099238     
                 2.318137515505937   
                 0.08630298103982292 
                 13.08080808080805    
                 0.3079935720844803  
                 0.15584312019718705 
                 0.04996576611409088 
                 -0.10587735408309616 
                 -0.009627374220675632
                 -0.4340449954086329]

    fmatExpected = [0.0   -0.30588966588966504  0.0  -4.138945078924533e-17    0.30588966588966504  0.0
               0.0    0.8452214452214454   0.0   1.1436558770712562e-16  -0.8452214452214454   0.0
               0.0   -1.502615902615903    0.0  -2.033166003682233e-16    1.502615902615903    0.0
               0.0   -2.3478373478373484   0.0  -3.176821880753489e-16    2.3478373478373484   0.0
               0.0   -0.05221445221445208  0.0  -7.065055611250983e-18    0.05221445221445208  0.0
               0.0  -12.235586635586603    0.0  -1.6555780315698136e-15  12.235586635586603    0.0]

    fwtExpected = [0.3270202020202012 
              0.16547049441786268
              2.4836080099238    
              2.318137515505937  
              0.08630298103982292
              13.08080808080805 ]

    ywtExpected = [0.0   -0.30588966588966504   0.0  -4.138945078924533e-17    0.30588966588966504  0.0
              0.0    0.8452214452214454    0.0   1.1436558770712562e-16  -0.8452214452214454   0.0
              0.0   -1.502615902615903     0.0  -2.033166003682233e-16    1.502615902615903    0.0
              0.0   -2.3478373478373484    0.0  -3.176821880753489e-16    2.3478373478373484   0.0
              0.0   -0.05221445221445208   0.0  -7.065055611250983e-18    0.05221445221445208  0.0
              0.0  -12.235586635586603     0.0  -1.6555780315698136e-15  12.235586635586603    0.0
              1.0   -0.2880924489651754    0.0  -3.8981337288780145e-17   0.2880924489651754   0.0
              0.0    0.8542267429540158    0.0   1.1558408041514394e-16   0.14577325704598418  0.0
              0.0   -0.04673720891902654   1.0   1.0469836404846517e-16   0.04673720891902654  0.0
              0.0    0.09903604812695763   0.0   1.0000000000000002      -0.09903604812695763  0.0
              0.0    0.009005297732570416  0.0   1.2184927080183487e-18   0.9909947022674296   0.0
              0.0    0.40599901108992115   0.0   5.493508922936227e-17   -0.40599901108992115  1.0]

    euExpected = [1.0
          1.0]
    
G1, CC, impact, fmat, fwt, ywt, gev, eu =
        gensysToAMA(g0, g1, cc, psi, pi, div, "ama")

    
    
    isapprox(G1, G1Expected)&&
    isapprox(CC, CCExpected)&&
    isapprox(impact, impactExpected)&&
    isapprox(fmat, fmatExpected)&&
    isapprox(fwt, fwtExpected)&&
    isapprox(ywt, ywtExpected)&&
    gev == nothing &&
    isapprox(eu, euExpected)

end # example2

function example3()::Bool

    # inputs
    g0 = [1.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  1.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  1.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  1.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  1.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 1.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 1.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  1.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  1.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  1.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    1.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    1.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  1.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  1.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          -0.14171694192589385  0.0  0.0  0.0  0.0                 0.0                 0.0                 -0.2618316458805873   0.4035485878064812   0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                 -4.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                 -1.0                  0.36   0.64   0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  1.0                  0.0   -1.0    1.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.9802960494069208  0.9705901479276444  0.9609803444828162   0.0                  0.0                  0.0    0.0   -3.9019655517183747   0.0  0.9900990099009901  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  1.0                 -1.0    0.0    1.0                 -1.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  1.0                  0.0                  0.0    0.0    1.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  1.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  1.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  1.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  1.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  -1.0   0.0
          0.0                  0.0  0.0  0.0  1.0                 0.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  -1.0
          0.0                  0.0  0.0  0.0  0.0                 1.0                 0.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0  -1.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0
          0.0                  0.0  0.0  0.0  0.0                 0.0                 1.0                  0.0                  0.0                  0.0    0.0    0.0                  0.0  0.0                 0.0  0.0  0.0  0.0   0.0  -1.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0]


    g1 = [0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -1.0  -1.0  -1.0  -1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          1.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   1.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   1.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]


    cc = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    psi = hcat([0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                -1.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0])

    pi = [1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]

    div = 1.0
    

    #outputs
    G1Expected = [-0.2630891961261847      -0.15835658265531274      0.009683940391574523     0.2793002179775845       0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -0.0                     -1.7506669351828688e-16   0.0  -0.0                      0.0  -1.7506669351828688e-16   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             1.0                     -0.0                     -0.0                     -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0                     -0.0                     -0.0  -0.0                     -0.0  -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.0                      1.0                     -0.0                     -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0                     -0.0                     -0.0  -0.0                     -0.0  -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.0                     -0.0                      1.0                     -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0                     -0.0                     -0.0  -0.0                     -0.0  -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.15531016347543866     -0.13862672322755606     -0.11185861411075886     -0.06890993835548744     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.090240221423151e-17   -8.265338241933985e-18   -0.0   5.233378878866249e-18   -0.0  -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.09776629716857636     -0.08726422737115057     -0.07041395272078921     -0.04337816251282428     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   7.962089975032246e-18   -3.838345468932013e-18   -0.0   4.127151103464314e-18   -0.0  -0.0                     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.06154297084083591     -0.0549320160023097      -0.0443249255069097      -0.027306148110044576    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   6.1842510797789435e-18  -1.0424310688205341e-18  -0.0   3.361277730336205e-18   -0.0  -7.143528565969357e-17   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             0.1410989550506773       0.1259420848694229       0.10162331434890966      0.06260453325775761     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.1568369657399869e-18   1.6035303314628935e-17  -0.0  -6.085956809009309e-19   -0.0   4.681031506983466e-18   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.0008425867567596335    0.026102960232137068     0.06933633004638284      0.1387030519862087      -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   2.05659905020442e-18    -2.8507205892673655e-17  -0.0   1.0819478771572117e-18  -0.0  -8.321833790192816e-18   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             0.25                     0.25                     0.25                     0.25                     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                      0.0                      0.0   0.0                      0.0   0.0                      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.14194154180743693     -0.09983912463728582     -0.0322869843025268       0.07609851872845108     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   3.213436015944406e-18   -4.4542509207302584e-17  -0.0   1.6905435580581434e-18  -0.0  -1.3002865297176276e-17  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.14109895505067732     -0.1259420848694229      -0.10162331434890966     -0.06260453325775761      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.1568369657399823e-18  -1.6035303314628938e-17   0.0   6.085956809009305e-19    0.0  -1.040540087154674e-17    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.3919415418074369      -0.34983912463728584     -0.2822869843025268      -0.17390148127154892     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   3.213436015944407e-18   -4.454250920730259e-17   -0.0   1.6905435580581428e-18  -0.0  -1.3002865297176285e-17  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.24672353947470954     -0.22022046114124744     -0.1776970197993941      -0.10946935806128759     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -2.0042958786579337e-17  -5.023690172190843e-17   -0.0  -1.0091349642328601e-17  -0.0   7.112499457701912e-17   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             -0.08914065753699207      0.051345846423651045     0.27675247788463037     -0.0734808698255911       0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                      1.7474072756564102e-16   0.0  -5.9536541715407184e-18   0.0   1.7636637715138549e-16   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.2630891961261846      -0.15835658265531297      0.009683940391574317     0.27930021797758453      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                     -1.7291998278247961e-16   0.0  -5.403749461952488e-18    0.0  -2.0784204576518245e-16   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             1.0                      1.8509874114421848e-16   1.0238524672099801e-16  -1.7836565319549014e-17   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -1.8929746481662295e-18   3.238758173624042e-17    0.0   1.8815318870916885e-19   0.0   9.356986987524646e-18    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             1.6673904545329703e-16   1.0000000000000007       1.0321940909013626e-16  -1.0123442045378749e-16   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   3.4571501025262012e-18  -4.410804065478992e-17    0.0  -2.7087130048837765e-18   0.0  -2.6028310232428452e-17   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.09776629716857636     -0.08726422737115057     -0.07041395272078921     -0.04337816251282428      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   7.962089975032246e-18   -3.838345468932013e-18    0.0   4.127151103464314e-18    0.0   0.0                      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.06154297084083591     -0.0549320160023097      -0.0443249255069097      -0.027306148110044576     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   6.1842510797789435e-18  -1.0424310688205341e-18   0.0   3.361277730336205e-18    0.0  -7.143528565969357e-17    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.03874072527657677     -0.03457919095809943     -0.027902126571187645    -0.01718896517083358     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   4.206210344266463e-18    3.1872820708294933e-18  -0.0   3.0306442212593827e-18  -0.0   1.1412056552960718e-16  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0
             0.08882047421089526      0.07927936601084921      0.06397092712778175      0.03940896890206358      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -9.934830785722095e-18    5.756649325096702e-17    0.0   0.0                      0.0   1.8597901209713605e-17   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             0.02632463570463945      0.06946975920577347      0.13869489242628136     -0.00023533466482793272   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -2.413379531064294e-17    7.831740687686102e-18    0.0   0.0                      0.0   1.598276799916452e-17    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             0.18422770096845395      0.21041085433617132      0.2524209850978938       0.0698250544943962       0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                     -1.0564138111884825e-16   0.0   0.0                      0.0  -5.2820690559424125e-17   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.06249583850625593     -0.009809606805075496     0.07472396529849963     -0.03964430356689139      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -2.131768657248474e-17    2.3997116384633743e-19   0.0  -1.0545916679233942e-17   0.0   7.49547033920723e-17     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.08882047421089508     -0.07927936601084852     -0.06397092712778145     -0.039408968902063475     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -3.317160255817993e-19    1.3065954735274866e-17   0.0  -1.8198819315486819e-19   0.0   1.9422206431082984e-17   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.24672353947470954     -0.22022046114124744     -0.1776970197993941      -0.10946935806128759      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -2.0042958786579337e-17  -5.023690172190843e-17    0.0  -1.0091349642328601e-17   0.0   7.112499457701912e-17    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
             -0.15531016347543866     -0.13862672322755606     -0.11185861411075886     -0.06890993835548744      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.090240221423151e-17   -8.265338241933985e-18    0.0   5.233378878866249e-18    0.0   0.0                      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0]


    CCExpected = [0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0]

    impactExpected = [3.1033357553064906   
                 0.0                  
                 0.0                  
                 0.0                  
                 -0.7656659817276388   
                 -0.48197958347582504  
                 -0.30340164566716277  
                 0.6956059250861959   
                 1.5411450220689846   
                 0.0                  
                 0.8455390969827893   
                 -0.6956059250861959   
                 0.8455390969827892   
                 -1.216326200680973    
                 -0.8164541091732314   
                 3.1033357553064906   
                 0.0                  
                 0.0                  
                 -0.48197958347582504  
                 -0.30340164566716277  
                 -0.19098850189815086  
                 0.4378774322451503   
                 -0.0026148296091999916
                 0.7758339388266227   
                 -0.4404922618543502   
                 -0.4378774322451503   
                 -1.216326200680973    
                 -0.7656659817276388]

    fmatExpected = [1.2275081773273108e-18  -7.299295409724637e-17   0.0   5.74492910184676e-19     0.6743448794800602    0.66766819750501     0.0  0.0  0.0  0.0  0.0  0.0   0.6878992115576097    0.6810883282748608 
               0.0                      0.0                     0.0   0.0                      0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0   0.0                   0.0                
               0.0                      0.0                     0.0   0.0                      0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0   0.0                   0.0                
               0.0                      0.0                     0.0   0.0                      0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0   0.0                   0.0                
               -2.034581394882368e-17   -3.222782173032079e-17   0.0  -1.0233090566532491e-17  -0.16637675549196695  -0.16472946088313553  0.0  0.0  0.0  0.0  0.0  0.0  -0.1697209282773554    0.8319594769531133 
               1.0711757718543366e-17   3.071209391464536e-18   0.0   5.1441542910699865e-18   0.8952673865291269   -0.1036956569018546   0.0  0.0  0.0  0.0  0.0  0.0  -0.10683773900163768  -0.10577993960558188
               7.842081045790808e-18    3.297905372551628e-18   0.0   4.070985058885959e-18   -0.06592820188135538   0.9347245525927175   0.0  0.0  0.0  0.0  0.0  0.0  -0.06725335873917064  -0.06658748390016894
               -1.7764458914560202e-19   1.0563516871522702e-17  0.0  -8.314042943406428e-20   -0.09759097435791127  -0.09662472708704085  0.0  0.0  0.0  0.0  0.0  0.0  -0.09955255294250515  -0.09856688410149037
               3.158126029255149e-19   -1.8779585549373696e-17  0.0   1.478052078827812e-19    0.17349506552517546   0.17177729259918362  0.0  0.0  0.0  0.0  0.0  0.0   0.17698231634223166   0.17523001618042722
               0.0                      0.0                     0.0   0.0                      0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0   0.0                   0.0                
               4.934571920711159e-19   -2.9343102420896395e-17  0.0   2.309456373168448e-19    0.27108603988308677   0.26840201968622457  0.0  0.0  0.0  0.0  0.0  0.0   0.2765348692847366    0.27379690028191767
               1.776445891456022e-19   -1.0563516871522705e-17  0.0   8.314042943406424e-20    0.09759097435791125   0.09662472708704084  0.0  0.0  0.0  0.0  0.0  0.0   0.09955255294250523   0.09856688410149035
               4.934571920711143e-19   -2.9343102420896395e-17  0.0   2.3094563731684405e-19   0.27108603988308677   0.26840201968622457  0.0  0.0  0.0  0.0  0.0  0.0   0.27653486928473664   0.2737969002819177 
               2.7323245683415063e-18  -1.593353823734838e-17   0.0   1.4653759210829196e-18  -0.26430377177336506  -0.261686902745906    0.0  0.0  0.0  0.0  0.0  0.0   0.7303837224139903   -0.2669468094910987]

    fwtExpected = [3.1033357553064906 
              0.0                
              0.0                
              0.0                
              -0.7656659817276388 
              -0.48197958347582504
              -0.30340164566716277
              0.6956059250861959 
              1.5411450220689846 
              0.0                
              0.8455390969827893 
              -0.6956059250861959 
              0.8455390969827892 
              -1.216326200680973]

    ywtExpected = [1.2275081773273108e-18  -7.299295409724637e-17   0.0   5.74492910184676e-19     0.6743448794800602     0.66766819750501       0.0  0.0  0.0  0.0  0.0  0.0   0.6878992115576097      0.6810883282748608   
              0.0                      0.0                     0.0   0.0                      0.0                    0.0                    0.0  0.0  0.0  0.0  0.0  0.0   0.0                     0.0                  
              0.0                      0.0                     0.0   0.0                      0.0                    0.0                    0.0  0.0  0.0  0.0  0.0  0.0   0.0                     0.0                  
              0.0                      0.0                     0.0   0.0                      0.0                    0.0                    0.0  0.0  0.0  0.0  0.0  0.0   0.0                     0.0                  
              -2.034581394882368e-17   -3.222782173032079e-17   0.0  -1.0233090566532491e-17  -0.16637675549196695   -0.16472946088313553    0.0  0.0  0.0  0.0  0.0  0.0  -0.1697209282773554      0.8319594769531133   
              1.0711757718543366e-17   3.071209391464536e-18   0.0   5.1441542910699865e-18   0.8952673865291269    -0.1036956569018546     0.0  0.0  0.0  0.0  0.0  0.0  -0.10683773900163768    -0.10577993960558188  
              7.842081045790808e-18    3.297905372551628e-18   0.0   4.070985058885959e-18   -0.06592820188135538    0.9347245525927175     0.0  0.0  0.0  0.0  0.0  0.0  -0.06725335873917064    -0.06658748390016894  
              -1.7764458914560202e-19   1.0563516871522702e-17  0.0  -8.314042943406428e-20   -0.09759097435791127   -0.09662472708704085    0.0  0.0  0.0  0.0  0.0  0.0  -0.09955255294250515    -0.09856688410149037  
              3.158126029255149e-19   -1.8779585549373696e-17  0.0   1.478052078827812e-19    0.17349506552517546    0.17177729259918362    0.0  0.0  0.0  0.0  0.0  0.0   0.17698231634223166     0.17523001618042722  
              0.0                      0.0                     0.0   0.0                      0.0                    0.0                    0.0  0.0  0.0  0.0  0.0  0.0   0.0                     0.0                  
              4.934571920711159e-19   -2.9343102420896395e-17  0.0   2.309456373168448e-19    0.27108603988308677    0.26840201968622457    0.0  0.0  0.0  0.0  0.0  0.0   0.2765348692847366      0.27379690028191767  
              1.7764458914560202e-19  -1.0563516871522702e-17  0.0   8.314042943406428e-20    0.09759097435791127    0.09662472708704085    0.0  0.0  0.0  0.0  0.0  0.0   0.09955255294250515     0.09856688410149037  
              4.934571920711143e-19   -2.9343102420896395e-17  0.0   2.3094563731684405e-19   0.27108603988308677    0.26840201968622457    0.0  0.0  0.0  0.0  0.0  0.0   0.27653486928473664     0.2737969002819177   
              2.7323245683415063e-18  -1.593353823734838e-17   0.0   1.4653759210829196e-18  -0.26430377177336506   -0.261686902745906      0.0  0.0  0.0  0.0  0.0  0.0   0.7303837224139903     -0.2669468094910987   
              1.0                     -1.5586303590196682e-16  0.0  -1.5114287792067948e-19  -0.17741285225421807   -0.17565628936061212    0.0  0.0  0.0  0.0  0.0  0.0  -0.1809788505845279     -0.17918698077676026  
              1.2275081773273108e-18   1.0                     0.0   5.74492910184676e-19     0.6743448794800602     0.66766819750501       0.0  0.0  0.0  0.0  0.0  0.0   0.6878992115576097      0.6810883282748608   
              0.0                      0.0                     1.0   0.0                      0.0                    0.0                    0.0  0.0  0.0  0.0  0.0  0.0   0.0                     0.0                  
              0.0                      0.0                     0.0   1.0                      0.0                    0.0                    0.0  0.0  0.0  0.0  0.0  0.0   0.0                     0.0                  
              1.0711757718543366e-17   3.071209391464536e-18   0.0   5.1441542910699865e-18   0.8952673865291269    -0.1036956569018546     0.0  0.0  0.0  0.0  0.0  0.0  -0.10683773900163768    -0.10577993960558188  
              7.842081045790808e-18    3.297905372551628e-18   0.0   4.070985058885959e-18   -0.06592820188135538    0.9347245525927175     0.0  0.0  0.0  0.0  0.0  0.0  -0.06725335873917064    -0.06658748390016894  
              6.108706579814801e-18    3.449772176772772e-18   0.0   3.3259217299164425e-18  -0.041501187254508354  -0.04109028441040438    1.0  0.0  0.0  0.0  0.0  0.0  -0.042335361118323964   -0.04191619912705344  
              -9.836368446029418e-19    5.736073765445418e-18   0.0  -5.275353315898504e-19    0.09514935783841144    0.0942072849885262     0.0  1.0  0.0  0.0  0.0  0.0   0.0970618599309635      0.09610085141679556  
              2.0555647680703897e-18  -2.8445702996214546e-17  0.0   1.0814638170392376e-18  -0.000568194064938589  -0.0005625683811273242  0.0  0.0  1.0  0.0  0.0  0.0  -0.0005796147656438548  -0.0005738760055879749
              3.068770443318277e-19   -1.8248238524311592e-17  0.0   1.43623227546169e-19     0.16858621987001504    0.1669170493762525     0.0  0.0  0.0  1.0  0.0  0.0   0.17197480288940242     0.1702720820687152   
              3.0392016126733305e-18  -3.4181776761659955e-17  0.0   1.6089991486290892e-18  -0.09571755190335      -0.09476985336965349    0.0  0.0  0.0  0.0  1.0  0.0  -0.09764147469660742    -0.09667472742238352  
              9.836368446029418e-19   -5.736073765445418e-18   0.0   5.275353315898504e-19   -0.09514935783841144   -0.0942072849885262     0.0  0.0  0.0  0.0  0.0  1.0  -0.0970618599309635     -0.09610085141679556  
              2.7323245683415063e-18  -1.593353823734838e-17   0.0   1.4653759210829196e-18  -0.26430377177336506   -0.261686902745906      0.0  0.0  0.0  0.0  0.0  0.0   0.7303837224139903     -0.2669468094910987   
              -2.034581394882368e-17   -3.222782173032079e-17   0.0  -1.0233090566532491e-17  -0.16637675549196695   -0.16472946088313553    0.0  0.0  0.0  0.0  0.0  0.0  -0.1697209282773554      0.8319594769531133]
    

    euExpected = [1.0
             1.0]
    
G1, CC, impact, fmat, fwt, ywt, gev, eu =
        gensysToAMA(g0, g1, cc, psi, pi, div, "ama")

    isapprox(G1, G1Expected)&&
    isapprox(CC, CCExpected)&&
    isapprox(impact, impactExpected)&&
    isapprox(fmat, fmatExpected)&&
    isapprox(fwt, fwtExpected)&&
    isapprox(ywt, ywtExpected)&&
    gev == nothing &&
    isapprox(eu, euExpected)

end # example3

function example4()::Bool

    
    #inputs
    g0 = [1.0                 0.0                  0.0                   0.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  1.0                   0.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   1.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    1.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    0.0                  1.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -0.9181091577121749   1.2346862705301118    0.0    0.0                 -0.3165771128179368  0.0   0.0  0.0  0.0  0.0  0.0
          -12.663084512717472   0.0                  0.0                   0.0    0.0                  0.3165771128179368  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                 -1.0                   0.64   0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -1.0                  1.0                  -1.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.03510101010101008   0.0   -1.0101010101010102   0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0                  0.0                 0.0  -1.0  0.0  0.0  1.0  0.0]

    g1 = [0.0                  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -12.346507399899535    0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -0.36                 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.03510101010101008  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]

    cc = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    psi = hcat([0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                -1.0
                0.0
                0.0
                0.0])
    
    pi = [1.0  0.0  0.0  0.0  0.0  0.0
          0.0  1.0  0.0  0.0  0.0  0.0
          0.0  0.0  1.0  0.0  0.0  0.0
          0.0  0.0  0.0  1.0  0.0  0.0
          0.0  0.0  0.0  0.0  1.0  0.0
          0.0  0.0  0.0  0.0  0.0  1.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0]

    div = 1.0
    
    


    # outputs
    G1Expected = [0.9418166596902483     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   2.2623298503861943e-17   0.0   0.0
             0.5315878086354362    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.4930437347416488e-16  -0.0  -0.0
             0.05495500687033572   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.2100485111378367e-16  -0.0  -0.0
             -0.47663280176510037   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   2.220446049250313e-16   -0.0  -0.0
             -0.032840313511255805   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   4.20491857620398e-18     0.0   0.0
             -1.3273336123900663    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   9.049319401544776e-16   -0.0  -0.0
             0.887018620470096     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.1633898075369503e-17  -0.0  -0.0
             0.5006582542610848     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -3.1465171135877246e-17   0.0   0.0
             0.05175754100387436    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -1.305525018744484e-16    0.0   0.0
             -0.4489007132572109     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -1.4454296039418525e-16   0.0   0.0
             -0.03092955437435136    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.1783920233828763e-16   0.0   0.0
             -1.2501049091158032    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -4.2163529747387874e-16  -0.0  -0.0]

    CCExpected = [0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0]

    impactExpected = [0.23783871189302316 
                 0.13424285752756718 
                 2.5391238088398804  
                 2.4048809513123133  
                 0.08823455235718577 
                 9.513548475720926   
                 0.2240004611801184  
                 0.12643215966388704 
                 0.013070428046112874
                 -0.11336173161777416 
                 -0.007810697863680123
                 -0.3156913166231668]

    fmatExpected = [0.0  -0.2158850010363883  0.0   3.4208891655742405e-17   0.2158850010363883  0.0
               0.0   0.8781484342653947  0.0  -1.391504018400114e-16   -0.8781484342653947  0.0
               0.0  -1.5611527720273684  0.0   2.473784921600203e-16    1.5611527720273684  0.0
               0.0  -2.439301206292763   0.0   3.8652889400003173e-16   2.439301206292763   0.0
               0.0  -0.054250058827951   0.0   8.5964026025607e-18      0.054250058827951   0.0
               0.0  -8.635400041455531   0.0   1.3683556662296961e-15   8.635400041455531   0.0]

    fwtExpected = [0.23783871189302316
              0.13424285752756718
              2.5391238088398804 
              2.4048809513123133 
              0.08823455235718577
              9.513548475720926 ]

    ywtExpected = [0.0  -0.2158850010363883    0.0   3.4208891655742405e-17   0.2158850010363883    0.0
              0.0   0.8781484342653947    0.0  -1.391504018400114e-16   -0.8781484342653947    0.0
              0.0  -1.5611527720273684    0.0   2.473784921600203e-16    1.5611527720273684    0.0
              0.0  -2.439301206292763     0.0   3.8652889400003173e-16   2.439301206292763     0.0
              0.0  -0.054250058827951     0.0   8.5964026025607e-18      0.054250058827951     0.0
              0.0  -8.635400041455531     0.0   1.3683556662296961e-15   8.635400041455531     0.0
              1.0  -0.20332409055331702   0.0   5.4841802574778865e-17   0.20332409055331702   0.0
              0.0   0.8852381653818074    0.0  -1.3111934372304173e-16   0.11476183461819253   0.0
              0.0  -0.011863961715157143  1.0   1.1290225233848357e-16   0.011863961715157143  0.0
              0.0   0.10289787290303537   0.0   1.0000000000000002      -0.10289787290303537   0.0
              0.0   0.007089731116412756  0.0   8.031058116969694e-18    0.9929102688835872    0.0
              0.0   0.28655141828646263   0.0   8.595253284172008e-16   -0.28655141828646263   1.0]

    euExpected = [1.0
             1.0]
    
G1, CC, impact, fmat, fwt, ywt, gev, eu =
        gensysToAMA(g0, g1, cc, psi, pi, div, "ama")


    
    isapprox(G1, G1Expected)&&
    isapprox(CC, CCExpected)&&
    isapprox(impact, impactExpected)&&
    isapprox(fmat, fmatExpected)&&
    isapprox(fwt, fwtExpected)&&
    isapprox(ywt, ywtExpected)&&
    gev == nothing &&
    isapprox(eu, euExpected)

end # example4

function example5()::Bool

    # inputs
    g0 = [ 1.0                 0.0                  0.0                   0.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  1.0                   0.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   1.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    1.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.0                   0.0    0.0                  1.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -0.9181091577121749   1.2346862705301118    0.0    0.0                 -0.3165771128179368  0.0   0.0  0.0  0.0  0.0  0.0
          -12.663084512717472   0.0                  0.0                   0.0    0.0                  0.3165771128179368  0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                 -1.0                   0.64   0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                -1.0                  1.0                  -1.0    0.0                  0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 0.0                  0.03510101010101008   0.0   -1.0101010101010102   0.0                 0.0   0.0  0.0  0.0  0.0  0.0
          0.0                 1.0                  0.0                   0.0    0.0                  0.0                 0.0  -1.0  0.0  0.0  1.0  0.0]

    g1 = [0.0                  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -12.346507399899535    0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -0.36                 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.03510101010101008  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]

    cc = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    psi = hcat([0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                0.0
                -1.0
                0.0
                0.0
                0.0])
    
    pi = [1.0  0.0  0.0  0.0  0.0  0.0
          0.0  1.0  0.0  0.0  0.0  0.0
          0.0  0.0  1.0  0.0  0.0  0.0
          0.0  0.0  0.0  1.0  0.0  0.0
          0.0  0.0  0.0  0.0  1.0  0.0
          0.0  0.0  0.0  0.0  0.0  1.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0]

    div = 1.0
    
    # output
    G1Expected = [0.9418166596902483     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   2.2623298503861943e-17   0.0   0.0
  0.5315878086354362    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.4930437347416488e-16  -0.0  -0.0
  0.05495500687033572   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.2100485111378367e-16  -0.0  -0.0
 -0.47663280176510037   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   2.220446049250313e-16   -0.0  -0.0
 -0.032840313511255805   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   4.20491857620398e-18     0.0   0.0
 -1.3273336123900663    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   9.049319401544776e-16   -0.0  -0.0
  0.887018620470096     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.1633898075369503e-17  -0.0  -0.0
  0.5006582542610848     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -3.1465171135877246e-17   0.0   0.0
  0.05175754100387436    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -1.305525018744484e-16    0.0   0.0
 -0.4489007132572109     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -1.4454296039418525e-16   0.0   0.0
 -0.03092955437435136    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.1783920233828763e-16   0.0   0.0
 -1.2501049091158032    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -4.2163529747387874e-16  -0.0  -0.0]


    CCExpected = [0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0]

    impactExpected = [0.23783871189302316 
  0.13424285752756718 
  2.5391238088398804  
  2.4048809513123133  
  0.08823455235718577 
  9.513548475720926   
  0.2240004611801184  
  0.12643215966388704 
  0.013070428046112874
 -0.11336173161777416 
 -0.007810697863680123
 -0.3156913166231668]

    fmatExpected = [0.0  -0.2158850010363883  0.0   3.4208891655742405e-17   0.2158850010363883  0.0
 0.0   0.8781484342653947  0.0  -1.391504018400114e-16   -0.8781484342653947  0.0
 0.0  -1.5611527720273684  0.0   2.473784921600203e-16    1.5611527720273684  0.0
 0.0  -2.439301206292763   0.0   3.8652889400003173e-16   2.439301206292763   0.0
 0.0  -0.054250058827951   0.0   8.5964026025607e-18      0.054250058827951   0.0
 0.0  -8.635400041455531   0.0   1.3683556662296961e-15   8.635400041455531   0.0]

    fwtExpected = [0.23783871189302316
 0.13424285752756718
 2.5391238088398804 
 2.4048809513123133 
 0.08823455235718577
 9.513548475720926 ]

    ywtExpected = [0.0  -0.2158850010363883    0.0   3.4208891655742405e-17   0.2158850010363883    0.0
 0.0   0.8781484342653947    0.0  -1.391504018400114e-16   -0.8781484342653947    0.0
 0.0  -1.5611527720273684    0.0   2.473784921600203e-16    1.5611527720273684    0.0
 0.0  -2.439301206292763     0.0   3.8652889400003173e-16   2.439301206292763     0.0
 0.0  -0.054250058827951     0.0   8.5964026025607e-18      0.054250058827951     0.0
 0.0  -8.635400041455531     0.0   1.3683556662296961e-15   8.635400041455531     0.0
 1.0  -0.20332409055331702   0.0   5.4841802574778865e-17   0.20332409055331702   0.0
 0.0   0.8852381653818074    0.0  -1.3111934372304173e-16   0.11476183461819253   0.0
 0.0  -0.011863961715157143  1.0   1.1290225233848357e-16   0.011863961715157143  0.0
 0.0   0.10289787290303537   0.0   1.0000000000000002      -0.10289787290303537   0.0
 0.0   0.007089731116412756  0.0   8.031058116969694e-18    0.9929102688835872    0.0
 0.0   0.28655141828646263   0.0   8.595253284172008e-16   -0.28655141828646263   1.0]

    euExpected = [ 1.0
 1.0]

G1, CC, impact, fmat, fwt, ywt, gev, eu =
        gensysToAMA(g0, g1, cc, psi, pi, div, "ama")


    
    isapprox(G1, G1Expected)&&
    isapprox(CC, CCExpected)&&
    isapprox(impact, impactExpected)&&
    isapprox(fmat, fmatExpected)&&
    isapprox(fwt, fwtExpected)&&
    isapprox(ywt, ywtExpected)&&
    gev == nothing &&
    isapprox(eu, euExpected)

end # example5

function example7()::Bool

    #inputs
    g0 = [1.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   1.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   1.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 1.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  1.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 1.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  1.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  1.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   1.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  1.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 1.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  1.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  1.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   2.754327473136523  -3.7040588115903295   0.9497313384538064  0.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                 -0.9497313384538064  0.0                  0.0                  0.0                   0.0                  0.4748656692269032  0.4748656692269032   0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                -3.7040588115903295   0.0                 0.0                  0.0                  1.8520294057951647    1.8520294057951647   0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0  -2.754327473136523   0.0                  0.0                 1.3771637365682614   1.3771637365682614   0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 1.0                 -1.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                 -1.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                  -1.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -1.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.025               0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  -1.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.0                  0.0                 0.025                0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.03510101010101017   0.0                  0.0                 0.0                 -1.0101010101010102   0.0                 0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  0.0                  0.0                   0.03510101010101017  0.0                 0.0                  0.0                 -1.0101010101010102  0.0  0.0  0.0  0.0  0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 1.0                  0.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0  -1.0   0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0   0.0   0.0                 0.0                  0.0                 0.0                  1.0                  0.0                   0.0                  0.0                 0.0                  0.0                  0.0                 0.0  0.0  0.0  0.0  0.0   0.0  -1.0  0.0  0.0  0.0  0.0  0.0  1.0]



    
    g1 = [0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -0.36                  0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  -0.36                 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          -0.975                 0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                  -0.975                0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.03510101010101017   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.03510101010101017  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0                   0.0                  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]


    cc = [0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0
          0.0]

    psi = [0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           -1.0   0.0
           0.0  -1.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0
           0.0   0.0]

    pi = [1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0
          0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]

    div = 1.0


    #outputs
    G1Expected = [0.48263819956234755     0.4826381995624005    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   1.4432899320127035e-15  -0.0  -0.0  -0.0  -1.2361108554144394e-15  -0.0  -0.0   2.1804147357737766e-16   2.1804147357737766e-16  -6.730727086790012e-16   -0.0  -0.0  -0.0
             0.4826381995623858      0.48263819956233267   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.4608609904866874e-15  -0.0  -0.0  -0.0   1.225538899841068e-15   -0.0  -0.0  -2.353220906456193e-16   -2.353220906456193e-16    6.715999725819388e-16   -0.0  -0.0  -0.0
             0.309123284673859       0.309123284673859     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   4.626484049480751e-17   -0.0  -0.0  -0.0   7.656414202329815e-17   -0.0  -0.0   1.1917205733593857e-16   1.1917205733593857e-16  -0.0                     -0.0  -0.0  -0.0
             0.17999999999999997     0.17999999999999997    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                      0.0   0.0   0.0   0.0                      0.0   0.0   0.0                      0.0                      0.0                      0.0   0.0   0.0
             -0.194472017505334      -0.194472017505334     -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.3417322989739945e-16  -0.0  -0.0  -0.0  -2.220446049250313e-16   -0.0  -0.0  -3.456123413648328e-16   -3.456123413648328e-16   -0.0                     -0.0  -0.0  -0.0
             0.30912328467385913     0.30912328467385913   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   4.62648404948075e-17    -0.0  -0.0  -0.0   1.0572211321581636e-16  -0.0  -0.0   1.1917205733593857e-16   1.1917205733593857e-16  -0.0                     -0.0  -0.0  -0.0
             0.30912328467385897     0.30912328467385897    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   4.6264840494807514e-17   0.0   0.0   0.0   5.551115123125783e-17    0.0   0.0   1.1917205733593857e-16   1.1917205733593857e-16   0.0                      0.0   0.0   0.0
             0.36                   -0.0                   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0                     -0.0  -0.0  -0.0  -0.0                     -0.0  -0.0  -0.0                     -0.0                     -0.0                     -0.0  -0.0  -0.0
             -0.0                     0.36                  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0                     -0.0  -0.0  -0.0  -0.0                     -0.0  -0.0  -0.0                     -0.0                     -0.0                     -0.0  -0.0  -0.0
             -19.694472017506097      19.30552798249602      -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   5.816609315967269e-14   -0.0  -0.0  -0.0  -4.9444434216577576e-14  -0.0  -0.0   8.721658943095106e-15    8.721658943095106e-15   -2.6867397195928788e-14  -0.0  -0.0  -0.0
             19.30552798249543      -19.69447201750669      -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -5.843443961946749e-14   -0.0  -0.0  -0.0   4.9021555993642715e-14  -0.0  -0.0  -9.412883625824772e-15   -9.412883625824772e-15    2.686399890327755e-14   -0.0  -0.0  -0.0
             -0.02224000000000004     0.0                    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                      0.0   0.0   0.0   0.0                      0.0   0.0   0.0                      0.0                      0.0                      0.0   0.0   0.0
             0.0                    -0.02224000000000004    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                      0.0   0.0   0.0   0.0                      0.0   0.0   0.0                      0.0                      0.0                      0.0   0.0   0.0
             0.4658792633536101      0.4658792633536077     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -3.1355835645067424e-16   0.0   0.0   0.0   3.224471111740873e-16    0.0   0.0   3.2633733124633207e-16   3.2633733124633207e-16   3.010581178158654e-17    0.0   0.0   0.0
             0.46587926335360136     0.4658792633536031     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   2.765649919148205e-16    0.0   0.0   0.0  -2.0488479108903795e-16   0.0   0.0  -2.0669088991066887e-16  -2.0669088991066887e-16  -2.356312636886254e-17    0.0   0.0   0.0
             0.2983894111155929      0.2983894111155927     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0                      0.0   0.0   0.0  -7.929965948460626e-18    0.0   0.0   8.103861998721587e-18    8.103861998721587e-18   -3.3588655978299875e-19   0.0   0.0   0.0
             0.17374975184245203     0.1737497518424519    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -1.4413315904915268e-16  -0.0  -0.0  -0.0  -3.394631653209671e-17   -0.0  -0.0  -3.062390948321049e-17   -3.062390948321049e-17   -1.338254737179418e-19   -0.0  -0.0  -0.0
             -0.1877192487880708     -0.1877192487880711     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -2.0614945652015413e-16   0.0   0.0   0.0   2.142593086100164e-17    0.0   0.0  -1.0081579310618701e-16  -1.0081579310618701e-16   3.842091595410096e-18    0.0   0.0   0.0
             0.29838941111559236     0.2983894111155919     0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -4.1212367440351535e-17   0.0   0.0   0.0   5.551115123125783e-17    0.0   0.0   0.0                      0.0                      5.176637354988153e-18    0.0   0.0   0.0
             0.2983894111155926      0.29838941111559264    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   2.6526074293143233e-17   0.0   0.0   0.0   1.2703698743287529e-17   0.0   0.0  -7.041060064259529e-18   -7.041060064259529e-18   -1.5379426152787455e-18   0.0   0.0   0.0
             0.17374975184244515     0.17374975184246447   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0   4.4214268998675974e-16  -0.0  -0.0  -0.0  -4.719100623697807e-16   -0.0  -0.0   3.3152479491639855e-17   3.3152479491639855e-17  -2.453787878364848e-16   -0.0  -0.0  -0.0
             0.17374975184245908     0.17374975184243993   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -6.482057586702095e-16   -0.0  -0.0  -0.0   5.080541978938632e-16   -0.0  -0.0  -7.649923392109873e-17   -7.649923392109873e-17    2.4257724657751187e-16  -0.0  -0.0  -0.0
             -0.18771924878715565    -0.1877192487893197    -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -6.981494901750684e-14   -0.0  -0.0  -0.0   5.787438178509162e-14   -0.0  -0.0  -2.4379391693127004e-16  -2.4379391693127004e-16   2.74925447914396e-14    -0.0  -0.0  -0.0
             -0.1877192487889863     -0.18771924878682178    0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   6.944925814210986e-14    0.0   0.0   0.0  -5.787438178509156e-14    0.0   0.0   0.0                      0.0                     -2.749945366821237e-14    0.0   0.0   0.0
             -0.010733873558266651   -0.010733873558267094   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -8.747720793515905e-17    0.0   0.0   0.0  -1.8713098191168716e-17   0.0   0.0  -6.647377169908174e-17   -6.647377169908174e-17    5.176637354988153e-18    0.0   0.0   0.0
             -0.01073387355826637    -0.01073387355826632   -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -0.0  -5.03993600891137e-17    -0.0  -0.0  -0.0  -5.537616357008078e-17   -0.0  -0.0  -1.1062008787381735e-16  -1.1062008787381735e-16  -1.537942615279322e-18   -0.0  -0.0  -0.0]


    CCExpected = [0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0
             0.0]

    impactExpected = [0.04658799287442328    0.04658799287442328  
                 0.0465879928744215     0.0465879928744215   
                 0.02983898372893501    0.029838983728935065 
                 0.49999999999999994    0.49999999999999994  
                 1.8635197149769183     1.8635197149769183   
                 0.02983898372893501    0.029838983728935065 
                 0.02983898372893501    0.029838983728935065 
                 1.0                    0.0                  
                 0.0                    1.0                  
                 1.8635197149769738     1.8635197149769738   
                 1.8635197149769738     1.8635197149769738   
                 0.034750000000000066   0.0                  
                 0.0                    0.034750000000000066 
                 0.04497029000427252    0.04497029000427252  
                 0.04497029000427094    0.04497029000427094  
                 0.028802866767407925   0.028802866767407925 
                 0.016771677434792267   0.016771677434792267 
                 -0.018120121931626335  -0.018120121931626335 
                 0.028802866767407932   0.028802866767407932 
                 0.028802866767407925   0.028802866767407925 
                 0.01677167743479302    0.01677167743479302  
                 0.01677167743479213    0.01677167743479213  
                 -0.01812012193170176   -0.01812012193170176  
                 -0.018120121931588073  -0.018120121931588073 
                 -0.001036116961527167  -0.0010361169615271115
                 -0.001036116961527167  -0.0010361169615271115]

    fmatExpected = [-3.2054777423066464e-18  0.0  0.0  0.0  -5.051405307745384e-18    -22.516657085924212      22.447371691053704   -7.692224065547273e-18   -7.692224065547322e-18    0.0                      2.0816681711721685e-17    22.516657085924212     -22.447371691053704 
               -3.2054777423023077e-18  0.0  0.0  0.0  -5.051405307750709e-18     22.4473716910537       -22.51665708592421    -7.692224065548185e-18   -7.692224065548185e-18   -2.0816681711721685e-17  -6.245004513516506e-17    -22.4473716910537        22.51665708592421  
               4.42117750525188e-17    0.0  0.0  0.0   6.967185958518576e-17      0.47781181756674485     0.477811817566741    1.0609553626011854e-16   1.0609553626011854e-16  -1.6263032587282567e-18  -1.1926223897340549e-18    -0.47781181756674485    -0.477811817566741 
               0.0                     0.0  0.0  0.0   0.0                        0.0                     0.0                  0.0                      0.0                      0.0                      0.0                        0.0                     0.0               
               -1.2821910969215399e-16  0.0  0.0  0.0  -2.0205621230989923e-16    -1.3857078974101968     -1.3857078974101547  -3.076889626219382e-16   -3.0768896262193824e-16   2.3852447794681098e-18   3.2526065174565133e-18     1.3857078974101968      1.3857078974101547
               4.42117750525188e-17    0.0  0.0  0.0   6.967185958518576e-17      0.47781181756674485     0.477811817566741    1.0609553626011854e-16   1.0609553626011854e-16  -1.6263032587282567e-18  -1.1926223897340549e-18    -0.47781181756674485    -0.477811817566741 
               4.42117750525188e-17    0.0  0.0  0.0   6.967185958518576e-17      0.47781181756674485     0.477811817566741    1.0609553626011854e-16   1.0609553626011854e-16  -1.6263032587282567e-18  -1.1926223897340549e-18    -0.47781181756674485    -0.477811817566741 
               0.0                     0.0  0.0  0.0   0.0                        0.0                     0.0                  0.0                      0.0                      0.0                      0.0                        0.0                     0.0               
               0.0                     0.0  0.0  0.0   0.0                        0.0                     0.0                  0.0                      0.0                      0.0                      0.0                        0.0                     0.0               
               -1.282191096922138e-16   0.0  0.0  0.0  -2.0205621230983745e-16  -900.6662834369685       897.894867642148      -3.076889626219278e-16   -3.076889626219278e-16    6.661338147750939e-16    4.440892098500626e-16    900.6662834369685      -897.894867642148    
               -1.2821910969206233e-16  0.0  0.0  0.0  -2.0205621231005833e-16   897.894867642148       -900.6662834369683     -3.076889626219467e-16   -3.076889626219467e-16   -1.5543122344752192e-15  -1.5543122344752192e-15  -897.894867642148        900.6662834369683   
               0.0                     0.0  0.0  0.0   0.0                        0.0                     0.0                  0.0                      0.0                      0.0                      0.0                        0.0                     0.0               
               0.0                     0.0  0.0  0.0   0.0                        0.0                     0.0                  0.0                      0.0                      0.0                      0.0                        0.0                     0.0]


    fwtExpected = [0.04658799287442328   0.04658799287442328 
              0.0465879928744215    0.0465879928744215  
              0.02983898372893501   0.029838983728935065
              0.49999999999999994   0.49999999999999994 
              1.8635197149769183    1.8635197149769183  
              0.02983898372893501   0.029838983728935065
              0.02983898372893501   0.029838983728935065
              1.0                   0.0                 
              0.0                   1.0                 
              1.8635197149769738    1.8635197149769738  
              1.8635197149769738    1.8635197149769738  
              0.034750000000000066  0.0                 
              0.0                   0.034750000000000066]


    ywtExpected = [-3.2054777423036882e-18  0.0  0.0  0.0  -5.05140530774499e-18     -22.51665708592422        22.44737169105371      -7.692224065548111e-18   -7.692224065548185e-18    2.0816681711721685e-17   4.5102810375396984e-17    22.51665708592422       -22.44737169105371    
              -3.2054777423023077e-18  0.0  0.0  0.0  -5.051405307750709e-18     22.4473716910537        -22.51665708592421      -7.692224065548185e-18   -7.692224065548185e-18   -2.0816681711721685e-17  -6.245004513516506e-17    -22.4473716910537         22.51665708592421    
              4.42117750525188e-17    0.0  0.0  0.0   6.967185958518576e-17      0.47781181756674485      0.477811817566741      1.0609553626011854e-16   1.0609553626011854e-16  -1.6263032587282567e-18  -1.1926223897340549e-18    -0.47781181756674485     -0.477811817566741   
              0.0                     0.0  0.0  0.0   0.0                        0.0                      0.0                    0.0                      0.0                      0.0                      0.0                        0.0                      0.0                 
              -1.2821910969215399e-16  0.0  0.0  0.0  -2.0205621230989923e-16    -1.3857078974101968      -1.3857078974101547    -3.076889626219382e-16   -3.0768896262193824e-16   2.3852447794681098e-18   3.2526065174565133e-18     1.3857078974101968       1.3857078974101547  
              4.42117750525188e-17    0.0  0.0  0.0   6.967185958518576e-17      0.47781181756674485      0.477811817566741      1.0609553626011854e-16   1.0609553626011854e-16  -1.6263032587282567e-18  -1.1926223897340549e-18    -0.47781181756674485     -0.477811817566741   
              4.42117750525188e-17    0.0  0.0  0.0   6.967185958518576e-17      0.47781181756674485      0.477811817566741      1.0609553626011854e-16   1.0609553626011854e-16  -1.6263032587282567e-18  -1.1926223897340549e-18    -0.47781181756674485     -0.477811817566741   
              0.0                     0.0  0.0  0.0   0.0                        0.0                      0.0                    0.0                      0.0                      0.0                      0.0                        0.0                      0.0                 
              0.0                     0.0  0.0  0.0   0.0                        0.0                      0.0                    0.0                      0.0                      0.0                      0.0                        0.0                      0.0                 
              -1.282191096922138e-16   0.0  0.0  0.0  -2.0205621230983745e-16  -900.6662834369685        897.894867642148        -3.076889626219278e-16   -3.076889626219278e-16    6.661338147750939e-16    4.440892098500626e-16    900.6662834369685       -897.894867642148      
              -1.2821910969206233e-16  0.0  0.0  0.0  -2.0205621231005833e-16   897.894867642148        -900.6662834369683       -3.076889626219467e-16   -3.076889626219467e-16   -1.5543122344752192e-15  -1.5543122344752192e-15  -897.894867642148         900.6662834369683     
              0.0                     0.0  0.0  0.0   0.0                        0.0                      0.0                    0.0                      0.0                      0.0                      0.0                        0.0                      0.0                 
              0.0                     0.0  0.0  0.0   0.0                        0.0                      0.0                    0.0                      0.0                      0.0                      0.0                        0.0                      0.0                 
              1.0000000000000016      0.0  0.0  0.0  -1.2409868577403898e-15    -0.03343977823567231     -0.03343977823686887    2.1061635123011915e-16   2.1061635123011915e-16  -6.643381049269148e-16    5.21772295508649e-19       0.03343977823567231      0.03343977823686887 
              -1.463955162499216e-15   1.0  0.0  0.0   1.2206628975150543e-15    -0.033439778236873004    -0.03343977823566582   -2.427472129928673e-16   -2.4274721299286724e-16   6.780329336181223e-16   -2.642742795433417e-19      0.033439778236873004     0.03343977823566582 
              4.4283064877507976e-17  0.0  1.0  0.0   5.2388137229357886e-17    -0.02141772884230203     -0.021417728842292004   1.1441636619675927e-16   1.144163661967593e-16   -2.5275463146068322e-18  -2.6834003769016235e-18     0.02141772884230203      0.021417728842292004
              -1.153971987229544e-18   0.0  0.0  1.0  -1.818505910788993e-18     -0.012471371076692774    -0.012471371076690392  -2.7692006635974662e-18  -2.7692006635974624e-18  -1.807568309440677e-18   -8.639736061993863e-20      0.012471371076692774     0.012471371076690392
              -1.3292647845017112e-16  0.0  0.0  0.0   0.9999999999999998         0.013474070524120465     0.013474070524122687  -3.426204966985722e-16   -3.4262049669857214e-16  -3.2864878353466853e-18  -2.1006417091906648e-19    -0.013474070524120465    -0.013474070524122687
              4.428306487750785e-17   0.0  0.0  0.0   6.978420283922998e-17      0.978582271157712       -0.021417728842306066   1.0626661132333632e-16   1.0626661132333635e-16   3.3881317890172014e-21  -1.0875903042745216e-18     0.02141772884228798      0.021417728842306066
              4.428306487750794e-17   0.0  0.0  0.0   6.978420283922998e-17     -0.021417728842287192     0.9785822711576931     1.0626661132333636e-16   1.0626661132333639e-16  -7.860465750519907e-19   -1.616138863361205e-18      0.021417728842287192     0.021417728842306846
              -1.1539719872292725e-18  0.0  0.0  0.0  -1.818505910788993e-18     -8.105996550932721        8.081053808779338      1.0000000000000002      -2.769200663597179e-18    0.0                     -1.5612511283791264e-17     8.105996550932721       -8.081053808779338   
              -1.153971987229174e-18   0.0  0.0  0.0  -1.8185059107903735e-18     8.08105380877933        -8.105996550932714     -2.7692006635974377e-18   1.0                      8.673617379884035e-18   -1.3877787807814457e-17    -8.08105380877933         8.105996550932714   
              5.816733991111842e-14   0.0  0.0  0.0  -4.9442469502613467e-14   876.8120352216174       -876.7850870805692        8.72465078776112e-15     8.72465078776112e-15     0.9999999999999729      -1.1102230246251565e-15  -876.8120352216174        876.7850870805692     
              -5.843319286801897e-14   0.0  0.0  0.0   4.9023520707604445e-14  -876.7850870805693        876.8120352216175       -9.409891781158316e-15   -9.409891781158316e-15    2.5646151868841116e-14   1.000000000000001        876.7850870805693       -876.8120352216175     
              7.12898249888316e-20    0.0  0.0  0.0   1.1234325404425244e-19     0.5007704535909647      -0.4992295464090447     1.7107506321779269e-19   1.7107506321779269e-19  -2.168404344971009e-19   -1.0842021724855044e-18     0.4992295464090352       0.4992295464090447  
              7.128982498893021e-20   0.0  0.0  0.0   1.1234325404430174e-19    -0.4992295464090352       0.5007704535909553     1.7107506321781734e-19   1.7107506321781734e-19   1.5178830414797062e-18  -2.168404344971009e-19      0.4992295464090352       0.4992295464090447]

    euExpected = [1.0
             1.0]
    
G1, CC, impact, fmat, fwt, ywt, gev, eu =
        gensysToAMA(g0, g1, cc, psi, pi, div, "ama")
    
    
    isapprox(G1, G1Expected)&&
    isapprox(CC, CCExpected)&&
    isapprox(impact, impactExpected)&&
    isapprox(fmat, fmatExpected)&&
    isapprox(fwt, fwtExpected)&&
    isapprox(ywt, ywtExpected)&&
    gev == nothing &&
    isapprox(eu, euExpected)

end # example7
    
end # module
