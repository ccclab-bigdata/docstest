<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Docstrings · RadiationSpectra.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>RadiationSpectra.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Readme</a></li><li class="current"><a class="toctext" href>Docstrings</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Docstrings</a></li></ul></nav><hr/><div id="topbar"><span>Docstrings</span><a class="fa fa-bars" href="#"></a></div></header><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.AbstractFitFunction" href="#RadiationSpectra.AbstractFitFunction"><code>RadiationSpectra.AbstractFitFunction</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">AbstractFitFunction{T, N}</code></pre><p>Abstract type for an <code>N</code>-dimensional fit of eltype <code>T</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.FitFunction" href="#RadiationSpectra.FitFunction"><code>RadiationSpectra.FitFunction</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">FitFunction{T} &lt;: AbstractFitFunction{T, 1}</code></pre><p>Fields:</p><ul><li><code>model::Function</code>: Function of the fit model.</li><li><code>fitrange::Tuple{Union{Missing, T}, Union{Missing, T}}</code>: Range on which the fit is performed.</li><li><code>parameters::Union{Vector{Missing}, Vector{T}}</code>: Fitted parameters.</li><li><code>uncertainties::Union{Vector{Missing}, Vector{T}}</code>: Uncertainties of the fitted parameters.</li><li><code>initial_parameters::Union{Vector{Missing}, Vector{T}}</code>: Initial parameters.</li><li><code>confidence_level::Union{Missing, T}</code>: Confidence level, used to determine the uncertainties.</li></ul><p><strong>Plotting:</strong></p><p>A plot recipes exists for this struct: <code>plot(fit::FitFunction{T}; npoints=501)</code></p><p>Plots the model function over the fitrange with 501-points. </p></div></div></section><pre><code class="language-none">RadiationSpectra.RadiationSpectra</code></pre><pre><code class="language-none">RadiationSpectra.calculate_ratios</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.calibrate_spectrum" href="#RadiationSpectra.calibrate_spectrum"><code>RadiationSpectra.calibrate_spectrum</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">calibrate_spectrum(h_uncal::Histogram, photon_lines::Array{Real, 1}; &lt;keyword arguments&gt;)::Histogram</code></pre><p>Returns a calibrated histogram.</p><p><strong>Keywords</strong></p><ul><li><code>sigma::Real = 2.0</code>: The expected sigma of a peak in the spectrum. In units of bins. </li><li><code>threshold::Real = 10.0</code>: Threshold for being identified as a peak in the deconvoluted spectrum. A single bin is identified as a peak when its weight exceeds the <code>threshold</code> and the previous bin was not identified as an peak.</li><li><code>min_n_peaks::Int = 0</code>: If the number of found peaks is smaller than <code>min_n_peaks</code> the functions lowers the parameter <code>threshold</code> until enough peaks are found.</li><li><code>α::Real = 0.005</code>:  = 0.5%. Acceptance level in the comparison of the peak position ratios in the peak indentification step. When the difference between the ratio of two found peak positions and the ratio of two photon lines (<code>photon_lines</code>) is smaller than <code>α</code>, the found peaks are identified as the two photon lines.</li></ul><p>Calibrate the spectrum <code>h_uncal</code>. This is done by:</p><ol><li>finding peaks through devoncolution</li><li>identifying them through comparison of the ratios of their positions with the ratios of the known <code>lines</code></li><li>fitting all identified peaks (with a gaussian plus first order polynomial) to get their position more precisely</li><li>performe a linear fit (offset forced to 0) of these positions vs the true positions (<code>lines</code>) to get the calibration constant </li></ol></div></div></section><pre><code class="language-none">RadiationSpectra.determine_calibration_constant_through_peak_fitting</code></pre><pre><code class="language-none">RadiationSpectra.determine_calibration_constant_through_peak_ratios</code></pre><pre><code class="language-none">RadiationSpectra.eval</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.gauss" href="#RadiationSpectra.gauss"><code>RadiationSpectra.gauss</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">gauss(x::T, p::Vector{T})::T</code></pre><p>A Gaussian with 3 parameters:</p><ul><li><code>p[1]</code>: Scale/Amplitude</li><li><code>p[2]</code>: σ</li><li><code>p[3]</code>: μ</li></ul></div></div><div><div><pre><code class="language-none">gauss(x::Vector{T}, p::Vector{T})::Vector{T}</code></pre><p>Maps <code>x</code> to <code>gauss(x::T, p::Vector{T})::T</code></p></div></div></section><pre><code class="language-none">RadiationSpectra.gauss_plus_first_order_polynom</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.get_example_spectrum" href="#RadiationSpectra.get_example_spectrum"><code>RadiationSpectra.get_example_spectrum</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">get_example_spectrum()::Histogram</code></pre><p>Returns an uncalibrated radiation spectrum for testing and demonstrating purpose.</p></div></div></section><pre><code class="language-none">RadiationSpectra.include</code></pre><pre><code class="language-none">RadiationSpectra.linear_function_fixed_offset_at_zero</code></pre><pre><code class="language-none">RadiationSpectra.llhfit</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.llhfit!" href="#RadiationSpectra.llhfit!"><code>RadiationSpectra.llhfit!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none"> llhfit!(fit::FitFunction, h::Histogram)::Nothing</code></pre><p>Performs a log-likelihood fit of the model function <code>fit.model</code> and the initial parameters <code>fit.initial_parameters</code> on the histogram <code>h</code> in the range <code>fit.fitrange</code>. The determined parameters are stored in <code>fit.parameters</code>.</p><p>The likelihood for each individual bin is the Poission distribution.</p><p>There are no uncertainty estimations for this fit yet.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.lsqfit!" href="#RadiationSpectra.lsqfit!"><code>RadiationSpectra.lsqfit!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">lsqfit!(fit::FitFunction, h::Histogram; estimate_uncertainties=false)::Nothing</code></pre><p>Performs a Least Square Fit with the model <code>fit.model</code> and the initial parameters <code>fit.initial_parameters</code> on the histogram <code>h</code> in the range <code>fit.fitrange</code>. The determined parameters are stored in <code>fit.parameters</code> and the corresponding uncertainties in <code>fit.uncertainties</code> for the given confidence level <code>fit.confidence_level</code>.</p><p>The uncertainties are marginalizations of the covariance matrix determined by the LSQFit.jl package. They are only calculated if the keywort <code>estimate_uncertainties</code> is set to <code>true</code>.</p><p>See <a href="https://github.com/JuliaNLSolvers/LsqFit.jl">LsqFit.jl</a> for more detail.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RadiationSpectra.peakfinder" href="#RadiationSpectra.peakfinder"><code>RadiationSpectra.peakfinder</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">peakfinder(h::Histogram; &lt;keyword arguments&gt;)::Tuple{Histogram, Array{Float64, 1}}</code></pre><p>Returns a deconvoluted spectrum and an array of peak positions.</p><p><strong>Keywords</strong></p><ul><li><code>sigma::Real=2.0</code>: The expected sigma of a peak in the spectrum. In units of bins. </li><li><code>threshold::Real=10.0</code>: Threshold for being identified as a peak in the deconvoluted spectrum. A single bin is identified as a peak when its weight exceeds the <code>threshold</code> and the previous bin was not identified as an peak.</li><li><code>backgroundRemove::Bool=true</code></li><li><code>deconIterations::Int=3</code></li><li><code>markov::Bool=true</code></li><li><code>averWindow::Int=3</code></li></ul><p><strong>Source</strong></p><p>This function is basically a copy of <code>TSpectrum::SearchHighRes</code> from <a href="https://root.cern.ch/doc/master/classTSpectrum.html">ROOT</a>.</p><ul><li>M.A. Mariscotti: A method for identification of peaks in the presence of background and its application to spectrum analysis. NIM 50 (1967), 309-320.</li><li>M. Morhac;, J. Kliman, V. Matouoek, M. Veselsky, I. Turzo.:Identification of peaks in multidimensional coincidence gamma-ray spectra. NIM, A443 (2000) 108-125.</li><li>Z.K. Silagadze, A new algorithm for automatic photopeak searches. NIM A 376 (1996), 451.</li></ul></div></div></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Readme</span></a></footer></article></body></html>
