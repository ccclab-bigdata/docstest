<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Readme Â· FastGaussQuadrature.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>FastGaussQuadrature.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Readme</a><ul class="internal"><li><a class="toctext" href="#Our-Aims-1">Our Aims</a></li><li><a class="toctext" href="#Examples-1">Examples</a></li><li><a class="toctext" href="#The-algorithm-for-Gauss-Chebyshev-1">The algorithm for Gauss-Chebyshev</a></li><li><a class="toctext" href="#The-algorithm-for-Gauss-Legendre-1">The algorithm for Gauss-Legendre</a></li><li><a class="toctext" href="#The-algorithm-for-Gauss-Jacobi-1">The algorithm for Gauss-Jacobi</a></li><li><a class="toctext" href="#The-algorithm-for-Gauss-Radau-1">The algorithm for Gauss-Radau</a></li><li><a class="toctext" href="#The-algorithm-for-Gauss-Lobatto-1">The algorithm for Gauss-Lobatto</a></li><li><a class="toctext" href="#The-algorithm-for-Gauss-Laguerre-1">The algorithm for Gauss-Laguerre</a></li><li><a class="toctext" href="#The-algorithm-for-Gauss-Hermite-1">The algorithm for Gauss-Hermite</a></li><li><a class="toctext" href="#Example-usage-1">Example usage</a></li><li><a class="toctext" href="#References:-1">References:</a></li></ul></li><li><a class="toctext" href="autodocs/">Docstrings</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Readme</a></li></ul></nav><hr/><div id="topbar"><span>Readme</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="FastGaussQuadrature.jl-1" href="#FastGaussQuadrature.jl-1">FastGaussQuadrature.jl</a></h1><p><a href="https://travis-ci.org/ajt60gaibb/FastGaussQuadrature.jl"><img src="https://travis-ci.org/ajt60gaibb/FastGaussQuadrature.jl.svg?branch=master" alt="Build Status"/></a> <a href="https://codecov.io/gh/ajt60gaibb/FastGaussQuadrature.jl"><img src="https://codecov.io/gh/ajt60gaibb/FastGaussQuadrature.jl/branch/master/graph/badge.svg" alt="codecov"/></a></p><p>A Julia package to compute <code>n</code>-point Gauss quadrature nodes and weights to 16-digit accuracy and in <code>O(n)</code> time. So far the package includes <code>gausschebyshev()</code>, <code>gausslegendre()</code>, <code>gaussjacobi()</code>, <code>gaussradau()</code>, <code>gausslobatto()</code>, <code>gausslaguerre()</code>, and <code>gausshermite()</code>. This package is heavily influenced by &lt;a href=&quot;http://www.chebfun.org&quot;&gt;Chebfun&lt;/a&gt;.</p><p>An introduction to Gauss quadrature can be found &lt;a href=&quot;http://en.wikipedia.org/wiki/Gaussian_quadrature&quot;&gt;here&lt;/a&gt;. For a quirky account on the history of computing Gauss-Legendre quadrature, see &lt;a href=&quot;http://math.mit.edu/~ajt/papers/QuadratureEssay.pdf&quot;&gt;[6]&lt;/a&gt;.</p><h2><a class="nav-anchor" id="Our-Aims-1" href="#Our-Aims-1">Our Aims</a></h2><ul><li><p>The fastest Julia code for Gauss quadrature nodes and weights (without tabulation).</p></li><li><p>Change the perception that Gauss quadrature rules are expensive to compute.</p></li></ul><h2><a class="nav-anchor" id="Examples-1" href="#Examples-1">Examples</a></h2><p>Here we compute <code>100000</code> nodes and weights of the Gauss rules. Try a million or ten million.</p><pre><code class="language-none">@time gausschebyshev( 100000 );
0.002681 seconds (9 allocations: 1.526 MB, 228.45% gc time)

@time gausslegendre( 100000 ); 
0.007110 seconds (17 allocations: 2.671 MB)

@time gaussjacobi( 100000, .9, -.1 );
1.782347 seconds (20.84 k allocations: 1.611 GB, 22.89% gc time)

@time gaussradau( 100000 );
1.849520 seconds (741.84 k allocations: 1.625 GB, 22.59% gc time)

@time gausslobatto( 100000 );
1.905083 seconds (819.73 k allocations: 1.626 GB, 23.45% gc time)

@time gausslaguerre( 100000 )
.891567 seconds (115.19 M allocations: 3.540 GB, 3.05% gc time)

@time gausshermite( 100000 );
0.249756 seconds (201.22 k allocations: 131.643 MB, 4.92% gc time)</code></pre><p>The paper &lt;a href=&quot;http://epubs.siam.org/doi/abs/10.1137/140954969&quot;&gt;[1]&lt;/a&gt; computed a billion Gauss-Legendre nodes. So here we will do a billion + 1.</p><pre><code class="language-none">@time gausslegendre( 1000000001 );
131.392154 seconds (17 allocations: 26.077 GB, 1.17% gc time)</code></pre><p>(The nodes near the endpoints coalesce in 16-digits of precision.)</p><h2><a class="nav-anchor" id="The-algorithm-for-Gauss-Chebyshev-1" href="#The-algorithm-for-Gauss-Chebyshev-1">The algorithm for Gauss-Chebyshev</a></h2><p>There are four kinds of Gauss-Chebyshev quadrature rules, corresponding to four weight functions:</p><ol><li><p>1st kind, weight function <code>w(x) = 1/sqrt(1-x^2)</code></p></li><li><p>2nd kind, weight function <code>w(x) = sqrt(1-x^2)</code></p></li><li><p>3rd kind, weight function <code>w(x) = sqrt((1+x)/(1-x))</code></p></li><li><p>4th kind, weight function <code>w(x) = sqrt((1-x)/(1+x))</code></p></li></ol><p>They are all have explicit simple formulas for the nodes and weights &lt;a href=&quot;http://books.google.com/books?id=8FHf0P3to0UC&amp;lpg=PP1&amp;pg=PA180#v=onepage&amp;q&amp;f=false&quot;&gt;[4]&lt;/a&gt;.</p><h2><a class="nav-anchor" id="The-algorithm-for-Gauss-Legendre-1" href="#The-algorithm-for-Gauss-Legendre-1">The algorithm for Gauss-Legendre</a></h2><p>Gauss quadrature for the weight function <code>w(x) = 1</code>.</p><ul><li><p>For <code>n&lt;=5</code>: Use an analytic expression.</p></li><li><p>For <code>n&lt;=60</code>: Use Newton&#39;s method to solve <code>Pn(x)=0</code>. Evaluate <code>Pn</code> and <code>Pn&#39;</code> by 3-term recurrence. Weights are related to <code>Pn&#39;</code>.</p></li><li><p>For <code>n&gt;60</code>: Use asymptotic expansions for the Legendre nodes and weights &lt;a href=&quot;http://epubs.siam.org/doi/abs/10.1137/140954969&quot;&gt;[1]&lt;/a&gt;.  </p></li></ul><h2><a class="nav-anchor" id="The-algorithm-for-Gauss-Jacobi-1" href="#The-algorithm-for-Gauss-Jacobi-1">The algorithm for Gauss-Jacobi</a></h2><p>Gauss quadrature for the weight functions <code>w(x) = (1-x)^a(1+x)^b</code>, <code>a,b&gt;-1</code>.</p><ul><li><p>For <code>n&lt;=100</code>: Use Newton&#39;s method to solve <code>Pn(x)=0</code>. Evaluate <code>Pn</code> and <code>Pn&#39;</code> by three-term recurrence.</p></li><li><p>For <code>n&gt;100</code>: Use Newton&#39;s method to solve <code>Pn(x)=0</code>. Evaluate <code>Pn</code> and <code>Pn&#39;</code> by an asymptotic expansion (in the interior of <code>[-1,1]</code>) and the three-term recurrence <code>O(n^-2)</code> close to the endpoints. (This is a small modification to the algorithm described in &lt;a href=&quot;http://epubs.siam.org/doi/abs/10.1137/120889873&quot;&gt;[3]&lt;/a&gt;.)</p></li><li><p>For <code>max(a,b)&gt;5</code>: Use the Golub-Welsch algorithm requiring <code>O(n^2)</code> operations. </p></li></ul><h2><a class="nav-anchor" id="The-algorithm-for-Gauss-Radau-1" href="#The-algorithm-for-Gauss-Radau-1">The algorithm for Gauss-Radau</a></h2><p>Gauss quadrature for the weight function <code>w(x)=1</code>, except the endpoint <code>-1</code> is included as a quadrature node.</p><p>The Gauss-Radau nodes and weights can be computed via the <code>(0,1)</code> Gauss-Jacobi nodes and weights &lt;a href=&quot;http://epubs.siam.org/doi/abs/10.1137/120889873&quot;&gt;[3]&lt;/a&gt;.</p><h2><a class="nav-anchor" id="The-algorithm-for-Gauss-Lobatto-1" href="#The-algorithm-for-Gauss-Lobatto-1">The algorithm for Gauss-Lobatto</a></h2><p>Gauss quadrature for the weight function <code>w(x)=1</code>, except the endpoints <code>-1</code> and <code>1</code> are included as nodes.</p><p>The Gauss-Lobatto nodes and weights can be computed via the <code>(1,1)</code> Gauss-Jacobi nodes and weights &lt;a href=&quot;http://epubs.siam.org/doi/abs/10.1137/120889873&quot;&gt;[3]&lt;/a&gt;.</p><h2><a class="nav-anchor" id="The-algorithm-for-Gauss-Laguerre-1" href="#The-algorithm-for-Gauss-Laguerre-1">The algorithm for Gauss-Laguerre</a></h2><p>Gauss quadrature for the weight function <code>w(x) = exp(-x)</code> on <code>[0,Inf)</code></p><ul><li><p>For <code>n&lt;128</code>: Use the Golub-Welsch algorithm. </p></li><li><p>For <code>method=GLR</code>: Use the Glaser-Lui-Rohklin algorithm. Evaluate <code>Ln</code> and <code>Ln&#39;</code> by using Taylor series expansions near roots generated by solving the second-order differential equation that <code>Ln</code> satisfies, see &lt;a href=&quot;http://epubs.siam.org/doi/pdf/10.1137/06067016X&quot;&gt;[2]&lt;/a&gt;.</p></li><li><p>For <code>n&gt;=128</code>: Use a Newton procedure on Riemann-Hilbert asymptotics of Laguerre polynomials, see [5], based on [8]. There are some heuristics to decide which expression to use, it allows a general weight <code>w(x) = x^alpha exp(-q_m x^m)</code> and this is O(sqrt(n)) when allowed to stop when the weights are below the smallest positive floating point number.</p></li></ul><h2><a class="nav-anchor" id="The-algorithm-for-Gauss-Hermite-1" href="#The-algorithm-for-Gauss-Hermite-1">The algorithm for Gauss-Hermite</a></h2><p>Gauss quadrature for the weight function <code>w(x) = exp(-x^2)</code> on the real line.</p><ul><li><p>For <code>n&lt;200</code>: Use Newton&#39;s method to solve <code>Hn(x)=0</code>. Evaluate <code>Hn</code> and <code>Hn&#39;</code> by three-term recurrence.</p></li><li><p>For <code>n&gt;=200</code>: Use Newton&#39;s method to solve <code>Hn(x)=0</code>. Evaluate <code>Hn</code> and <code>Hn&#39;</code> by a uniform asymptotic expansion, see &lt;a href=&quot;http://arxiv.org/abs/1410.5286&quot;&gt;[7]&lt;/a&gt;.</p></li><li></li></ul><p>The paper &lt;a href=&quot;http://arxiv.org/abs/1410.5286&quot;&gt;[7]&lt;/a&gt; also derives an <code>O(n)</code> algorithm for generalized Gauss-Hermite nodes and weights associated to weight functions of the form <code>exp(-V(x))</code>, where <code>V(x)</code> is a real polynomial.</p><h2><a class="nav-anchor" id="Example-usage-1" href="#Example-usage-1">Example usage</a></h2><pre><code class="language-none">@time nodes, weights = gausslegendre( 100000 );
0.007890 seconds (19 allocations: 2.671 MB)

# integrates f(x) = x^2 from -1 to 1
@time dot( weights, nodes.^2 )
0.004264 seconds (7 allocations: 781.484 KB)
0.666666666666666</code></pre><h2><a class="nav-anchor" id="References:-1" href="#References:-1">References:</a></h2><p>[1] I. Bogaert, &lt;a href=&quot;http://epubs.siam.org/doi/abs/10.1137/140954969&quot;&gt;&quot;Iteration-free computation of Gauss-Legendre quadrature nodes and weights&quot;&lt;/a&gt;, SIAM J. Sci. Comput., 36(3), A1008-A1026, 2014.</p><p>[2] A. Glaser, X. Liu, and V. Rokhlin. &lt;a href=&quot;http://epubs.siam.org/doi/pdf/10.1137/06067016X&quot;&gt;&quot;A fast algorithm for the calculation of the roots of special functions.&quot;&lt;/a&gt; SIAM J. Sci. Comput., 29 (2007), 1420-1438.</p><p>[3] N. Hale and A. Townsend, &lt;a href=&quot;http://epubs.siam.org/doi/abs/10.1137/120889873&quot;&gt;&quot;Fast and accurate computation of Gauss-Legendre and Gauss-Jacobi quadrature        nodes and weights&quot;&lt;/a&gt;, SIAM J. Sci. Comput., 2012.</p><p>[4] J. C. Mason and D. C. Handscomb, &lt;a href=&quot;http://books.google.com/books?id=8FHf0P3to0UC&amp;lpg=PP1&amp;dq=Mason%20and%20Handscomb&amp;pg=PP1#v=onepage&amp;q=Mason%20and%20Handscomb&amp;f=false&quot;&gt;&quot;Chebyshev Polynomials&quot;&lt;/a&gt;, CRC Press, 2002.</p><p>[5] P. Opsomer, (in preparation).</p><p>[6] A. Townsend, &lt;a href=&quot;http://math.mit.edu/~ajt/papers/QuadratureEssay.pdf&quot;&gt; The race for high order Gauss-Legendre quadrature&lt;/a&gt;, in SIAM News, March 2015.  </p><p>[7] A. Townsend, T. Trogdon, and S. Olver, &lt;a href=&quot;http://arxiv.org/abs/1410.5286&quot;&gt;&quot;Fast computation of Gauss quadrature nodes and weights on the whole real line&quot;&lt;/a&gt;, to appear in IMA Numer. Anal., 2014.</p><p>[8] M. Vanlessen, &quot;Strong asymptotics of Laguerre-Type orthogonal polynomials and applications in Random Matrix Theory&quot;, Constr. Approx., 25:125-175, 2007.</p><footer><hr/><a class="next" href="autodocs/"><span class="direction">Next</span><span class="title">Docstrings</span></a></footer></article></body></html>
