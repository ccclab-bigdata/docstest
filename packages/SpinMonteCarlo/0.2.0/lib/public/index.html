<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Public · SpinMonteCarlo.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>SpinMonteCarlo.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../../runmc/">Run Monte Carlo</a></li><li><a class="toctext" href="../../develop/">Develop Monte Carlo</a></li></ul></li><li><span class="toctext">Library</span><ul><li class="current"><a class="toctext" href>Public</a><ul class="internal"><li><a class="toctext" href="#Driver-1">Driver</a></li><li><a class="toctext" href="#Model-1">Model</a></li><li><a class="toctext" href="#Lattice-generator-1">Lattice generator</a></li><li><a class="toctext" href="#Update-method-1">Update method</a></li><li><a class="toctext" href="#Estimator-1">Estimator</a></li><li><a class="toctext" href="#Utility-1">Utility</a></li></ul></li><li><a class="toctext" href="../internals/">Internals</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Library</li><li><a href>Public</a></li></ul></nav><hr/><div id="topbar"><span>Public</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Public-interfaces-1" href="#Public-interfaces-1">Public interfaces</a></h1><p>Documentation for <code>SpinMonteCarlo.jl</code>&#39;s public interface (exported).</p><h2><a class="nav-anchor" id="Driver-1" href="#Driver-1">Driver</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.runMC" href="#SpinMonteCarlo.runMC"><code>SpinMonteCarlo.runMC</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">runMC(param::Parameter)
runMC(params::AbstractArray{Parameter} ; parallel::Bool=false)</code></pre><p>Runs Monte Carlo simulation(s) and returns calculated observables.</p><p><strong>Keyward aruguments</strong></p><ul><li><code>parallel</code>: If true, runs simulations in parallel (uses <code>pmap</code> instead of <code>map</code>).</li></ul><p><strong>Required keys in <code>param</code></strong></p><ul><li>&quot;Model&quot;</li><li>&quot;Update Method&quot;</li></ul><p><strong>Optional keys in <code>param</code></strong></p><ul><li>&quot;MCS&quot;: The number of Monte Carlo steps after thermalization<ul><li>Default: <code>8192</code></li></ul></li><li>&quot;Thermalization&quot;: The number of Monte Carlo steps for thermalization<ul><li>Default: <code>MCS&gt;&gt;3</code></li></ul></li><li>&quot;Seed&quot;: The initial seed of the random number generator, <code>MersenneTwister</code><ul><li>Default: determined randomly (see <code>Random.srand</code>)</li></ul></li></ul></div></div></section><h2><a class="nav-anchor" id="Model-1" href="#Model-1">Model</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.Ising" href="#SpinMonteCarlo.Ising"><code>SpinMonteCarlo.Ising</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Ising model with energy <span>$E = -\sum_{ij} J_{ij} \sigma_i \sigma_j$</span>, where <span>$\sigma_i$</span> takes value of 1 (up spin) or -1 (down spin).</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.Potts" href="#SpinMonteCarlo.Potts"><code>SpinMonteCarlo.Potts</code></a> — <span class="docstring-category">Type</span>.</div><div><p><code>Q</code> state Potts model with energy <span>$E = -\sum_{i,j} \delta_{\sigma_i, \sigma_j}$</span>, where <span>$\sigma_i$</span> takes an integer value from <span>$1$</span> to <span>$Q$</span> and <span>$\delta$</span> is a Kronecker&#39;s delta. Order parameter (total magnetization) is defined as \begin{equation}     M = \frac{Q-1}{Q}N<em>1 - \frac{1}{Q}(N-N</em>1), \end{equation} where <span>$N$</span> is the number of sites and <span>$N_1$</span> is the number of <span>$\sigma=1$</span> spins.</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.Clock" href="#SpinMonteCarlo.Clock"><code>SpinMonteCarlo.Clock</code></a> — <span class="docstring-category">Type</span>.</div><div><p><code>Q</code> state clock model with energy <span>$E = -\sum_{ij} J_{ij} \cos(\theta_i - \theta_j)$</span>, where <span>$\theta_i = 2\pi \sigma_i/Q$</span> and <span>$\sigma_i$</span> takes an integer value from <span>$1$</span> to <span>$Q$</span>.</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.XY" href="#SpinMonteCarlo.XY"><code>SpinMonteCarlo.XY</code></a> — <span class="docstring-category">Type</span>.</div><div><p>XY model with energy <span>$E = -\sum_{ij} J_{ij} \cos(\theta_i - \theta_j)$</span>, where <span>$\theta_i = 2\pi \sigma_i$</span> and <span>$\sigma_i \in [0, 1)$</span>.</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.QuantumXXZ" href="#SpinMonteCarlo.QuantumXXZ"><code>SpinMonteCarlo.QuantumXXZ</code></a> — <span class="docstring-category">Type</span>.</div><div><p>Spin-<span>$S$</span> XXZ model represented as the following Hamiltonian, \begin{equation} \mathcal{H} = \sum<em>{i,j} \left[ J</em>{ij}^z S<em>i^z S</em>j^z              + \frac{J<em>{ij}^{xy}}{2} (S</em>i^+ S<em>j^- + S</em>i^-S<em>j^+) \right]             - \sum</em>i \Gamma<em>i S</em>i^x, \end{equation} where <span>$S^x, S^y, S^z$</span> are <span>$x, y$</span> and <span>$z$</span> component of spin operator with length <span>$S$</span>, and <span>$S^\pm \equiv S^x \pm iS^y$</span> are ladder operator. A state is represented by a product state (spins at <span>$\tau=0$</span>) of local <span>$S^z$</span> diagonal basis and an operator string (perturbations). A local spin with length <span>$S$</span> is represented by a symmetrical summation of <span>$2S$</span> sub spins with length <span>$1/2$</span>.</p></div></section><h2><a class="nav-anchor" id="Lattice-generator-1" href="#Lattice-generator-1">Lattice generator</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.dimer_lattice" href="#SpinMonteCarlo.dimer_lattice"><code>SpinMonteCarlo.dimer_lattice</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">dimer_lattice()
dimer_lattice(param::Dict)</code></pre><p>Generates dimer lattice (indeed, this is not a &quot;lattice&quot;)</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.chain_lattice" href="#SpinMonteCarlo.chain_lattice"><code>SpinMonteCarlo.chain_lattice</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">chain_lattice(L::Integer)
chain_lattice(param::Dict)</code></pre><p>Generates chain lattice with length <code>L = param[&quot;L&quot;]</code></p><p><code>nsitetypes</code> is 2: all <code>1</code> (<code>2</code>) sites do not connect to another <code>1</code> (<code>2</code>) site.</p><p><code>nbondtypes</code> is 2: <code>1</code> bond connects <code>2n-1</code> and <code>2n</code> sites and <code>2</code> bond connects <code>2n</code> and <code>2n+1</code> sites.</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.square_lattice" href="#SpinMonteCarlo.square_lattice"><code>SpinMonteCarlo.square_lattice</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">square_lattice(L::Integer, W::Integer=L)
square_lattice(param::Dict)</code></pre><p>Generates square lattice with size <code>L=param[&quot;L&quot;]</code> <span>$\times$</span> <code>W=param[&quot;W&quot;]</code>.</p><p><code>nsitetypes</code> is 2: all <code>1</code> (<code>2</code>) sites do not connect to another <code>1</code> (<code>2</code>) site.</p><p><code>nbondtypes</code> is 2: <code>1</code> bonds are parallel to <code>x</code> axis and <code>2</code> are parallel to <code>y</code> axis.</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.triangular_lattice" href="#SpinMonteCarlo.triangular_lattice"><code>SpinMonteCarlo.triangular_lattice</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">triangular_lattice(L::Integer, W::Integer=L)
triangular_lattice(param::Dict)</code></pre><p>Generates triangular lattice with size <code>L=param[&quot;L&quot;]</code> <span>$\times$</span> <code>W=param[&quot;W&quot;]</code>.</p><p><code>nsitetypes</code> is 3: all <code>1</code>, <code>2</code>, and <code>3</code> sites do not connect to another <code>1</code>, <code>2</code>, and <code>3</code> site, respectively.</p><p><code>nbondtypes</code> is 3: <code>1</code>, <code>2</code>, and <code>3</code> bonds make an angle of 0, 60, and 120 degree with <code>x</code> axis, respectively.</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.cubic_lattice" href="#SpinMonteCarlo.cubic_lattice"><code>SpinMonteCarlo.cubic_lattice</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">cubic_lattice(L::Integer, W::Integer=L, H::Integer=W)
cubic_lattice(param::Dict)</code></pre><p>Generates cubic lattice with size <code>L=param[&quot;L&quot;]</code> <span>$\times$</span> <code>W=param[&quot;W&quot;]</code> <span>$\times$</span> <code>H=param[&quot;H&quot;]</code>.</p><p><code>nsitetypes</code> is 2: all <code>1</code> (<code>2</code>) sites do not connect to another <code>1</code> (<code>2</code>) site.</p><p><code>nbondtypes</code> is 2: <code>1</code>, <code>2</code>, and <code>3</code> bonds are parallel to <code>x</code>, <code>y</code>, and <code>z</code> axis, respectively.</p></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.fully_connected_lattice" href="#SpinMonteCarlo.fully_connected_lattice"><code>SpinMonteCarlo.fully_connected_lattice</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">fully_connected_lattice(N::Integer)
fully_connected_lattice(param::Dict)</code></pre><p>Generates <code>N=param[&quot;N&quot;]</code> site fully connected lattice</p><p>Both <code>nsitetypes</code> and <code>nbondtypes</code> are 1.</p></div></section><h2><a class="nav-anchor" id="Update-method-1" href="#Update-method-1">Update method</a></h2><p>An index of model parameter (e.g., <code>Js</code>) is corresponding to <code>sitetype</code> or <code>bondtype</code>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.local_update!" href="#SpinMonteCarlo.local_update!"><code>SpinMonteCarlo.local_update!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">local_update!(model, param)
local_update!(model, T::Real, Js::AbstractArray)</code></pre><p>Updates spin configuration by local spin flip and Metropolice algorithm  under the temperature <code>T = param[&quot;T&quot;]</code> and coupling constants <code>J = param[&quot;J&quot;]</code></p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.SW_update!" href="#SpinMonteCarlo.SW_update!"><code>SpinMonteCarlo.SW_update!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">SW_update!(model, param::Parameter)
SW_update!(model, T::Real, Js::AbstractArray)</code></pre><p>Updates spin configuration by Swendsen-Wang algorithm under temperature <code>T=param[&quot;T&quot;]</code> and coupling constants <code>J=param[&quot;J&quot;]</code></p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.Wolff_update!" href="#SpinMonteCarlo.Wolff_update!"><code>SpinMonteCarlo.Wolff_update!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">Wolff_update!(model, param::Parameter)
Wolff_update!(model, T::Real, Js::AbstractArray)</code></pre><p>Updates spin configuration by Wolff algorithm under temperature <code>T=param[&quot;T&quot;]</code> and coupling constants <code>J=param[&quot;J&quot;]</code></p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.loop_update!" href="#SpinMonteCarlo.loop_update!"><code>SpinMonteCarlo.loop_update!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">loop_update!(model, param::Parameter)
loop_update!(model, T::Real,
             Jz::AbstractArray,
             Jxy::AbstractArray,
             Gamma:AbstractArray)</code></pre><p>Updates spin configuration by loop algorithm  under the temperature <code>T = param[&quot;T&quot;]</code> and coupling constants <code>Jz, Jxy</code> and transverse field <code>Gamma</code></p></div></div></section><h2><a class="nav-anchor" id="Estimator-1" href="#Estimator-1">Estimator</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.simple_estimator" href="#SpinMonteCarlo.simple_estimator"><code>SpinMonteCarlo.simple_estimator</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">simple_estimator(model::Ising, T::Real, Js::AbstractArray)
simple_estimator(model::Potts, T::Real, Js::AbstractArray)</code></pre><p>Returns the following observables as <code>Dict{String, Any}</code></p><p><strong>Observables</strong></p><ul><li><code>&quot;Energy&quot;</code><ul><li>Energy per spin (site)</li></ul></li><li><code>&quot;Energy^2&quot;</code></li><li><code>&quot;Magnetization&quot;</code><ul><li>Total magnetization per spin (order paremeter)</li></ul></li><li><code>&quot;|Magnetization|&quot;</code></li><li><code>&quot;Magnetization^2&quot;</code></li><li><code>&quot;Magnetization^4&quot;</code></li></ul></div></div><div><div><pre><code class="language-none">simple_estimator(model::Clock, T::Real, Js::AbstractArray)
simple_estimator(model::XY, T::Real, Js::AbstractArray)</code></pre><p>Returns the following observables as <code>Dict{String, Any}</code></p><p><strong>Observables</strong></p><ul><li><code>&quot;Energy&quot;</code><ul><li>Energy per spin (site)</li></ul></li><li><code>&quot;Energy^2&quot;</code></li><li><code>&quot;|Magnetization|&quot;</code><ul><li>Absolute value of total magnetization per spin (order paremeter)</li></ul></li><li><code>&quot;|Magnetization|^2&quot;</code></li><li><code>&quot;|Magnetization|^4&quot;</code></li><li><code>&quot;Magnetization x&quot;</code><ul><li>x component of total magnetization per spin (order paremeter)</li></ul></li><li><code>&quot;|Magnetization x|&quot;</code></li><li><code>&quot;Magnetization x^2&quot;</code></li><li><code>&quot;Magnetization x^4&quot;</code></li><li><code>&quot;Magnetization y&quot;</code><ul><li>y component of total magnetization per spin (order paremeter)</li></ul></li><li><code>&quot;|Magnetization y|&quot;</code></li><li><code>&quot;Magnetization y^2&quot;</code></li><li><code>&quot;Magnetization y^4&quot;</code></li><li><code>&quot;Helicity Modulus x&quot;</code></li><li><code>&quot;Helicity Modulus y&quot;</code></li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.improved_estimator" href="#SpinMonteCarlo.improved_estimator"><code>SpinMonteCarlo.improved_estimator</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">improved_estimator(model::Ising, T::Real, Js::AbstractArray, sw::SWInfo)</code></pre><p>Returns the following observables as <code>Dict{String, Any}</code> using cluster information <code>sw</code></p><p><strong>Observables</strong></p><ul><li><code>&quot;Energy&quot;</code><ul><li>Energy per spin (site)</li></ul></li><li><code>&quot;Energy^2&quot;</code></li><li><code>&quot;Magnetization&quot;</code><ul><li>Total magnetization per spin (site)</li></ul></li><li><code>&quot;|Magnetization|&quot;</code></li><li><code>&quot;|Magnetization|^2&quot;</code></li><li><code>&quot;|Magnetization|^4&quot;</code></li></ul></div></div><div><div><pre><code class="language-none">improved_estimator(model::Potts, T::Real, Js::AbstractArray, sw::SWInfo)</code></pre><p>Returns the following observables as <code>Dict{String, Any}</code> using cluster information <code>sw</code></p><p><strong>Observables</strong></p><ul><li><code>&quot;Energy&quot;</code></li><li><code>&quot;Energy^2&quot;</code></li><li><code>&quot;Magnetization&quot;</code></li><li><code>&quot;|Magnetization|&quot;</code></li><li><code>&quot;|Magnetization|^2&quot;</code></li><li><code>&quot;|Magnetization|^4&quot;</code></li></ul></div></div><div><div><pre><code class="language-none">improved_estimator(model::QuantumXXZ, T::Real, Js::AbstractArray, uf::UnionFind)</code></pre><p>Returns the following observables as <code>Dict{String, Any}</code> using loop information <code>uf</code></p><p><strong>Observables</strong></p><ul><li><code>&quot;Sign&quot;</code><ul><li>Sign of the weight function</li></ul></li><li><code>&quot;Sign * Energy&quot;</code><ul><li>Energy per spin (site)</li></ul></li><li><code>&quot;Sign * Energy^2&quot;</code></li><li><code>&quot;Sign * Magnetization&quot;</code><ul><li>Total magnetization (Sz) per spin (site)</li></ul></li><li><code>&quot;Sign * |Magnetization|&quot;</code></li><li><code>&quot;Sign * Magnetization^2&quot;</code></li><li><code>&quot;Sign * Magnetization^4&quot;</code></li></ul></div></div></section><h2><a class="nav-anchor" id="Utility-1" href="#Utility-1">Utility</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.convert_parameter" href="#SpinMonteCarlo.convert_parameter"><code>SpinMonteCarlo.convert_parameter</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">convert_parameter(model, param)</code></pre><p>Generates arguments of updater and estimator.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; model = Ising(chain_lattice(4));

julia&gt; p = convert_parameter(model, Parameter(&quot;J&quot;=&gt;1.0))
(1.0, [1.0, 1.0]) # T and Js

julia&gt; p = convert_parameter(model, Parameter(&quot;J&quot;=&gt;[1.5, 0.5]))
(1.0, [1.5, 0.5]) # J can take a vector whose size is `numbondtypes(model)`

julia&gt; model.spins
4-element Array{Int64,1}:
  1
  1
  1
 -1

julia&gt; local_update!(model, p...);

julia&gt; model.spins
4-element Array{Int64,1}:
  1
  1
 -1
 -1</code></pre></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.convert_parameter-Tuple{Ising,Dict{String,Any}}" href="#SpinMonteCarlo.convert_parameter-Tuple{Ising,Dict{String,Any}}"><code>SpinMonteCarlo.convert_parameter</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">convert_parameter(model::Union{Ising, Potts, Clock, XY}, param::Parameter)</code></pre><p><strong>Keynames:</strong></p><ul><li>&quot;T&quot;: a scalar (default: 1.0).</li><li>&quot;J&quot;: a vector with <code>numbondtypes(model)</code> elements (default: 1.0).</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SpinMonteCarlo.convert_parameter-Tuple{QuantumXXZ,Dict{String,Any}}" href="#SpinMonteCarlo.convert_parameter-Tuple{QuantumXXZ,Dict{String,Any}}"><code>SpinMonteCarlo.convert_parameter</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">convert_parameter(model::QuantumXXZ, param::Parameter)</code></pre><p><strong>Keynames:</strong></p><ul><li>&quot;T&quot;: a scalar (default: 1.0).</li><li>&quot;Jz&quot;: a vector with <code>numbondtypes(model)</code> elements (default: 1.0).</li><li>&quot;Jxy&quot;: a vector with <code>numbondtypes(model)</code> elements (default: 1.0).</li><li>&quot;Gamma&quot;: a vector with <code>numsitetypes(model)</code> elements (default: 0.0).</li></ul></div></div></section><footer><hr/><a class="previous" href="../../develop/"><span class="direction">Previous</span><span class="title">Develop Monte Carlo</span></a><a class="next" href="../internals/"><span class="direction">Next</span><span class="title">Internals</span></a></footer></article></body></html>
