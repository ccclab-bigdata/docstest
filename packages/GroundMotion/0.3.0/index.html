<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Readme · GroundMotion.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>GroundMotion.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Readme</a><ul class="internal"><li><a class="toctext" href="#Basic-principles-1">Basic principles</a></li><li><a class="toctext" href="#Short-example:-1">Short example:</a></li><li><a class="toctext" href="#How-to-get-VS30-grid-1">How to get VS30 grid</a></li><li><a class="toctext" href="#Read-and-Write-data-grids-1">Read and Write data grids</a></li><li><a class="toctext" href="#Earthquake-location-data-1">Earthquake location data</a></li><li><a class="toctext" href="#Abrahamson-and-Silva-2008-GMPE-Model-1">Abrahamson and Silva 2008 GMPE Model</a></li><li><a class="toctext" href="#Si-and-Midorikawa-1999-GMPE-Model-1">Si and Midorikawa 1999 GMPE Model</a></li><li><a class="toctext" href="#Morikawa-and-Fujiwara-2013-GMPE-Model-1">Morikawa and Fujiwara 2013 GMPE Model</a></li><li><a class="toctext" href="#LICENSE-1">LICENSE</a></li></ul></li><li><a class="toctext" href="autodocs/">Docstrings</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Readme</a></li></ul></nav><hr/><div id="topbar"><span>Readme</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="GroundMotion.jl-1" href="#GroundMotion.jl-1">GroundMotion.jl</a></h1><p>The ground motion evaluation module (earthquake seismology)</p><h3><a class="nav-anchor" id="Build-Status-1" href="#Build-Status-1">Build Status</a></h3><p><a href="https://travis-ci.org/geophystech/GroundMotion.jl"><img src="https://travis-ci.org/geophystech/GroundMotion.jl.svg?branch=master" alt="Linux/MacOS"/></a> <a href="https://ci.appveyor.com/project/geophystech/groundmotion-jl"><img src="https://ci.appveyor.com/api/projects/status/0xyromepmwwt0nob?svg=true" alt="Windows"/></a> <a href="https://coveralls.io/github/geophystech/GroundMotion.jl?branch=master"><img src="https://coveralls.io/repos/github/geophystech/GroundMotion.jl/badge.svg?branch=master" alt="Coverage Status"/></a> <a href="http://pkg.julialang.org/detail/GroundMotion"><img src="http://pkg.julialang.org/badges/GroundMotion_0.6.svg" alt="GroundMotion"/></a> <a href="http://pkg.julialang.org/detail/GroundMotion"><img src="http://pkg.julialang.org/badges/GroundMotion_0.7.svg" alt="GroundMotion"/></a></p><h3><a class="nav-anchor" id="Install-1" href="#Install-1">Install</a></h3><pre><code class="language-julia">Pkg.add(&quot;GroundMotion.jl&quot;)</code></pre><h2><a class="nav-anchor" id="Basic-principles-1" href="#Basic-principles-1">Basic principles</a></h2><p>Names of GMPE functions looks like: <code>gmpe_{Name_of_gmpe_function}</code>. For example: <code>gmpe_as2008</code>, where <code>as2008</code> is Abrahamson and Silva 2008 GMPE Model. The configuration for a model (see <code>examples/*.conf</code>) has <code>ground_motion_type</code> that can be <code>PGA</code>,<code>PGV</code>,<code>PSA</code> and define the type of output data points.</p><p>Each GMPE function has at least 2 methods: for calculation based on input VS30-grid or without any grid.</p><h3><a class="nav-anchor" id="GRID-case-1" href="#GRID-case-1">GRID case</a></h3><p>The GMPE function for each grid&#39;s point calculates <code>{pga/pgv/psa}</code> values using <code>latitude</code>, <code>longitude</code> [degrees for WGS84 ellipsoid] and <code>VS30</code> [m/s]. The output data has return in custom type (depends by config) where latitude and longitude are copy from input grid and <code>pga/pgv/pgd/psa</code> is calculated by function. </p><p>For example: the function <code>gmpe_as2008</code> with parameters</p><pre><code class="language-julia">pga_as2008(eq::Earthquake,
           config_as2008::Params_as2008,
           grid::Array{Point_vs30};
           min_val::Number)</code></pre><p>where <code>ground_motion_type = &quot;PGA&quot;</code> at <code>config</code>, returns 1-d is <code>Array{Point_pga_out}</code> with points based on input grid and <code>pga &gt; min_val</code> (<code>pga</code> is Acceleration of gravity in percent (%g) rounded to <code>ggg.gg</code>).</p><h3><a class="nav-anchor" id="Without-grid-1" href="#Without-grid-1">Without grid</a></h3><p>In case of without any grid GMPE functions return simple 1-d <code>Array{Float64}</code> with <code>{pga/pgv/pgd/psa}</code> data. It calculates from epicenter to <code>distance</code> with <code>1</code> [km] step perpendicularly to the epicenter.</p><p>Example:</p><pre><code class="language-julia">pga_as2008(eq::Earthquake,
           config::Params_as2008;
           VS30::Number=350,
           distance::Int64=1000)</code></pre><p>where <code>ground_motion_type = &quot;PGA&quot;</code> at <code>config</code>, return is <code>Array{Float64}</code> with <code>1:distance</code> values of <code>pga</code> (also rounded to <code>ggg.gg</code>).</p><h2><a class="nav-anchor" id="Short-example:-1" href="#Short-example:-1">Short example:</a></h2><pre><code class="language-julia">using GroundMotion
# init model parameters
include(&quot;GroundMoution.jl/examples/as2008.conf&quot;)
# load vs30 grid
grid = read_vs30_file(&quot;Downloads/web/testvs30.txt&quot;)
# set earthquake location
eq = Earthquake(143.04,51.92,13,6)
# run AS2008 PGA modeling on GRID
out_grid = gmpe_as2008(eq,config_as2008,grid)
# run AS2008 PGA FOR PLOTTING with VS30=30 [m/s^2], distance=1000 [km] by default.
simulation = pga_as2008(eq,config_as2008)</code></pre><h2><a class="nav-anchor" id="How-to-get-VS30-grid-1" href="#How-to-get-VS30-grid-1">How to get VS30 grid</a></h2><ol><li>Download GMT grd file from <a href="https://earthquake.usgs.gov/data/vs30/">USGS Vs30 Models and Data page</a></li><li>Unzip it. It takes around 2,7G disk space for one file: </li></ol><pre><code class="language-bash">unzip global_vs30_grd.zip
...
ls -lh global_vs30.grd
-rw-r--r--  1 jamm  staff   2,7G  8 сен  2016 global_vs30.grd</code></pre><ol><li>Use <code>GMT2XYZ</code> <a href="https://www.soest.hawaii.edu/gmt/gmt/html/man/grd2xyz.html">man page</a> from <a href="https://www.soest.hawaii.edu/gmt/">GMT</a> to convert grd data to XYZ text file:</li></ol><pre><code class="language-bash"># example:
grd2xyz global_vs30.grd -R145.0/146.0/50.0/51.0 &gt; test_sea.txt
# number of rows:
cat test_sea.txt |wc -l
   14641</code></pre><h2><a class="nav-anchor" id="Read-and-Write-data-grids-1" href="#Read-and-Write-data-grids-1">Read and Write data grids</a></h2><p>Use <code>read_vs30_file</code> to read data from vs30 file:</p><pre><code class="language-julia">grid = read_vs30_file(&quot;Downloads/web/somevs30.txt&quot;)</code></pre><p>After some <code>gmpe_*</code> function on grid done, you will get <code>Array{Point_{pga,pgv,pgd,psa}_out}</code>. Use <code>convert_to_float_array</code> to convert <code>Array{Point_{pga,pgv,pgd,psa}_out}</code> to <code>Nx3</code> <code>Array{Float64}</code>:</p><pre><code class="language-julia">typeof(A)
#--&gt; Array{GroundMoution.Point_pga_out,1}
length(A)
#--&gt; 17
B = convert_to_float_array(A)
typeof(B)
#--&gt; Array{Float64,2}</code></pre><p>Use <code>Base.writedlm</code> to write XYZ (<code>lon</code>,<code>lat</code>,<code>pga/pgv/pgd/psa</code>) data to text file:</p><pre><code class="language-julia">writedlm(&quot;Downloads/xyz.txt&quot;, B) # where B is N×3 Array{Float64}</code></pre><p>Use <code>convert_to_point_vs30</code> to convert Array{Float64,2} array to Array{GroundMotion.Point_vs30,1}</p><h2><a class="nav-anchor" id="Earthquake-location-data-1" href="#Earthquake-location-data-1">Earthquake location data</a></h2><p>Lets define <code>lat</code>,<code>lon</code>,<code>depth</code>,<code>Ml</code>,<code>Mw</code>:</p><pre><code class="language-julia">eq = Earthquake(143.04,51.92,13,6,5.8)
# OR
eq = Earthquake(143.04,51.92,13,6)</code></pre><p>Latitude and longitude assumes degrees for WGS84 ellipsoid. Depth in km. <code>Mw</code> usually not ready right after earthquake. <code>Mw=0</code> in case of moment magnitude is not specified. All gmpe models uses <code>Mw</code> if it is or <code>Ml</code> otherwise.</p><h2><a class="nav-anchor" id="Abrahamson-and-Silva-2008-GMPE-Model-1" href="#Abrahamson-and-Silva-2008-GMPE-Model-1">Abrahamson and Silva 2008 GMPE Model</a></h2><p><strong>WORK IN PROGRESS!</strong></p><h3><a class="nav-anchor" id="Reference-1" href="#Reference-1">Reference</a></h3><p>Abrahamson, Norman, and Walter Silva. &quot;Summary of the Abrahamson &amp; Silva NGA ground-motion relations.&quot; Earthquake spectra 24.1 (2008): 67-97.</p><h3><a class="nav-anchor" id="PGA:-1" href="#PGA:-1">PGA:</a></h3><pre><code class="language-julia">## ON GRID
gmpe_as2008(eq::Earthquake,
           config_as2008::Params_as2008,
           grid::Array{Point_vs30};
           min_val::Number)
## Without grid
gmpe_as2008(eq::Earthquake,
           config::Params_as2008;
           VS30::Number=350,
           distance::Int64=1000)</code></pre><p>Keyword arguments: <code>min_val</code>,<code>VS30</code>,<code>distance</code>.</p><h3><a class="nav-anchor" id="Model-Parameters-1" href="#Model-Parameters-1">Model Parameters</a></h3><p>See <code>examples/as2008.conf</code>.</p><p><strong>The variables that always zero for current version:</strong></p><p><code>a12*Frv</code>, <code>a13*Fnm</code>, <code>a15*Fas</code>, <code>Fhw*f4(Rjb,Rrup,Rx,W,S,Ztor,Mw)</code>, <code>f6(Ztor)</code>, <code>f10(Z1.0, Vs30)</code>.</p><p>Actually they are not presented at code.</p><p><strong>R_rup - is a distance to hypocenter</strong></p><h2><a class="nav-anchor" id="Si-and-Midorikawa-1999-GMPE-Model-1" href="#Si-and-Midorikawa-1999-GMPE-Model-1">Si and Midorikawa 1999 GMPE Model</a></h2><p><img src="https://user-images.githubusercontent.com/3518847/35567902-c89220ac-061a-11e8-98f1-0deb520f1be2.jpg" alt="si-midorikawa-1999"/></p><h3><a class="nav-anchor" id="References-1" href="#References-1">References</a></h3><ol><li>Si, Hongjun, and Saburoh Midorikawa. &quot;New attenuation relations for peak ground acceleration and velocity considering effects of fault type and site condition.&quot; Proceedings of twelfth world conference on earthquake engineering. 2000.</li><li>Si H., Midorikawa S. New Attenuation Relationships for Peak Ground Acceleration and Velocity Considering Effects of Fault Type and Site Condition // Journal of Structural and Construction Engineering, A.I.J. 1999. V. 523. P. 63-70, (in Japanese with English abstract).</li></ol><h3><a class="nav-anchor" id="PGA:-2" href="#PGA:-2">PGA:</a></h3><pre><code class="language-julia">## ON GRID
gmpe_simidorikawa1999(eq::Earthquake,
                     config::Params_simidorikawa1999,
                     grid::Array{Point_vs30};
                     min_val::Number)
## Without grid
gmpe_simidorikawa1999(eq::Earthquake,
                     config::Params_simidorikawa1999;
                     VS30::Number=350,
                     distance::Int64=1000)</code></pre><p>Keyword arguments: <code>min_val</code>,<code>VS30</code>,<code>distance</code>.</p><h3><a class="nav-anchor" id="Model-Parameters-2" href="#Model-Parameters-2">Model Parameters</a></h3><p>See <code>examples/si-midorikawa-1999.conf</code>.</p><p><strong>X - is a distance to hypocenter</strong></p><h2><a class="nav-anchor" id="Morikawa-and-Fujiwara-2013-GMPE-Model-1" href="#Morikawa-and-Fujiwara-2013-GMPE-Model-1">Morikawa and Fujiwara 2013 GMPE Model</a></h2><p><img src="https://user-images.githubusercontent.com/3518847/35567875-ad83ebba-061a-11e8-8023-7bb372176042.jpg" alt="mf2013"/></p><h3><a class="nav-anchor" id="Reference-2" href="#Reference-2">Reference</a></h3><p>Morikawa N., Fujiwara H. A New Ground Motion Prediction Equation for Japan Applicable up to M9 Mega-Earthquake // Journal of Disaster Research. 2013. Vol. 5 (8). P. 878–888.</p><h3><a class="nav-anchor" id="PGA,-PGV,-PSA-1" href="#PGA,-PGV,-PSA-1">PGA, PGV, PSA</a></h3><pre><code class="language-julia">## On grid whithout Dl data
gmpe_mf2013(eq::Earthquake,
            config::Params_mf2013,
            grid::Array{Point_vs30};
            min_val::Number=0,
            Dl::Number=250,
            Xvf::Number=0)
## On grid with Dl data
gmpe_mf2013(eq::Earthquake,
            config::Params_mf2013,g
            rid::Array{Point_vs30_dl};
            min_val::Number=0,
            Xvf::Number=0)
## without any grid
gmpe_as2008(eq::Earthquake,
            config::Params_mf2013;
            VS30::Number=350,
            distance::Int64=1000,
            Dl::Number=250,
            Xvf::Number=0)</code></pre><p><code>min_val=0</code>, <code>Xvf=0</code> [km] by default. <code>Dl=250</code> [km] by default in case of grid pass without Dl data. </p><p>NOTE that <code>gmpe_mf2013</code> has next keyword arguments: <code>min_val</code>, <code>min_val</code>, <code>Dl</code>, <code>VS30</code>, <code>distance</code>. The keyword arguments should be pass with name. Example: <code>gmpe_mf2013(eq,config,VS30=500,Xvf=40)</code>.</p><h3><a class="nav-anchor" id="Model-Parameters-3" href="#Model-Parameters-3">Model Parameters</a></h3><p>See <code>examples/morikawa-fujiwara-2013.conf</code></p><p><strong>About Dl variable</strong></p><p>The <code>Dl</code> is the top depth to the layer whose S-wave velocity is <code>l</code> (in <code>[m/s]</code>) at the site. Actually it should be another one grid with <code>Dl</code> depths on each grid point (<code>Point_vs30_dl</code> type). If you pass grid without <code>Dl</code>, then <code>Dl</code> variable pass to GMPE functions as a constant.</p><p><strong>X - is a distance to hypocenter</strong></p><h2><a class="nav-anchor" id="LICENSE-1" href="#LICENSE-1">LICENSE</a></h2><p>Copyright (c) 2018 GEOPHYSTECH LLC</p><p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);    you may not use this file except in compliance with the License.    You may obtain a copy of the License at</p><pre><code class="language-none">   http://www.apache.org/licenses/LICENSE-2.0</code></pre><p>Unless required by applicable law or agreed to in writing, software    distributed under the License is distributed on an &quot;AS IS&quot; BASIS,    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.    See the License for the specific language governing permissions and    limitations under the License.</p><footer><hr/><a class="next" href="autodocs/"><span class="direction">Next</span><span class="title">Docstrings</span></a></footer></article></body></html>
