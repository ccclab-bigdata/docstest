<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · Mongoc.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Mongoc.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../tutorial/">Tutorial</a></li><li><a class="toctext" href="../crud/">CRUD Operations</a></li><li><a class="toctext" href="../authentication/">Authentication</a></li><li><a class="toctext" href="../transaction/">Transactions</a></li><li class="current"><a class="toctext" href>API Reference</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>API Reference</a></li></ul></nav><hr/><div id="topbar"><span>API Reference</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="API-Reference-1" href="#API-Reference-1">API Reference</a></h1><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_AWAIT_DATA" href="#Mongoc.QUERY_FLAG_AWAIT_DATA"><code>Mongoc.QUERY_FLAG_AWAIT_DATA</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Use with MONGOC<em>QUERY</em>TAILABLE_CURSOR. Block rather than returning no data. After a period, time out.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_EXHAUST" href="#Mongoc.QUERY_FLAG_EXHAUST"><code>Mongoc.QUERY_FLAG_EXHAUST</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Stream the data down full blast in multiple “reply” packets. Faster when you are pulling down a lot of data and you know you want to retrieve it all.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_NONE" href="#Mongoc.QUERY_FLAG_NONE"><code>Mongoc.QUERY_FLAG_NONE</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Specify no query flags.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_NO_CURSOR_TIMEOUT" href="#Mongoc.QUERY_FLAG_NO_CURSOR_TIMEOUT"><code>Mongoc.QUERY_FLAG_NO_CURSOR_TIMEOUT</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>The server normally times out an idle cursor after an inactivity period (10 minutes). This prevents that.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_OPLOG_REPLAY" href="#Mongoc.QUERY_FLAG_OPLOG_REPLAY"><code>Mongoc.QUERY_FLAG_OPLOG_REPLAY</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Used internally by MongoDB.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_PARTIAL" href="#Mongoc.QUERY_FLAG_PARTIAL"><code>Mongoc.QUERY_FLAG_PARTIAL</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Get partial results from mongos if some shards are down (instead of throwing an error).</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_SLAVE_OK" href="#Mongoc.QUERY_FLAG_SLAVE_OK"><code>Mongoc.QUERY_FLAG_SLAVE_OK</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Allow query of replica set secondaries.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QUERY_FLAG_TAILABLE_CURSOR" href="#Mongoc.QUERY_FLAG_TAILABLE_CURSOR"><code>Mongoc.QUERY_FLAG_TAILABLE_CURSOR</code></a> — <span class="docstring-category">Constant</span>.</div><div><div><p>Cursor will not be closed when the last data is retrieved. You can resume this cursor later.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSON" href="#Mongoc.BSON"><code>Mongoc.BSON</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>BSON</code> is a wrapper for C struct <code>bson_t</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONCode" href="#Mongoc.BSONCode"><code>Mongoc.BSONCode</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>BSON element with JavaScript source code.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONError" href="#Mongoc.BSONError"><code>Mongoc.BSONError</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Mirrors C struct <code>bson_error_t</code> and can be allocated in the stack.</p><p><code>BSONError</code> instances addresses are passed to libbson/libmongoc API using <code>Ref(error)</code>, and are owned by the Julia process.</p><pre><code class="language-c">typedef struct {
   uint32_t domain;
   uint32_t code;
   char message[504];
} bson_error_t;</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONIter" href="#Mongoc.BSONIter"><code>Mongoc.BSONIter</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>BSONIter mirrors C struct bson<em>iter</em>t and can be allocated in the stack.</p><p>According to <a href="http://mongoc.org/libbson/current/bson_iter_t.html">libbson documentation</a>, it is meant to be used on the stack and can be discarded at any time as it contains no external allocation. The contents of the structure should be considered private and may change between releases, however the structure size will not change.</p><p>Inspecting its size in C, we get:</p><pre><code class="language-c">sizeof(bson_iter_t) == 80</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONObjectId" href="#Mongoc.BSONObjectId"><code>Mongoc.BSONObjectId</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Mirrors C struct <code>bson_oid_t</code>.</p><p><code>BSONObjectId</code> instances addresses are passed to libbson/libmongoc API using <code>Ref(oid)</code>, and are owned by the Julia process.</p><pre><code class="language-c">typedef struct {
   uint8_t bytes[12];
} bson_oid_t;</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONSubType" href="#Mongoc.BSONSubType"><code>Mongoc.BSONSubType</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>BSONSubType mirrors C enum bson<em>subtype</em>t.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONType" href="#Mongoc.BSONType"><code>Mongoc.BSONType</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>BSONType mirrors C enum bson<em>type</em>t.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.Client" href="#Mongoc.Client"><code>Mongoc.Client</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>Client</code> is a wrapper for C struct <code>mongoc_client_t</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.Collection" href="#Mongoc.Collection"><code>Mongoc.Collection</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>Collection</code> is a wrapper for C struct <code>mongoc_collection_t</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.Cursor" href="#Mongoc.Cursor"><code>Mongoc.Cursor</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>Cursor</code> is a wrapper for C struct <code>mongoc_cursor_t</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.Database" href="#Mongoc.Database"><code>Mongoc.Database</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>Database</code> is a wrapper for C struct <code>mongoc_database_t</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QueryFlags" href="#Mongoc.QueryFlags"><code>Mongoc.QueryFlags</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Mirrors C struct <code>mongoc_query_flags_t</code>.</p><p>These flags correspond to the MongoDB wire protocol. They may be bitwise or’d together. They may modify how a query is performed in the MongoDB server.</p><p>From: http://mongoc.org/libmongoc/current/mongoc<em>query</em>flags_t.html</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.URI" href="#Mongoc.URI"><code>Mongoc.URI</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>URI</code> is a wrapper for C struct <code>mongoc_uri_t</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.add_user" href="#Mongoc.add_user"><code>Mongoc.add_user</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">add_user(database::Database, username::String, password::String, roles::Union{Nothing, BSON}, custom_data::Union{Nothing, BSON}=nothing)</code></pre><p>This function shall create a new user with access to database.</p><p>Warning: Do not call this function without TLS.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.as_json-Tuple{Mongoc.BSON}" href="#Mongoc.as_json-Tuple{Mongoc.BSON}"><code>Mongoc.as_json</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">as_json(bson::BSON; canonical::Bool=false) :: String</code></pre><p>Converts a <code>bson</code> object to a JSON string.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; document = Mongoc.BSON(&quot;{ &quot;hey&quot; : 1 }&quot;)
BSON(&quot;{ &quot;hey&quot; : 1 }&quot;)

julia&gt; Mongoc.as_json(document)
&quot;{ &quot;hey&quot; : 1 }&quot;

julia&gt; Mongoc.as_json(document, canonical=true)
&quot;{ &quot;hey&quot; : { &quot;$numberInt&quot; : &quot;1&quot; } }&quot;</code></pre><p><strong>C API</strong></p><ul><li><p><a href="http://mongoc.org/libbson/current/bson_as_canonical_extended_json.html"><code>bson_as_canonical_extended_json</code></a></p></li><li><p><a href="http://mongoc.org/libbson/current/bson_as_relaxed_extended_json.html"><code>bson_as_relaxed_extended_json</code></a></p></li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.command_simple-Tuple{Mongoc.Database,Mongoc.BSON}" href="#Mongoc.command_simple-Tuple{Mongoc.Database,Mongoc.BSON}"><code>Mongoc.command_simple</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">command_simple(database::Database, command::Union{String, BSON}) :: BSON</code></pre><p>Executes a <code>command</code> given by a JSON string or a BSON instance.</p><p>It returns the first document from the result cursor.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; client = Mongoc.Client() # connects to localhost at port 27017
Client(URI(&quot;mongodb://localhost:27017&quot;))

julia&gt; bson_result = Mongoc.command_simple(client[&quot;admin&quot;], &quot;{ &quot;ping&quot; : 1 }&quot;)
BSON(&quot;{ &quot;ok&quot; : 1.0 }&quot;)</code></pre><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_database_command_simple.html"><code>mongoc_database_command_simple</code></a></li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.find_one" href="#Mongoc.find_one"><code>Mongoc.find_one</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">find_one(collection::Collection, bson_filter::BSON=BSON(); options::Union{Nothing, BSON}=nothing) :: Union{Nothing, BSON}</code></pre><p>Execute a query to a collection and returns the first element of the result set.</p><p>Returns <code>nothing</code> if the result set is empty.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.get_server_mongodb_version-Tuple{Mongoc.Client}" href="#Mongoc.get_server_mongodb_version-Tuple{Mongoc.Client}"><code>Mongoc.get_server_mongodb_version</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Queries the version for the MongoDB server instance.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.has_user-Tuple{Mongoc.Database,String}" href="#Mongoc.has_user-Tuple{Mongoc.Database,String}"><code>Mongoc.has_user</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">has_user(database::Database, user_name::String) :: Bool</code></pre><p>Checks if <code>database</code> has a user named <code>user_name</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.remove_user-Tuple{Mongoc.Database,String}" href="#Mongoc.remove_user-Tuple{Mongoc.Database,String}"><code>Mongoc.remove_user</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">remove_user(database::Database, username::String)</code></pre><p>Removes a user from database.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.set_appname!-Tuple{Mongoc.Client,String}" href="#Mongoc.set_appname!-Tuple{Mongoc.Client,String}"><code>Mongoc.set_appname!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">set_appname!(client::Client, appname::String)</code></pre><p>Sets the application name for this client.</p><p>This string, along with other internal driver details, is sent to the server as part of the initial connection handshake.</p><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_client_set_appname.html"><code>mongoc_client_set_appname</code></a>.</li></ul></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.transaction-Tuple{Function,Mongoc.Client}" href="#Mongoc.transaction-Tuple{Function,Mongoc.Client}"><code>Mongoc.transaction</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">transaction(f::Function, client::Client; session_options::SessionOptions=SessionOptions())</code></pre><p>Use <em>do-syntax</em> to execute a transaction.</p><p>Transaction will be commited automatically. If an error occurs, the transaction is aborted.</p><p>The <code>session</code> parameter should be treated the same way as a <code>Client</code>: from a <code>session</code> you get a <code>database</code>, and a <code>collection</code> that are bound to the session.</p><pre><code class="language-julia">Mongoc.transaction(client) do session
    database = session[&quot;my_database&quot;]
    collection = database[&quot;my_collection&quot;]
    new_item = Mongoc.BSON()
    new_item[&quot;inserted&quot;] = true
    push!(collection, new_item)
end</code></pre></div></div></section><footer><hr/><a class="previous" href="../transaction/"><span class="direction">Previous</span><span class="title">Transactions</span></a></footer></article></body></html>
