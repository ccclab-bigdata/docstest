<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BigBed · GenomicFeatures.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>GenomicFeatures.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><a class="toctext" href="../../intervals/">Intervals</a></li><li><span class="toctext">I/O</span><ul><li><a class="toctext" href="../bed/">BED</a></li><li><a class="toctext" href="../gff3/">GFF3</a></li><li><a class="toctext" href="../bigwig/">BigWig</a></li><li class="current"><a class="toctext" href>BigBed</a><ul class="internal"><li><a class="toctext" href="#Examples-1">Examples</a></li><li><a class="toctext" href="#API-1">API</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>I/O</li><li><a href>BigBed</a></li></ul></nav><hr/><div id="topbar"><span>BigBed</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="bigBed-1" href="#bigBed-1">bigBed</a></h1><p>Description –––––-</p><p>bigBed is a binary file format for representing genomic annotations and often created from BED files. bigBed files are indexed to quickly fetch specific regions.</p><p>I/O tools for bigBed are provided from the <code>GenomicFeatures.BigBed</code> module, which exports following three types:</p><ul><li>Reader type: <code>BigBed.Reader</code></li><li>Writre type: <code>BigBed.Writer</code></li><li>Element type: <code>BigBed.Record</code></li></ul><h2><a class="nav-anchor" id="Examples-1" href="#Examples-1">Examples</a></h2><p>A common workflow is to open a file, iterate over records, and close the file:</p><pre><code class="language-julia"># Import the BigBed module.
using GenomicFeatures

# Open a bigBed file.
reader = open(BigBed.Reader, &quot;data.bb&quot;)

# Iterate over records overlapping with a query interval.
for record in eachoverlap(reader, Interval(&quot;Chr2&quot;, 5001, 6000))
    # Extract the start position, end position and value of the record,
    startpos = BigBed.chromstart(record)
    endpos = BigBed.chromend(record)
    value = BigBed.value(record)
    # and do something...
end

# Finally, close the reader.
close(reader)</code></pre><p>Iterating over all records is also supported:</p><pre><code class="language-julia">reader = open(BigBed.Reader, &quot;data.bb&quot;)
for record in reader
    # ...
end
close(reader)</code></pre><p>Creating a bigBed file can be done as follows. The <code>write</code> call takes a tuple of 3-12 elements (i.e. chromosome name, start position, end position, name, score, strand, thickstart, thickend, RGB color, blockcount, blocksizes and blockstarts). The first three are mandatory fields but others are optional.</p><pre><code class="language-julia"># Import RGB type.
using ColorTypes
file = open(&quot;data.bb&quot;, &quot;w&quot;)
writer = BigBed.Writer(file, [(&quot;chr1&quot;, 1000)])
write(writer, (&quot;chr1&quot;, 1, 100, &quot;some name&quot;, 100, &#39;+&#39;, 10, 90, RGB(0.5, 0.1, 0.2), 2, [4, 10], [10, 20]))
close(writer)</code></pre><h2><a class="nav-anchor" id="API-1" href="#API-1">API</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.Reader" href="#GenomicFeatures.BigBed.Reader"><code>GenomicFeatures.BigBed.Reader</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">BigBed.Reader(input::IO)</code></pre><p>Create a reader for bigBed file format.</p><p>Note that <code>input</code> must be seekable.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.chromlist" href="#GenomicFeatures.BigBed.chromlist"><code>GenomicFeatures.BigBed.chromlist</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">chromlist(reader::BigBed.Reader)::Vector{Tuple{String,Int}}</code></pre><p>Get the <code>(name, length)</code> pairs of chromosomes/contigs.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.Writer" href="#GenomicFeatures.BigBed.Writer"><code>GenomicFeatures.BigBed.Writer</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">BigBed.Writer(output::IO, chromlist; binsize=64)</code></pre><p>Create a data writer of the bigBed file format.</p><p><strong>Arguments</strong></p><ul><li><code>output</code>: data sink</li><li><code>chromlist</code>: chromosome list with length</li><li><code>binsize=64</code>: size of a zoom with the highest resolution</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia">output = open(&quot;data.bb&quot;, &quot;w&quot;)
writer = BigBed.Writer(output, [(&quot;chr1&quot;, 12345), (&quot;chr2&quot;, 9100)])
write(writer, (&quot;chr1&quot;, 101, 150, &quot;gene 1&quot;))
write(writer, (&quot;chr2&quot;, 211, 250, &quot;gene 2&quot;))
close(writer)</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.Record" href="#GenomicFeatures.BigBed.Record"><code>GenomicFeatures.BigBed.Record</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">BigBed.Record()</code></pre><p>Create an unfilled bigBed record.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.chrom" href="#GenomicFeatures.BigBed.chrom"><code>GenomicFeatures.BigBed.chrom</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">chrom(record::Record)::String</code></pre><p>Get the chromosome name of <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.chromid" href="#GenomicFeatures.BigBed.chromid"><code>GenomicFeatures.BigBed.chromid</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">chromid(record::Record)::UInt32</code></pre><p>Get the chromosome ID of <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.chromstart" href="#GenomicFeatures.BigBed.chromstart"><code>GenomicFeatures.BigBed.chromstart</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">chromstart(record::Record)::Int</code></pre><p>Get the start position of <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.chromend" href="#GenomicFeatures.BigBed.chromend"><code>GenomicFeatures.BigBed.chromend</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">chromend(record::Record)::Int</code></pre><p>Get the end position of <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.name" href="#GenomicFeatures.BigBed.name"><code>GenomicFeatures.BigBed.name</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">name(record::Record)::String</code></pre><p>Get the name of <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.score" href="#GenomicFeatures.BigBed.score"><code>GenomicFeatures.BigBed.score</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">score(record::Record)::Int</code></pre><p>Get the score between 0 and 1000.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.strand" href="#GenomicFeatures.BigBed.strand"><code>GenomicFeatures.BigBed.strand</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">strand(record::Record)::GenomicFeatures.Strand</code></pre><p>Get the strand of <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.thickstart" href="#GenomicFeatures.BigBed.thickstart"><code>GenomicFeatures.BigBed.thickstart</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">thickstart(record::Record)::Int</code></pre><p>Get the starting position at which <code>record</code> is drawn thickly.</p><p>Note that the first base is numbered 1.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.thickend" href="#GenomicFeatures.BigBed.thickend"><code>GenomicFeatures.BigBed.thickend</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">thickend(record::Record)::Int</code></pre><p>Get the end position at which <code>record</code> is drawn thickly.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.itemrgb" href="#GenomicFeatures.BigBed.itemrgb"><code>GenomicFeatures.BigBed.itemrgb</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">itemrgb(record::Record)::ColorTypes.RGB</code></pre><p>Get the RGB value of <code>record</code>.</p><p>The return type is defined in <a href="https://github.com/JuliaGraphics/ColorTypes.jl">ColorTypes.jl</a>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.blockcount" href="#GenomicFeatures.BigBed.blockcount"><code>GenomicFeatures.BigBed.blockcount</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">blockcount(record::Record)::Int</code></pre><p>Get the number of blocks (exons) in <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.blocksizes" href="#GenomicFeatures.BigBed.blocksizes"><code>GenomicFeatures.BigBed.blocksizes</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">blocksizes(record::Record)::Vector{Int}</code></pre><p>Get the block (exon) sizes of <code>record</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.blockstarts" href="#GenomicFeatures.BigBed.blockstarts"><code>GenomicFeatures.BigBed.blockstarts</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">blockstarts(record::Record)::Vector{Int}</code></pre><p>Get the block (exon) starts of <code>record</code>.</p><p>Note that the first base is numbered 1.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GenomicFeatures.BigBed.optionals" href="#GenomicFeatures.BigBed.optionals"><code>GenomicFeatures.BigBed.optionals</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">optionals(record::Record)::Vector{String}</code></pre><p>Get optional fields as strings.</p></div></div></section><footer><hr/><a class="previous" href="../bigwig/"><span class="direction">Previous</span><span class="title">BigWig</span></a></footer></article></body></html>
